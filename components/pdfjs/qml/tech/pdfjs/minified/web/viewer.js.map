{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///web/viewer.js","webpack:///web/app.js","webpack:///web/ui_utils.js","webpack:///web/app_options.js","webpack:///web/pdfjs.js","webpack:///web/viewer_compatibility.js","webpack:///web/pdf_cursor_tools.js","webpack:///web/grab_to_pan.js","webpack:///web/pdf_rendering_queue.js","webpack:///web/pdf_sidebar.js","webpack:///web/overlay_manager.js","webpack:///web/password_prompt.js","webpack:///web/pdf_attachment_viewer.js","webpack:///web/pdf_document_properties.js","webpack:///web/pdf_find_bar.js","webpack:///web/pdf_find_controller.js","webpack:///web/pdf_find_utils.js","webpack:///web/pdf_history.js","webpack:///web/pdf_link_service.js","webpack:///web/pdf_outline_viewer.js","webpack:///web/pdf_presentation_mode.js","webpack:///web/pdf_sidebar_resizer.js","webpack:///web/pdf_thumbnail_viewer.js","webpack:///web/pdf_thumbnail_view.js","webpack:///web/pdf_viewer.js","webpack:///web/base_viewer.js","webpack:///web/annotation_layer_builder.js","webpack:///web/pdf_page_view.js","webpack:///web/text_layer_builder.js","webpack:///web/secondary_toolbar.js","webpack:///web/pdf_single_page_viewer.js","webpack:///web/toolbar.js","webpack:///web/view_history.js","webpack:///web/genericcom.js","webpack:///web/preferences.js","webpack:///web/download_manager.js","webpack:///web/genericl10n.js","webpack:///external/webL10n/l10n.js","webpack:///web/pdf_print_service.js"],"names":["pdfjsWebApp","pdfjsWebAppOptions","require","getViewerConfiguration","appContainer","document","body","mainContainer","getElementById","viewerContainer","eventBus","toolbar","container","numPages","pageNumber","scaleSelectContainer","scaleSelect","customScaleOption","previous","next","zoomIn","zoomOut","viewFind","openFile","print","presentationModeButton","download","viewBookmark","secondaryToolbar","toggleButton","toolbarButtonContainer","openFileButton","printButton","downloadButton","viewBookmarkButton","firstPageButton","lastPageButton","pageRotateCwButton","pageRotateCcwButton","cursorSelectToolButton","cursorHandToolButton","scrollVerticalButton","scrollHorizontalButton","scrollWrappedButton","spreadNoneButton","spreadOddButton","spreadEvenButton","documentPropertiesButton","fullscreen","contextFirstPage","contextLastPage","contextPageRotateCw","contextPageRotateCcw","sidebar","outerContainer","thumbnailButton","outlineButton","attachmentsButton","thumbnailView","outlineView","attachmentsView","sidebarResizer","resizer","findBar","bar","findField","highlightAllCheckbox","caseSensitiveCheckbox","entireWordCheckbox","findMsg","findResultsCount","findPreviousButton","findNextButton","passwordOverlay","overlayName","label","input","submitButton","cancelButton","documentProperties","closeButton","fields","errorWrapper","errorMessage","errorMoreInfo","moreInfoButton","lessInfoButton","printContainer","openFileInputName","debuggerScriptPath","webViewerLoad","config","window","PDFViewerApplication","PDFViewerApplicationOptions","AppOptions","event","createEvent","initCustomEvent","dispatchEvent","run","readyState","addEventListener","DEFAULT_SCALE_DELTA","DISABLE_AUTO_FETCH_LOADING_BAR_TIMEOUT","FORCE_PAGES_LOADED_TIMEOUT","WHEEL_ZOOM_DISABLED_TIMEOUT","ViewOnLoad","UNKNOWN","PREVIOUS","INITIAL","DefaultExternalServices","updateFindControlState","data","updateFindMatchesCount","initPassiveLoading","callbacks","fallback","callback","reportTelemetry","createDownloadManager","options","Error","createPreferences","createL10n","supportsIntegratedFind","supportsDocumentFonts","supportsDocumentColors","supportedMouseWheelZoomModifierKeys","ctrlKey","metaKey","initialBookmark","location","hash","substring","initialized","fellback","appConfig","pdfDocument","pdfLoadingTask","printService","pdfViewer","pdfThumbnailViewer","pdfRenderingQueue","pdfPresentationMode","pdfDocumentProperties","pdfLinkService","pdfHistory","pdfSidebar","pdfSidebarResizer","pdfOutlineViewer","pdfAttachmentViewer","pdfCursorTools","store","downloadManager","overlayManager","preferences","l10n","isInitialViewSet","downloadComplete","isViewerEmbedded","parent","url","baseUrl","externalServices","_boundEvents","contentDispositionFilename","initialize","_readPreferences","_parseHashParameters","_initializeL10n","get","LinkTarget","NONE","set","TOP","_initializeViewerComponents","bindEvents","bindWindowEvents","documentElement","translate","then","dispatch","source","getAll","prefs","name","console","error","reason","message","undefined","waitOn","hashParams","parseQueryString","push","loadFakeWorker","TextLayerMode","DISABLE","viewer","classList","add","enabled","split","loadAndEnablePDFBug","Promise","all","locale","getDirection","dir","getElementsByTagName","OverlayManager","getGlobalEventBus","PDFRenderingQueue","onIdle","cleanup","bind","PDFLinkService","externalLinkTarget","externalLinkRel","disableCreateObjectURL","findController","PDFFindController","linkService","PDFViewer","renderingQueue","renderer","enableWebGL","textLayerMode","imageResourcesPath","renderInteractiveForms","enablePrintAutoRotate","useOnlyCssZoom","maxCanvasPixels","setViewer","PDFThumbnailViewer","setThumbnailViewer","PDFHistory","setHistory","PDFFindBar","PDFDocumentProperties","PDFCursorTools","cursorToolOnLoad","Toolbar","SecondaryToolbar","supportsFullscreen","PDFPresentationMode","contextMenuItems","passwordPrompt","PasswordPrompt","PDFOutlineViewer","PDFAttachmentViewer","PDFSidebar","elements","onToggled","forceRendering","PDFSidebarResizer","webViewerInitialized","ticks","isInPresentationMode","newScale","currentScale","toFixed","Math","ceil","min","MAX_SCALE","currentScaleValue","floor","max","MIN_SCALE","zoomReset","DEFAULT_SCALE_VALUE","pagesCount","page","val","currentPageNumber","printing","supportsPrinting","PDFPrintServiceFactory","instance","support","doc","requestFullscreen","mozRequestFullScreen","webkitRequestFullScreen","msRequestFullscreen","fullscreenEnabled","mozFullScreenEnabled","webkitFullscreenEnabled","msFullscreenEnabled","shadow","loadingBar","ProgressBar","setTitleUsingUrl","title","getPDFFileNameFromURL","decodeURIComponent","getFilenameFromUrl","ex","setTitle","close","setAttribute","promise","destroy","setDocument","reset","PDFBug","open","file","args","workerParameters","OptionKind","WORKER","key","GlobalWorkerOptions","parameters","Object","create","originalUrl","apiParameters","API","value","setFileSize","loadingTask","getDocument","onPassword","updateCallback","externalLinkEnabled","setUpdateCallback","onProgress","loaded","total","progress","onUnsupportedFeature","load","exception","loadingErrorMessage","InvalidPDFException","MissingPDFException","UnexpectedResponseException","msg","downloadByUrl","downloadUrl","filename","onerror","err","getData","blob","Blob","type","featureId","moreInfo","moreInfoText","version","build","stack","lineNumber","line","errorWrapperConfig","removeAttribute","textContent","onclick","style","height","scrollHeight","oncontextmenu","noContextMenuHandler","parts","join","level","percent","round","isNaN","disableAutoFetch","loadingParams","disableAutoFetchLoadingBarTimeout","clearTimeout","show","setTimeout","hide","getDownloadInfo","firstPagePromise","pageLayoutPromise","getPageLayout","pageModePromise","getPageMode","openActionDestPromise","getOpenActionDestination","setPagesCount","ViewHistory","fingerprint","baseDocumentUrl","pagesPromise","onePageRendered","pdfPage","setWidth","storePromise","getMultiple","zoom","scrollLeft","scrollTop","rotation","sidebarView","SidebarView","scrollMode","ScrollMode","spreadMode","SpreadMode","animationStarted","timeStamp","values","pageLayout","pageMode","openActionDest","viewOnLoad","_initializePdfHistory","initialDest","parseInt","apiPageModeToSidebarView","apiPageLayoutToSpreadMode","setInitialView","focus","race","resolve","hasEqualPageSizes","update","getPageLabels","labels","i","numLabels","length","toString","setPageLabels","setPageNumber","currentPageLabel","getJavaScript","javaScript","some","js","warn","UNSUPPORTED_FEATURES","regex","ii","test","getOutline","outline","render","getAttachments","attachments","getMetadata","info","metadata","documentInfo","log","PDFFormatVersion","Producer","trim","Creator","pdfTitle","has","IsAcroFormPresent","forms","resetHistory","updateUrl","initialRotation","JSON","stringify","explicitDest","storedHash","setRotation","angle","isValidRotation","pagesRotation","setViewerModes","scroll","spread","isValidScrollMode","isValidSpreadMode","setHash","RendererType","SVG","isThumbnailViewEnabled","isThumbnailViewVisible","renderHighestPriority","beforePrint","printMessage","pageViewsReady","notReadyMessage","alert","pagesOverview","getPagesOverview","createPrintService","layout","afterPrint","rotatePages","delta","newRotation","requestPresentationMode","request","on","webViewerResize","webViewerHashchange","webViewerPageRendered","webViewerTextLayerRendered","webViewerUpdateViewarea","webViewerPageChanging","webViewerScaleChanging","webViewerRotationChanging","webViewerSidebarViewChanged","webViewerPageMode","webViewerNamedAction","webViewerPresentationModeChanged","webViewerPresentationMode","webViewerOpenFile","webViewerPrint","webViewerDownload","webViewerFirstPage","webViewerLastPage","webViewerNextPage","webViewerPreviousPage","webViewerZoomIn","webViewerZoomOut","webViewerZoomReset","webViewerPageNumberChanged","webViewerScaleChanged","webViewerRotateCw","webViewerRotateCcw","webViewerSwitchScrollMode","webViewerScrollModeChanged","webViewerSwitchSpreadMode","webViewerSpreadModeChanged","webViewerDocumentProperties","webViewerFind","webViewerFindFromUrlHash","webViewerUpdateFindMatchesCount","webViewerUpdateFindControlState","webViewerFileInputChange","windowResize","windowHashChange","windowBeforePrint","windowAfterPrint","webViewerVisibilityChange","webViewerWheel","passive","webViewerClick","webViewerKeyDown","unbindEvents","off","unbindWindowEvents","removeEventListener","validateFileURL","HOSTED_VIEWER_ORIGINS","viewerOrigin","URL","href","origin","includes","protocol","workerSrc","loadScript","PDFWorker","getWorkerSrc","enabledTabs","enable","init","OPS","createObjectURL","queryString","search","params","fileInput","createElement","id","className","appendChild","File","FileReader","FileList","evt","files","target","preventDefault","dataTransfer","dropEffect","webViewerOpenFileViaURL","lastIndexOf","xhr","XMLHttpRequest","onload","Uint8Array","response","responseType","send","pageIndex","pageView","getPageView","updateLoadingIndicatorState","getThumbnail","setImage","Stats","stats","mode","view","THUMBS","OUTLINE","ATTACHMENTS","switchView","action","select","toggle","active","switchInProgress","presentationModeState","PresentationModeState","CHANGING","FULLSCREEN","NORMAL","setMultiple","scale","left","top","getAnchorUrl","pdfOpenParams","currentPage","loading","renderingState","RenderingStates","FINISHED","popStateInProgress","fileReader","webViewerChangeFileReaderOnload","buffer","result","readAsArrayBuffer","click","executeCommand","query","phraseSearch","caseSensitive","entireWord","highlightAll","findPrevious","matchesCount","updateResultsCount","state","updateUIState","setPageScale","presetValue","pageLabel","scrollThumbnailIntoView","visibilityState","setZoomDisabledTimeout","zoomDisabledTimeout","previousScale","normalizeWheelEventDelta","MOUSE_WHEEL_DELTA_PER_PAGE_SCALE","scaleCorrectionFactor","rect","getBoundingClientRect","dx","clientX","dy","clientY","isOpen","containsElement","contains","handled","ensureViewerFocused","cmd","altKey","shiftKey","isViewerInPresentationMode","keyCode","findState","curElement","activeElement","querySelector","curElementTagName","tagName","toUpperCase","turnPage","turnOnlyIfPageFit","isVerticalScrollbarEnabled","isHorizontalScrollbarEnabled","opened","switchTool","CursorTool","SELECT","HAND","ODD","EVEN","CSS_UNITS","DEFAULT_SCALE","UNKNOWN_SCALE","MAX_AUTO_SCALE","SCROLLBAR_PADDING","VERTICAL_PADDING","CANVAS","ENABLE","ENABLE_ENHANCE","VERTICAL","HORIZONTAL","WRAPPED","formatL10nValue","text","replace","NullL10n","getLanguage","property","element","getOutputScale","ctx","devicePixelRatio","backingStoreRatio","webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","backingStorePixelRatio","pixelRatio","sx","sy","scaled","scrollIntoView","spot","skipOverflowHiddenElements","offsetParent","offsetY","offsetTop","clientTop","offsetX","offsetLeft","clientLeft","clientHeight","clientWidth","scrollWidth","getComputedStyle","overflow","dataset","_scaleY","_scaleX","watchScroll","viewAreaElement","debounceScroll","rAF","requestAnimationFrame","viewAreaElementScrolled","currentX","lastX","right","currentY","lastY","down","_eventHandler","param","toLowerCase","binarySearchFirstItem","items","condition","minIndex","maxIndex","currentIndex","currentItem","approximateFraction","x","xinv","limit","x_","a","b","c","d","p","q","roundToDivide","div","r","getPageSizeInches","userUnit","rotate","x1","y1","x2","y2","changeOrientation","width","backtrackBeforeAllVisibleElements","index","views","elt","pageTop","getVisibleElements","scrollEl","sortByVisibility","horizontal","bottom","isElementBottomAfterViewTop","elementBottom","isElementRightAfterViewLeft","elementRight","visible","numViews","firstVisibleElementInd","lastEdge","currentWidth","currentHeight","viewWidth","viewHeight","viewRight","viewBottom","hiddenHeight","hiddenWidth","y","first","last","sort","pc","abs","isDataSchema","defaultFilename","reURI","reFilename","splitURI","exec","suggestedFilename","sqrt","deltaX","deltaY","atan2","PI","MOUSE_DOM_DELTA_PIXEL_MODE","MOUSE_DOM_DELTA_LINE_MODE","MOUSE_PIXELS_PER_LINE","MOUSE_LINES_PER_PAGE","deltaMode","Number","isInteger","isPortraitOrientation","size","WaitOnType","EVENT","TIMEOUT","waitOnEventOrTimeout","delay","reject","handler","EventBus","eventHandler","timeout","timeoutHandler","constructor","dispatchToDOM","_listeners","_dispatchToDOM","eventName","listener","eventListeners","indexOf","splice","Array","prototype","slice","call","arguments","_dispatchDOMEvent","forEach","apply","details","obj","globalEventBus","clamp","v","units","parentNode","_updateBar","_indeterminate","remove","progressSize","_percent","scrollbarWidth","offsetWidth","moveToEndOfArray","arr","moved","len","write","read","VIEWER","PREFERENCE","defaultOptions","kind","defaultUrl","defaultZoomValue","disableHistory","disablePageLabels","eventBusDispatchToDOM","historyUpdateUrl","compatibility","viewerCompatibilityParams","pdfBugEnabled","sidebarViewOnLoad","scrollModeOnLoad","spreadModeOnLoad","cMapPacked","cMapUrl","apiCompatibilityParams","disableFontFace","disableRange","disableStream","docBaseUrl","isEvalSupported","maxImageSize","pdfBug","verbosity","workerPort","disablePreferences","navigator","language","printResolution","userOptions","userOption","defaultOption","valueType","pdfjsLib","__non_webpack_require__","module","exports","compatibilityParams","userAgent","isAndroid","isIOS","checkCanvasSizeLimitation","freeze","ZOOM","activeBeforePresentationMode","handTool","GrabToPan","_addEventListeners","tool","disableActiveTool","deactivate","activate","_dispatchEvent","previouslyActive","ownerDocument","ignoreTarget","onActiveChanged","_onmousedown","_onmousemove","_endPan","overlay","CSS_CLASS_GRAB","GrabToPan_activate","GrabToPan_deactivate","GrabToPan_toggle","GrabToPan_ignoreTarget","node","matchesSelector","GrabToPan__onmousedown","button","originalTarget","e","scrollLeftStart","scrollTopStart","clientXStart","clientYStart","stopPropagation","focusedElement","blur","GrabToPan__onmousemove","isLeftMouseReleased","xDiff","yDiff","scrollTo","behavior","GrabToPan__endPan","prefix","isNotIEorIsIE10plus","documentMode","chrome","isChrome15OrOpera15plus","webstore","app","isSafari6plus","vendor","buttons","which","CLEANUP_TIMEOUT","RUNNING","PAUSED","highestPriorityPage","idleTimeout","isHighestPriority","renderingId","currentlyVisiblePages","getHighestPriority","scrolledDown","visibleViews","numVisible","isViewFinished","nextPageIndex","previousPageIndex","renderView","resume","draw","UI_NOTIFICATION_CLASS","LAYERS","disableNotification","_disableNotification","_hideUINotification","disabled","_switchView","forceOpen","isViewChanged","shouldForceRendering","_updateThumbnailViewer","_forceRendering","visibleView","_showUINotification","removeNotification","outlineCount","attachmentsCount","hasChildNodes","_overlays","_active","_keyDownBound","_keyDown","callerCloseMethod","canForceClose","_closeThroughCaller","verify","register","promptString","PasswordResponses","INCORRECT_PASSWORD","password","_appendAttachment","keepRenderedCapability","_renderedCapability","createPromiseCapability","_bindPdfLink","content","blobUrl","viewerUrl","encodeURIComponent","_bindLink","downloadData","names","keys","localeCompare","item","removeNullCharacters","DEFAULT_FIELD_CONTENT","NON_METRIC_LOCALES","US_PAGE_NAMES","METRIC_PAGE_NAMES","getPageName","isPortrait","pageNames","_reset","_currentPageNumber","_pagesRotation","_isNonMetricLocale","freezeFieldData","defineProperty","writable","enumerable","configurable","_dataAvailableCapability","fieldData","_updateUI","_parseFileSize","maybeFileSize","_parseDate","CreationDate","ModDate","getPage","_parsePageSize","_parseLinearization","IsLinearized","fileName","fileSize","creationDate","modDate","pageSize","isLinearized","Title","Author","Subject","Keywords","assign","kb","size_kb","toPrecision","toLocaleString","size_b","size_mb","pageSizeInches","sizeInches","sizeMillimeters","pageName","exactMillimeters","intMillimeters","unit","orientation","inputDate","dateObject","PDFDateString","toDateObject","date","toLocaleDateString","time","toLocaleTimeString","MATCHES_COUNT_LIMIT","_adjustWidth","findPrev","checked","notFound","status","FindState","FOUND","PENDING","NOT_FOUND","current","matchesCountMsg","findbarHeight","inputContainerHeight","firstElementChild","FIND_TIMEOUT","MATCH_SCROLL_OFFSET_TOP","MATCH_SCROLL_OFFSET_LEFT","CHARACTERS_TO_NORMALIZE","normalizationRegex","normalize","RegExp","ch","_linkService","_eventBus","_onFindBarClose","_highlightMatches","_pageMatches","_pageMatchesLength","_selected","_state","_pdfDocument","_firstPageCapability","_shouldDirtyMatch","_dirtyMatch","_updateUIState","_extractText","findbarClosed","pendingTimeout","_findTimeout","_nextMatch","_updateAllPages","scrollMatchIntoView","matchIndex","_scrollMatches","matchIdx","pageIdx","_offset","wrapped","_extractTextPromises","_pageContents","_matchesCountTotal","_pagesToSearch","_pendingFindMatches","_resumePageIdx","_rawQuery","_normalizedQuery","isPageVisible","_prepareMatches","matchesWithLength","matches","matchesLength","isSubTerm","currentElem","nextElem","match","skipped","prevElem","matchLength","_isEntireWord","startIdx","charCodeAt","getCharacterType","endIdx","_calculatePhraseMatch","pageContent","queryLen","_calculateWordMatch","queryArray","subquery","subqueryLen","_calculateMatch","_query","_updatePage","_nextPageMatch","pageMatchesCount","_updateUIResultsCount","extractTextCapability","getTextContent","normalizeWhitespace","textItems","strBuf","j","jj","str","currentPageIndex","offset","numPageMatches","_updateMatch","_advanceOffsetPage","_matchesReady","numMatches","found","previousPage","_requestMatchesCount","CharacterType","SPACE","ALPHA_LETTER","PUNCT","HAN_LETTER","KATAKANA_LETTER","HIRAGANA_LETTER","HALFWIDTH_KATAKANA_LETTER","THAI_LETTER","isAlphabeticalScript","charCode","isAscii","isAsciiAlpha","isAsciiDigit","isAsciiSpace","isHan","isKatakana","isHiragana","isHalfwidthKatakana","isThai","HASH_CHANGE_TIMEOUT","POSITION_UPDATED_THRESHOLD","UPDATE_VIEWAREA_TIMEOUT","getCurrentHash","parseCurrentHash","unescape","_isViewerInPresentationMode","_isPagesLoaded","reInitialized","_updateUrl","_bindEvents","history","_popStateInProgress","_blockHashChange","_currentHash","_numPositionUpdates","_uid","_maxUid","_destination","_position","_isValidState","_pushOrReplaceState","destination","_updateInternalState","uid","dest","namedDest","isArray","forceReplace","isDestHashesEqual","isDestArraysEqual","pushCurrentPosition","_tryPushCurrentPosition","back","forward","shouldReplace","newState","newUrl","startsWith","replaceState","pushState","temporary","position","checkReload","performance","getEntriesByType","perfEntry","removeTemporary","_updateViewareaTimeout","_updateViewarea","_popState","newHash","hashChanged","navigateTo","updateViewarea","popState","pageHide","destHash","pushHash","nameddest","firstDest","secondDest","isEntryEqual","second","_pagesRefCache","goToDestination","destRef","_cachedPageNumber","getPageIndex","cachePageRef","scrollPageIntoView","destArray","getDestination","getDestinationHash","escape","anchor","zoomArgs","zoomArg","zoomArgNumber","parseFloat","allowNegativeOffset","pagemode","parse","isValidExplicitDestination","executeNamedAction","pageNum","pageRef","refStr","gen","num","destLength","allowNull","SimpleLinkService","DEFAULT_TITLE","toggleOutlineTree","lastToggleIsShow","newWindow","addLinkAttributes","BLANK","rel","_setStyles","bold","italic","styleStr","_addToggleButton","count","toggler","shouldShowAll","_toggleOutlineItem","insertBefore","firstChild","root","querySelectorAll","fragment","createDocumentFragment","queue","hasAnyNesting","levelData","shift","itemsDiv","DELAY_BEFORE_RESETTING_SWITCH_IN_PROGRESS","DELAY_BEFORE_HIDING_CONTROLS","ACTIVE_SELECTOR","CONTROLS_SELECTOR","MOUSE_SCROLL_COOLDOWN_TIME","PAGE_SWITCH_THRESHOLD","SWIPE_MIN_DISTANCE_THRESHOLD","SWIPE_ANGLE_THRESHOLD","contextMenuOpen","mouseScrollTimeStamp","mouseScrollDelta","touchSwipeState","_addFullscreenChangeListeners","_setSwitchInProgress","_notifyStateChange","webkitRequestFullscreen","Element","ALLOW_KEYBOARD_INPUT","_mouseWheel","currentTime","Date","getTime","storedTime","_resetMouseScrollState","totalDelta","success","_goToPreviousPage","_goToNextPage","fullscreenElement","mozFullScreen","webkitIsFullScreen","msFullscreenElement","_removeFullscreenChangeListeners","_resetSwitchInProgress","_enter","_addWindowListeners","_showControls","getSelection","removeAllRanges","_exit","_removeWindowListeners","_hideControls","_mouseDown","isInternalLink","_contextMenu","controlsTimeout","_touchSwipe","touches","startX","pageX","startY","pageY","endX","endY","absAngle","showControlsBind","mouseDownBind","mouseWheelBind","resetMouseScrollStateBind","contextMenuBind","touchSwipeBind","_fullscreenChange","isFullscreen","fullscreenChangeBind","SIDEBAR_WIDTH_VAR","SIDEBAR_MIN_WIDTH","SIDEBAR_RESIZING_CLASS","isRTL","sidebarOpen","_width","_outerContainerWidth","CSS","supports","_updateWidth","maxWidth","outerContainerWidth","setProperty","_mouseMove","_mouseUp","mouseMove","mouseUp","updated","THUMBNAIL_SCROLL_MARGIN","THUMBNAIL_SELECTED_CLASS","_scrollUpdated","_resetView","_thumbnails","_getVisibleThumbs","prevThumbnailView","visibleThumbs","numVisibleThumbs","shouldScroll","PDFThumbnailView","_pageLabels","_pagesRequests","_cancelRendering","firstPage","viewport","getViewport","thumbnail","defaultViewport","clone","disableCanvasToImageConversion","cancelRendering","setPageLabel","_ensurePdfPageLoaded","thumbView","setPdfPage","MAX_NUM_SCALING_STEPS","THUMBNAIL_CANVAS_BORDER_WIDTH","THUMBNAIL_WIDTH","TempImageFactory","TempImageFactoryClosure","tempCanvasCache","getCanvas","tempCanvas","mozOpaque","getContext","alpha","save","fillStyle","fillRect","restore","destroyCanvas","pdfPageRotate","renderTask","pageWidth","pageHeight","pageRatio","canvasWidth","canvasHeight","ring","borderAdjustment","totalRotation","childNodes","removeChild","canvas","image","cancel","_getPageDrawContext","noCtxScale","outputScale","_convertCanvasToImage","pageId","src","toDataURL","renderCapability","finishRenderTask","RenderingCancelledException","drawViewport","renderContinueCallback","cont","renderContext","canvasContext","onContinue","img","drawImage","reducedWidth","reducedHeight","reducedImage","reducedImageCtx","ariaLabel","_scrollIntoView","pageDiv","pageSpot","_isScrollModeHorizontal","_getVisiblePages","_getCurrentVisiblePage","_updateHelper","visiblePages","currentId","stillFullyVisible","_setCurrentPageNumber","BaseViewer","DEFAULT_CACHE_SIZE","PDFPageViewBuffer","resize","newSize","pagesToKeep","pageIdsToKeep","Set","iMax","isSameScale","oldScale","_name","removePageBorders","defaultRenderingQueue","_scrollUpdate","_onBeforeDraw","_onAfterDraw","_pages","_pageViewsReady","resetCurrentPageView","_resetCurrentPageView","_currentScale","_setScale","_currentScaleValue","pagesCapability","onePageRenderedCapability","_buffer","cssTransform","settled","textLayerFactory","PDFPageView","_setDocumentViewerElement","annotationLayerFactory","_spreadMode","_updateSpreadMode","getPagesLeft","ref","_location","_scrollMode","_updateScrollMode","_setScaleUpdatePages","newValue","noScroll","preset","isChangingPresentationMode","noPadding","hPadding","vPadding","pageWidthScale","pageHeightScale","horizontalScale","widthScale","heightScale","boundingRect","convertToViewportPoint","_updateLocation","normalizedScaleValue","currentPageView","topLeft","getPagePoint","intLeft","intTop","numVisiblePages","newCacheSize","scrollAhead","createTextLayerBuilder","textLayerDiv","enhanceTextSelection","TextLayerBuilder","createAnnotationLayerBuilder","AnnotationLayerBuilder","firstPageView","map","isFirstPagePortrait","pages","parity","cloneNode","_cancelled","intent","getAnnotations","annotations","dontFlip","AnnotationLayer","DefaultAnnotationLayerFactory","MAX_CANVAS_PIXELS","hasRestrictedScaling","paintTask","paintedViewportMap","WeakMap","annotationLayer","textLayer","zoomLayer","_resetZoomLayer","removeFromDOM","zoomLayerCanvas","keepZoomLayer","keepAnnotations","currentZoomLayerNode","currentAnnotationNode","svg","loadingIconDiv","timestamp","now","isScalingRestricted","hasAttribute","redrawAnnotations","relativeRotation","absRotation","scaleX","scaleY","transform","textLayerViewport","textRelativeRotation","textAbsRotation","transX","transY","transformOrigin","convertToPdfPoint","canvasWrapper","finishPaintTask","paintOnSvg","paintOnCanvas","onRenderContinue","resultPromise","readableStream","streamTextContent","setTextContentStream","isCanvasHidden","showCanvas","actualSizeViewport","pixelsInViewport","maxScale","sfx","sfy","wrapper","cancelled","ensureNotCancelled","getOperatorList","opList","svgGfx","SVGGraphics","commonObjs","objs","getSVG","EXPAND_DIVS_TIMEOUT","textContentItemsStr","textContentStream","renderingDone","textDivs","textLayerRenderTask","_onUpdateTextLayerMatches","_bindMouse","_finishRendering","endOfContent","numTextDivs","textLayerFrag","renderTextLayer","_updateMatches","setTextContent","_convertMatches","iIndex","end","m","mm","begin","divIdx","_renderMatches","isSelectedPage","selected","selectedMatchIdx","prevEnd","infinity","beginText","appendTextToDiv","fromOffset","toOffset","createTextNode","span","i0","i1","isSelected","highlightSuffix","n0","n1","clearedUntilDivIdx","n","highlightMatches","pageMatches","pageMatchesLength","expandDivsTimer","expandTextDivs","adjustTop","getPropertyValue","divBounds","DefaultTextLayerFactory","eventDetails","lastPage","pageRotateCw","pageRotateCcw","containerHeight","previousContainerHeight","_bindClickListeners","_bindCursorToolsListener","_bindScrollModeListener","_bindSpreadModeListener","_setMaxHeight","PDFSinglePageViewer","scrollModeChanged","isScrollModeHorizontal","spreadModeChanged","_ensurePageViewVisible","_shadowViewer","_previousPageNumber","_updateScrollDown","previousPageView","viewerNodes","PAGE_NUMBER_LOADING_INDICATOR","SCALE_SELECT_CONTAINER_PADDING","SCALE_SELECT_PADDING","_wasLocalized","_bindListeners","hasPageLabels","pageScaleValue","pageScale","self","_localized","_adjustScaleWidth","resetNumPages","customScale","predefinedValueFound","option","pageNumberInput","DEFAULT_VIEW_HISTORY_CACHE_SIZE","cacheSize","_initializedPromise","_readFromStorage","databaseStr","database","branch","localStorage","setItem","getItem","_writeToStorage","properties","defaultValue","GenericCom","GenericPreferences","prefObj","BasePreferences","GenericExternalServices","DownloadManager","GenericL10n","defaultPreferences","getDefaultPreferences","defaults","prefValue","defaultType","DISABLE_CREATE_OBJECT_URL","createValidAbsoluteUrl","contentType","msSaveBlob","webL10n","lang","_lang","_ready","setLanguage","gL10nData","gTextData","gTextProp","gLanguage","gMacros","gReadyState","gAsyncResourceLoading","getL10nResourceLinks","getL10nDictionary","script","innerHTML","getTranslatableChildren","getL10nAttributes","l10nId","getAttribute","l10nArgs","xhrLoadText","onSuccess","onFailure","_onSuccess","_onFailure","overrideMimeType","onreadystatechange","responseText","ontimeout","parseResource","successCallback","failureCallback","baseURL","evalString","parseProperties","parsedPropertiesCallback","dictionary","reBlank","reComment","reSection","reImport","reSplit","parseRawLines","rawText","extendedSyntax","parsedRawLinesCallback","entries","currentLang","genericLang","skipLang","nextEntry","loadImport","tmp","prop","loadLocale","_callback","clear","langLinks","langCount","dict","locales","default_locale","defaultLocale","anyCaseLang","onResourceLoaded","gResourceCount","L10nResourceLink","link","resource","getPluralRules","locales2rules","isIn","list","isBetween","start","pluralRules","plural","_pluralRules","getL10nData","rv","substIndexes","substArguments","reIndex","reMatch","macroName","paramName","macro","reArgs","matched_text","arg","translateElement","getChildElementCount","children","l","nodeType","nodeValue","textNode","k","childElementCount","translateFragment","elementCount","fallbackString","getText","rtlList","shortCode","getReadyState","ready","once","activeService","renderPage","activeServiceOnEntry","scratchCanvas","PRINT_RESOLUTION","PRINT_UNITS","PDFPrintService","throwIfInactive","every","pageStyleSheet","ensureOverlay","renderPages","pageCount","renderNextPage","renderProgress","useRenderedPage","printItem","toBlob","performPrint","abort","eventType","progressContainer","progressBar","progressPerc","hasAttachEvent","attachEvent","opera","stopImmediatePropagation","stopPropagationIfNeeded","detail","overlayPromise"],"mappings":"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","file":"viewer.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","/* Copyright 2016 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/* globals chrome */\n\n'use strict';\n\nif (typeof PDFJSDev !== 'undefined' && PDFJSDev.test('CHROME')) {\n  var defaultUrl; // eslint-disable-line no-var\n\n  (function rewriteUrlClosure() {\n    // Run this code outside DOMContentLoaded to make sure that the URL\n    // is rewritten as soon as possible.\n    let queryString = document.location.search.slice(1);\n    let m = /(^|&)file=([^&]*)/.exec(queryString);\n    defaultUrl = m ? decodeURIComponent(m[2]) : '';\n\n    // Example: chrome-extension://.../http://example.com/file.pdf\n    let humanReadableUrl = '/' + defaultUrl + location.hash;\n    history.replaceState(history.state, '', humanReadableUrl);\n    if (top === window) {\n      chrome.runtime.sendMessage('showPageAction');\n    }\n  })();\n}\n\nlet pdfjsWebApp, pdfjsWebAppOptions;\nif (typeof PDFJSDev !== 'undefined' && PDFJSDev.test('PRODUCTION')) {\n  pdfjsWebApp = require('./app.js');\n  pdfjsWebAppOptions = require('./app_options.js');\n}\n\nif (typeof PDFJSDev !== 'undefined' && PDFJSDev.test('FIREFOX || MOZCENTRAL')) {\n  require('./firefoxcom.js');\n  require('./firefox_print_service.js');\n}\nif (typeof PDFJSDev !== 'undefined' && PDFJSDev.test('GENERIC')) {\n  require('./genericcom.js');\n}\nif (typeof PDFJSDev !== 'undefined' && PDFJSDev.test('CHROME')) {\n  require('./chromecom.js');\n}\nif (typeof PDFJSDev !== 'undefined' && PDFJSDev.test('CHROME || GENERIC')) {\n  require('./pdf_print_service.js');\n}\n\nfunction getViewerConfiguration() {\n  return {\n    appContainer: document.body,\n    mainContainer: document.getElementById('viewerContainer'),\n    viewerContainer: document.getElementById('viewer'),\n    eventBus: null, // Using global event bus with (optional) DOM events.\n    toolbar: {\n      container: document.getElementById('toolbarViewer'),\n      numPages: document.getElementById('numPages'),\n      pageNumber: document.getElementById('pageNumber'),\n      scaleSelectContainer: document.getElementById('scaleSelectContainer'),\n      scaleSelect: document.getElementById('scaleSelect'),\n      customScaleOption: document.getElementById('customScaleOption'),\n      previous: document.getElementById('previous'),\n      next: document.getElementById('next'),\n      zoomIn: document.getElementById('zoomIn'),\n      zoomOut: document.getElementById('zoomOut'),\n      viewFind: document.getElementById('viewFind'),\n      openFile: document.getElementById('openFile'),\n      print: document.getElementById('print'),\n      presentationModeButton: document.getElementById('presentationMode'),\n      download: document.getElementById('download'),\n      viewBookmark: document.getElementById('viewBookmark'),\n    },\n    secondaryToolbar: {\n      toolbar: document.getElementById('secondaryToolbar'),\n      toggleButton: document.getElementById('secondaryToolbarToggle'),\n      toolbarButtonContainer:\n        document.getElementById('secondaryToolbarButtonContainer'),\n      presentationModeButton:\n        document.getElementById('secondaryPresentationMode'),\n      openFileButton: document.getElementById('secondaryOpenFile'),\n      printButton: document.getElementById('secondaryPrint'),\n      downloadButton: document.getElementById('secondaryDownload'),\n      viewBookmarkButton: document.getElementById('secondaryViewBookmark'),\n      firstPageButton: document.getElementById('firstPage'),\n      lastPageButton: document.getElementById('lastPage'),\n      pageRotateCwButton: document.getElementById('pageRotateCw'),\n      pageRotateCcwButton: document.getElementById('pageRotateCcw'),\n      cursorSelectToolButton: document.getElementById('cursorSelectTool'),\n      cursorHandToolButton: document.getElementById('cursorHandTool'),\n      scrollVerticalButton: document.getElementById('scrollVertical'),\n      scrollHorizontalButton: document.getElementById('scrollHorizontal'),\n      scrollWrappedButton: document.getElementById('scrollWrapped'),\n      spreadNoneButton: document.getElementById('spreadNone'),\n      spreadOddButton: document.getElementById('spreadOdd'),\n      spreadEvenButton: document.getElementById('spreadEven'),\n      documentPropertiesButton: document.getElementById('documentProperties'),\n    },\n    fullscreen: {\n      contextFirstPage: document.getElementById('contextFirstPage'),\n      contextLastPage: document.getElementById('contextLastPage'),\n      contextPageRotateCw: document.getElementById('contextPageRotateCw'),\n      contextPageRotateCcw: document.getElementById('contextPageRotateCcw'),\n    },\n    sidebar: {\n      // Divs (and sidebar button)\n      outerContainer: document.getElementById('outerContainer'),\n      viewerContainer: document.getElementById('viewerContainer'),\n      toggleButton: document.getElementById('sidebarToggle'),\n      // Buttons\n      thumbnailButton: document.getElementById('viewThumbnail'),\n      outlineButton: document.getElementById('viewOutline'),\n      attachmentsButton: document.getElementById('viewAttachments'),\n      // Views\n      thumbnailView: document.getElementById('thumbnailView'),\n      outlineView: document.getElementById('outlineView'),\n      attachmentsView: document.getElementById('attachmentsView'),\n    },\n    sidebarResizer: {\n      outerContainer: document.getElementById('outerContainer'),\n      resizer: document.getElementById('sidebarResizer'),\n    },\n    findBar: {\n      bar: document.getElementById('findbar'),\n      toggleButton: document.getElementById('viewFind'),\n      findField: document.getElementById('findInput'),\n      highlightAllCheckbox: document.getElementById('findHighlightAll'),\n      caseSensitiveCheckbox: document.getElementById('findMatchCase'),\n      entireWordCheckbox: document.getElementById('findEntireWord'),\n      findMsg: document.getElementById('findMsg'),\n      findResultsCount: document.getElementById('findResultsCount'),\n      findPreviousButton: document.getElementById('findPrevious'),\n      findNextButton: document.getElementById('findNext'),\n    },\n    passwordOverlay: {\n      overlayName: 'passwordOverlay',\n      container: document.getElementById('passwordOverlay'),\n      label: document.getElementById('passwordText'),\n      input: document.getElementById('password'),\n      submitButton: document.getElementById('passwordSubmit'),\n      cancelButton: document.getElementById('passwordCancel'),\n    },\n    documentProperties: {\n      overlayName: 'documentPropertiesOverlay',\n      container: document.getElementById('documentPropertiesOverlay'),\n      closeButton: document.getElementById('documentPropertiesClose'),\n      fields: {\n        'fileName': document.getElementById('fileNameField'),\n        'fileSize': document.getElementById('fileSizeField'),\n        'title': document.getElementById('titleField'),\n        'author': document.getElementById('authorField'),\n        'subject': document.getElementById('subjectField'),\n        'keywords': document.getElementById('keywordsField'),\n        'creationDate': document.getElementById('creationDateField'),\n        'modificationDate': document.getElementById('modificationDateField'),\n        'creator': document.getElementById('creatorField'),\n        'producer': document.getElementById('producerField'),\n        'version': document.getElementById('versionField'),\n        'pageCount': document.getElementById('pageCountField'),\n        'pageSize': document.getElementById('pageSizeField'),\n        'linearized': document.getElementById('linearizedField'),\n      },\n    },\n    errorWrapper: {\n      container: document.getElementById('errorWrapper'),\n      errorMessage: document.getElementById('errorMessage'),\n      closeButton: document.getElementById('errorClose'),\n      errorMoreInfo: document.getElementById('errorMoreInfo'),\n      moreInfoButton: document.getElementById('errorShowMore'),\n      lessInfoButton: document.getElementById('errorShowLess'),\n    },\n    printContainer: document.getElementById('printContainer'),\n    openFileInputName: 'fileInput',\n    debuggerScriptPath: './debugger.js',\n  };\n}\n\nfunction webViewerLoad() {\n  let config = getViewerConfiguration();\n  if (typeof PDFJSDev === 'undefined' || !PDFJSDev.test('PRODUCTION')) {\n    Promise.all([\n      SystemJS.import('pdfjs-web/app'),\n      SystemJS.import('pdfjs-web/app_options'),\n      SystemJS.import('pdfjs-web/genericcom'),\n      SystemJS.import('pdfjs-web/pdf_print_service'),\n    ]).then(function([app, appOptions, ...otherModules]) {\n      window.PDFViewerApplication = app.PDFViewerApplication;\n      window.PDFViewerApplicationOptions = appOptions.AppOptions;\n      app.PDFViewerApplication.run(config);\n    });\n  } else {\n    if (typeof PDFJSDev !== 'undefined' && PDFJSDev.test('CHROME')) {\n      pdfjsWebAppOptions.AppOptions.set('defaultUrl', defaultUrl);\n    }\n\n    window.PDFViewerApplication = pdfjsWebApp.PDFViewerApplication;\n    window.PDFViewerApplicationOptions = pdfjsWebAppOptions.AppOptions;\n\n    if (typeof PDFJSDev !== 'undefined' && PDFJSDev.test('GENERIC')) {\n      // Give custom implementations of the default viewer a simpler way to\n      // set various `AppOptions`, by dispatching an event once all viewer\n      // files are loaded but *before* the viewer initialization has run.\n      const event = document.createEvent('CustomEvent');\n      event.initCustomEvent('webviewerloaded', true, true, {});\n      document.dispatchEvent(event);\n    }\n\n    pdfjsWebApp.PDFViewerApplication.run(config);\n  }\n}\n\nif (document.readyState === 'interactive' ||\n    document.readyState === 'complete') {\n  webViewerLoad();\n} else {\n  document.addEventListener('DOMContentLoaded', webViewerLoad, true);\n}\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/* globals PDFBug, Stats */\n\nimport {\n  animationStarted, DEFAULT_SCALE_VALUE, getGlobalEventBus,\n  getPDFFileNameFromURL, isValidRotation, isValidScrollMode, isValidSpreadMode,\n  MAX_SCALE, MIN_SCALE, noContextMenuHandler, normalizeWheelEventDelta,\n  parseQueryString, PresentationModeState, ProgressBar, RendererType,\n  ScrollMode, SpreadMode, TextLayerMode\n} from './ui_utils';\nimport { AppOptions, OptionKind } from './app_options';\nimport {\n  build, createObjectURL, getDocument, getFilenameFromUrl, GlobalWorkerOptions,\n  InvalidPDFException, LinkTarget, loadScript, MissingPDFException, OPS,\n  PDFWorker, shadow, UnexpectedResponseException, UNSUPPORTED_FEATURES, version\n} from 'pdfjs-lib';\nimport { CursorTool, PDFCursorTools } from './pdf_cursor_tools';\nimport { PDFRenderingQueue, RenderingStates } from './pdf_rendering_queue';\nimport { PDFSidebar, SidebarView } from './pdf_sidebar';\nimport { OverlayManager } from './overlay_manager';\nimport { PasswordPrompt } from './password_prompt';\nimport { PDFAttachmentViewer } from './pdf_attachment_viewer';\nimport { PDFDocumentProperties } from './pdf_document_properties';\nimport { PDFFindBar } from './pdf_find_bar';\nimport { PDFFindController } from './pdf_find_controller';\nimport { PDFHistory } from './pdf_history';\nimport { PDFLinkService } from './pdf_link_service';\nimport { PDFOutlineViewer } from './pdf_outline_viewer';\nimport { PDFPresentationMode } from './pdf_presentation_mode';\nimport { PDFSidebarResizer } from './pdf_sidebar_resizer';\nimport { PDFThumbnailViewer } from './pdf_thumbnail_viewer';\nimport { PDFViewer } from './pdf_viewer';\nimport { SecondaryToolbar } from './secondary_toolbar';\nimport { Toolbar } from './toolbar';\nimport { ViewHistory } from './view_history';\n\nconst DEFAULT_SCALE_DELTA = 1.1;\nconst DISABLE_AUTO_FETCH_LOADING_BAR_TIMEOUT = 5000; // ms\nconst FORCE_PAGES_LOADED_TIMEOUT = 10000; // ms\nconst WHEEL_ZOOM_DISABLED_TIMEOUT = 1000; // ms\n\nconst ViewOnLoad = {\n  UNKNOWN: -1,\n  PREVIOUS: 0, // Default value.\n  INITIAL: 1,\n};\n\nconst DefaultExternalServices = {\n  updateFindControlState(data) {},\n  updateFindMatchesCount(data) {},\n  initPassiveLoading(callbacks) {},\n  fallback(data, callback) {},\n  reportTelemetry(data) {},\n  createDownloadManager(options) {\n    throw new Error('Not implemented: createDownloadManager');\n  },\n  createPreferences() {\n    throw new Error('Not implemented: createPreferences');\n  },\n  createL10n(options) {\n    throw new Error('Not implemented: createL10n');\n  },\n  supportsIntegratedFind: false,\n  supportsDocumentFonts: true,\n  supportsDocumentColors: true,\n  supportedMouseWheelZoomModifierKeys: {\n    ctrlKey: true,\n    metaKey: true,\n  },\n};\n\nlet PDFViewerApplication = {\n  initialBookmark: document.location.hash.substring(1),\n  initialized: false,\n  fellback: false,\n  appConfig: null,\n  pdfDocument: null,\n  pdfLoadingTask: null,\n  printService: null,\n  /** @type {PDFViewer} */\n  pdfViewer: null,\n  /** @type {PDFThumbnailViewer} */\n  pdfThumbnailViewer: null,\n  /** @type {PDFRenderingQueue} */\n  pdfRenderingQueue: null,\n  /** @type {PDFPresentationMode} */\n  pdfPresentationMode: null,\n  /** @type {PDFDocumentProperties} */\n  pdfDocumentProperties: null,\n  /** @type {PDFLinkService} */\n  pdfLinkService: null,\n  /** @type {PDFHistory} */\n  pdfHistory: null,\n  /** @type {PDFSidebar} */\n  pdfSidebar: null,\n  /** @type {PDFSidebarResizer} */\n  pdfSidebarResizer: null,\n  /** @type {PDFOutlineViewer} */\n  pdfOutlineViewer: null,\n  /** @type {PDFAttachmentViewer} */\n  pdfAttachmentViewer: null,\n  /** @type {PDFCursorTools} */\n  pdfCursorTools: null,\n  /** @type {ViewHistory} */\n  store: null,\n  /** @type {DownloadManager} */\n  downloadManager: null,\n  /** @type {OverlayManager} */\n  overlayManager: null,\n  /** @type {Preferences} */\n  preferences: null,\n  /** @type {Toolbar} */\n  toolbar: null,\n  /** @type {SecondaryToolbar} */\n  secondaryToolbar: null,\n  /** @type {EventBus} */\n  eventBus: null,\n  /** @type {IL10n} */\n  l10n: null,\n  isInitialViewSet: false,\n  downloadComplete: false,\n  isViewerEmbedded: (window.parent !== window),\n  url: '',\n  baseUrl: '',\n  externalServices: DefaultExternalServices,\n  _boundEvents: {},\n  contentDispositionFilename: null,\n\n  // Called once when the document is loaded.\n  async initialize(appConfig) {\n    this.preferences = this.externalServices.createPreferences();\n    this.appConfig = appConfig;\n\n    await this._readPreferences();\n    await this._parseHashParameters();\n    await this._initializeL10n();\n\n    if (this.isViewerEmbedded &&\n        AppOptions.get('externalLinkTarget') === LinkTarget.NONE) {\n      // Prevent external links from \"replacing\" the viewer,\n      // when it's embedded in e.g. an <iframe> or an <object>.\n      AppOptions.set('externalLinkTarget', LinkTarget.TOP);\n    }\n    await this._initializeViewerComponents();\n\n    // Bind the various event handlers *after* the viewer has been\n    // initialized, to prevent errors if an event arrives too soon.\n    this.bindEvents();\n    this.bindWindowEvents();\n\n    // We can start UI localization now.\n    let appContainer = appConfig.appContainer || document.documentElement;\n    this.l10n.translate(appContainer).then(() => {\n      // Dispatch the 'localized' event on the `eventBus` once the viewer\n      // has been fully initialized and translated.\n      this.eventBus.dispatch('localized', { source: this, });\n    });\n\n    this.initialized = true;\n  },\n\n  /**\n   * @private\n   */\n  async _readPreferences() {\n    if (AppOptions.get('disablePreferences') === true) {\n      // Give custom implementations of the default viewer a simpler way to\n      // opt-out of having the `Preferences` override existing `AppOptions`.\n      return;\n    }\n    try {\n      const prefs = await this.preferences.getAll();\n      for (const name in prefs) {\n        AppOptions.set(name, prefs[name]);\n      }\n    } catch (reason) {\n      console.error(`_readPreferences: \"${reason.message}\".`);\n    }\n  },\n\n  /**\n   * @private\n   */\n  async _parseHashParameters() {\n    if (typeof PDFJSDev !== 'undefined' && PDFJSDev.test('PRODUCTION') &&\n        !AppOptions.get('pdfBugEnabled')) {\n      return undefined;\n    }\n    const waitOn = [];\n\n    // Special debugging flags in the hash section of the URL.\n    let hash = document.location.hash.substring(1);\n    let hashParams = parseQueryString(hash);\n\n    if ('disableworker' in hashParams &&\n        hashParams['disableworker'] === 'true') {\n      waitOn.push(loadFakeWorker());\n    }\n    if ('disablerange' in hashParams) {\n      AppOptions.set('disableRange', hashParams['disablerange'] === 'true');\n    }\n    if ('disablestream' in hashParams) {\n      AppOptions.set('disableStream', hashParams['disablestream'] === 'true');\n    }\n    if ('disableautofetch' in hashParams) {\n      AppOptions.set('disableAutoFetch',\n                     hashParams['disableautofetch'] === 'true');\n    }\n    if ('disablefontface' in hashParams) {\n      AppOptions.set('disableFontFace',\n                     hashParams['disablefontface'] === 'true');\n    }\n    if ('disablehistory' in hashParams) {\n      AppOptions.set('disableHistory', hashParams['disablehistory'] === 'true');\n    }\n    if ('webgl' in hashParams) {\n      AppOptions.set('enableWebGL', hashParams['webgl'] === 'true');\n    }\n    if ('useonlycsszoom' in hashParams) {\n      AppOptions.set('useOnlyCssZoom', hashParams['useonlycsszoom'] === 'true');\n    }\n    if ('verbosity' in hashParams) {\n      AppOptions.set('verbosity', hashParams['verbosity'] | 0);\n    }\n    if ('textlayer' in hashParams) {\n      switch (hashParams['textlayer']) {\n        case 'off':\n          AppOptions.set('textLayerMode', TextLayerMode.DISABLE);\n          break;\n        case 'visible':\n        case 'shadow':\n        case 'hover':\n          let viewer = this.appConfig.viewerContainer;\n          viewer.classList.add('textLayer-' + hashParams['textlayer']);\n          break;\n      }\n    }\n    if ('pdfbug' in hashParams) {\n      AppOptions.set('pdfBug', true);\n      let enabled = hashParams['pdfbug'].split(',');\n      waitOn.push(loadAndEnablePDFBug(enabled));\n    }\n    // It is not possible to change locale for the (various) extension builds.\n    if ((typeof PDFJSDev === 'undefined' ||\n         PDFJSDev.test('!PRODUCTION || GENERIC')) && 'locale' in hashParams) {\n      AppOptions.set('locale', hashParams['locale']);\n    }\n\n    return Promise.all(waitOn).catch((reason) => {\n      console.error(`_parseHashParameters: \"${reason.message}\".`);\n    });\n  },\n\n  /**\n   * @private\n   */\n  async _initializeL10n() {\n    this.l10n = this.externalServices.createL10n({\n      locale: AppOptions.get('locale'),\n    });\n    const dir = await this.l10n.getDirection();\n    document.getElementsByTagName('html')[0].dir = dir;\n  },\n\n  /**\n   * @private\n   */\n  async _initializeViewerComponents() {\n    const appConfig = this.appConfig;\n\n    this.overlayManager = new OverlayManager();\n\n    const eventBus = appConfig.eventBus ||\n                     getGlobalEventBus(AppOptions.get('eventBusDispatchToDOM'));\n    this.eventBus = eventBus;\n\n    let pdfRenderingQueue = new PDFRenderingQueue();\n    pdfRenderingQueue.onIdle = this.cleanup.bind(this);\n    this.pdfRenderingQueue = pdfRenderingQueue;\n\n    let pdfLinkService = new PDFLinkService({\n      eventBus,\n      externalLinkTarget: AppOptions.get('externalLinkTarget'),\n      externalLinkRel: AppOptions.get('externalLinkRel'),\n    });\n    this.pdfLinkService = pdfLinkService;\n\n    let downloadManager = this.externalServices.createDownloadManager({\n      disableCreateObjectURL: AppOptions.get('disableCreateObjectURL'),\n    });\n    this.downloadManager = downloadManager;\n\n    const findController = new PDFFindController({\n      linkService: pdfLinkService,\n      eventBus,\n    });\n    this.findController = findController;\n\n    const container = appConfig.mainContainer;\n    const viewer = appConfig.viewerContainer;\n    this.pdfViewer = new PDFViewer({\n      container,\n      viewer,\n      eventBus,\n      renderingQueue: pdfRenderingQueue,\n      linkService: pdfLinkService,\n      downloadManager,\n      findController,\n      renderer: AppOptions.get('renderer'),\n      enableWebGL: AppOptions.get('enableWebGL'),\n      l10n: this.l10n,\n      textLayerMode: AppOptions.get('textLayerMode'),\n      imageResourcesPath: AppOptions.get('imageResourcesPath'),\n      renderInteractiveForms: AppOptions.get('renderInteractiveForms'),\n      enablePrintAutoRotate: AppOptions.get('enablePrintAutoRotate'),\n      useOnlyCssZoom: AppOptions.get('useOnlyCssZoom'),\n      maxCanvasPixels: AppOptions.get('maxCanvasPixels'),\n    });\n    pdfRenderingQueue.setViewer(this.pdfViewer);\n    pdfLinkService.setViewer(this.pdfViewer);\n\n    this.pdfThumbnailViewer = new PDFThumbnailViewer({\n      container: appConfig.sidebar.thumbnailView,\n      renderingQueue: pdfRenderingQueue,\n      linkService: pdfLinkService,\n      l10n: this.l10n,\n    });\n    pdfRenderingQueue.setThumbnailViewer(this.pdfThumbnailViewer);\n\n    this.pdfHistory = new PDFHistory({\n      linkService: pdfLinkService,\n      eventBus,\n    });\n    pdfLinkService.setHistory(this.pdfHistory);\n\n    if (!this.supportsIntegratedFind) {\n      this.findBar = new PDFFindBar(appConfig.findBar, eventBus, this.l10n);\n    }\n\n    this.pdfDocumentProperties =\n      new PDFDocumentProperties(appConfig.documentProperties,\n                                this.overlayManager, eventBus, this.l10n);\n\n    this.pdfCursorTools = new PDFCursorTools({\n      container,\n      eventBus,\n      cursorToolOnLoad: AppOptions.get('cursorToolOnLoad'),\n    });\n\n    this.toolbar = new Toolbar(appConfig.toolbar, eventBus, this.l10n);\n\n    this.secondaryToolbar =\n      new SecondaryToolbar(appConfig.secondaryToolbar, container, eventBus);\n\n    if (this.supportsFullscreen) {\n      this.pdfPresentationMode = new PDFPresentationMode({\n        container,\n        viewer,\n        pdfViewer: this.pdfViewer,\n        eventBus,\n        contextMenuItems: appConfig.fullscreen,\n      });\n    }\n\n    this.passwordPrompt = new PasswordPrompt(appConfig.passwordOverlay,\n                                             this.overlayManager, this.l10n);\n\n    this.pdfOutlineViewer = new PDFOutlineViewer({\n      container: appConfig.sidebar.outlineView,\n      eventBus,\n      linkService: pdfLinkService,\n    });\n\n    this.pdfAttachmentViewer = new PDFAttachmentViewer({\n      container: appConfig.sidebar.attachmentsView,\n      eventBus,\n      downloadManager,\n    });\n\n    this.pdfSidebar = new PDFSidebar({\n      elements: appConfig.sidebar,\n      pdfViewer: this.pdfViewer,\n      pdfThumbnailViewer: this.pdfThumbnailViewer,\n      eventBus,\n      l10n: this.l10n,\n    });\n    this.pdfSidebar.onToggled = this.forceRendering.bind(this);\n\n    this.pdfSidebarResizer = new PDFSidebarResizer(appConfig.sidebarResizer,\n                                                   eventBus, this.l10n);\n  },\n\n  run(config) {\n    this.initialize(config).then(webViewerInitialized);\n  },\n\n  zoomIn(ticks) {\n    if (this.pdfViewer.isInPresentationMode) {\n      return;\n    }\n    let newScale = this.pdfViewer.currentScale;\n    do {\n      newScale = (newScale * DEFAULT_SCALE_DELTA).toFixed(2);\n      newScale = Math.ceil(newScale * 10) / 10;\n      newScale = Math.min(MAX_SCALE, newScale);\n    } while (--ticks > 0 && newScale < MAX_SCALE);\n    this.pdfViewer.currentScaleValue = newScale;\n  },\n\n  zoomOut(ticks) {\n    if (this.pdfViewer.isInPresentationMode) {\n      return;\n    }\n    let newScale = this.pdfViewer.currentScale;\n    do {\n      newScale = (newScale / DEFAULT_SCALE_DELTA).toFixed(2);\n      newScale = Math.floor(newScale * 10) / 10;\n      newScale = Math.max(MIN_SCALE, newScale);\n    } while (--ticks > 0 && newScale > MIN_SCALE);\n    this.pdfViewer.currentScaleValue = newScale;\n  },\n\n  zoomReset() {\n    if (this.pdfViewer.isInPresentationMode) {\n      return;\n    }\n    this.pdfViewer.currentScaleValue = DEFAULT_SCALE_VALUE;\n  },\n\n  get pagesCount() {\n    return this.pdfDocument ? this.pdfDocument.numPages : 0;\n  },\n\n  set page(val) {\n    this.pdfViewer.currentPageNumber = val;\n  },\n\n  get page() {\n    return this.pdfViewer.currentPageNumber;\n  },\n\n  get printing() {\n    return !!this.printService;\n  },\n\n  get supportsPrinting() {\n    return PDFPrintServiceFactory.instance.supportsPrinting;\n  },\n\n  get supportsFullscreen() {\n    let support;\n    if (typeof PDFJSDev !== 'undefined' && PDFJSDev.test('MOZCENTRAL')) {\n      support = document.fullscreenEnabled === true ||\n                document.mozFullScreenEnabled === true;\n    } else {\n      let doc = document.documentElement;\n      support = !!(doc.requestFullscreen || doc.mozRequestFullScreen ||\n                   doc.webkitRequestFullScreen || doc.msRequestFullscreen);\n\n      if (document.fullscreenEnabled === false ||\n          document.mozFullScreenEnabled === false ||\n          document.webkitFullscreenEnabled === false ||\n          document.msFullscreenEnabled === false) {\n        support = false;\n      }\n    }\n    return shadow(this, 'supportsFullscreen', support);\n  },\n\n  get supportsIntegratedFind() {\n    return this.externalServices.supportsIntegratedFind;\n  },\n\n  get supportsDocumentFonts() {\n    return this.externalServices.supportsDocumentFonts;\n  },\n\n  get supportsDocumentColors() {\n    return this.externalServices.supportsDocumentColors;\n  },\n\n  get loadingBar() {\n    let bar = new ProgressBar('#loadingBar');\n    return shadow(this, 'loadingBar', bar);\n  },\n\n  get supportedMouseWheelZoomModifierKeys() {\n    return this.externalServices.supportedMouseWheelZoomModifierKeys;\n  },\n\n  initPassiveLoading() {\n    if (typeof PDFJSDev === 'undefined' ||\n        !PDFJSDev.test('FIREFOX || MOZCENTRAL || CHROME')) {\n      throw new Error('Not implemented: initPassiveLoading');\n    }\n    this.externalServices.initPassiveLoading({\n      onOpenWithTransport(url, length, transport) {\n        PDFViewerApplication.open(url, { length, range: transport, });\n      },\n      onOpenWithData(data) {\n        PDFViewerApplication.open(data);\n      },\n      onOpenWithURL(url, length, originalUrl) {\n        let file = url, args = null;\n        if (length !== undefined) {\n          args = { length, };\n        }\n        if (originalUrl !== undefined) {\n          file = { url, originalUrl, };\n        }\n        PDFViewerApplication.open(file, args);\n      },\n      onError(err) {\n        PDFViewerApplication.l10n.get('loading_error', null,\n            'An error occurred while loading the PDF.').then((msg) => {\n          PDFViewerApplication.error(msg, err);\n        });\n      },\n      onProgress(loaded, total) {\n        PDFViewerApplication.progress(loaded / total);\n      },\n    });\n  },\n\n  setTitleUsingUrl(url = '') {\n    this.url = url;\n    this.baseUrl = url.split('#')[0];\n    let title = getPDFFileNameFromURL(url, '');\n    if (!title) {\n      try {\n        title = decodeURIComponent(getFilenameFromUrl(url)) || url;\n      } catch (ex) {\n        // decodeURIComponent may throw URIError,\n        // fall back to using the unprocessed url in that case\n        title = url;\n      }\n    }\n    this.setTitle(title);\n  },\n\n  setTitle(title) {\n    if (this.isViewerEmbedded) {\n      // Embedded PDF viewers should not be changing their parent page's title.\n      return;\n    }\n    document.title = title;\n  },\n\n  /**\n   * Closes opened PDF document.\n   * @returns {Promise} - Returns the promise, which is resolved when all\n   *                      destruction is completed.\n   */\n  async close() {\n    let errorWrapper = this.appConfig.errorWrapper.container;\n    errorWrapper.setAttribute('hidden', 'true');\n\n    if (!this.pdfLoadingTask) {\n      return undefined;\n    }\n\n    let promise = this.pdfLoadingTask.destroy();\n    this.pdfLoadingTask = null;\n\n    if (this.pdfDocument) {\n      this.pdfDocument = null;\n\n      this.pdfThumbnailViewer.setDocument(null);\n      this.pdfViewer.setDocument(null);\n      this.pdfLinkService.setDocument(null);\n      this.pdfDocumentProperties.setDocument(null);\n    }\n    this.store = null;\n    this.isInitialViewSet = false;\n    this.downloadComplete = false;\n    this.url = '';\n    this.baseUrl = '';\n    this.contentDispositionFilename = null;\n\n    this.pdfSidebar.reset();\n    this.pdfOutlineViewer.reset();\n    this.pdfAttachmentViewer.reset();\n\n    if (this.findBar) {\n      this.findBar.reset();\n    }\n    this.toolbar.reset();\n    this.secondaryToolbar.reset();\n\n    if (typeof PDFBug !== 'undefined') {\n      PDFBug.cleanup();\n    }\n    return promise;\n  },\n\n  /**\n   * Opens PDF document specified by URL or array with additional arguments.\n   * @param {string|TypedArray|ArrayBuffer} file - PDF location or binary data.\n   * @param {Object} args - (optional) Additional arguments for the getDocument\n   *                        call, e.g. HTTP headers ('httpHeaders') or\n   *                        alternative data transport ('range').\n   * @returns {Promise} - Returns the promise, which is resolved when document\n   *                      is opened.\n   */\n  async open(file, args) {\n    if (this.pdfLoadingTask) {\n      // We need to destroy already opened document.\n      await this.close();\n    }\n    // Set the necessary global worker parameters, using the available options.\n    const workerParameters = AppOptions.getAll(OptionKind.WORKER);\n    for (let key in workerParameters) {\n      GlobalWorkerOptions[key] = workerParameters[key];\n    }\n\n    let parameters = Object.create(null);\n    if (typeof file === 'string') { // URL\n      this.setTitleUsingUrl(file);\n      parameters.url = file;\n    } else if (file && 'byteLength' in file) { // ArrayBuffer\n      parameters.data = file;\n    } else if (file.url && file.originalUrl) {\n      this.setTitleUsingUrl(file.originalUrl);\n      parameters.url = file.url;\n    }\n    // Set the necessary API parameters, using the available options.\n    const apiParameters = AppOptions.getAll(OptionKind.API);\n    for (let key in apiParameters) {\n      let value = apiParameters[key];\n\n      if (key === 'docBaseUrl' && !value) {\n        if (typeof PDFJSDev === 'undefined' || !PDFJSDev.test('PRODUCTION')) {\n          value = document.URL.split('#')[0];\n        } else if (typeof PDFJSDev !== 'undefined' &&\n                   PDFJSDev.test('FIREFOX || MOZCENTRAL || CHROME')) {\n          value = this.baseUrl;\n        }\n      }\n      parameters[key] = value;\n    }\n\n    if (args) {\n      for (let key in args) {\n        const value = args[key];\n\n        if (key === 'length') {\n          this.pdfDocumentProperties.setFileSize(value);\n        }\n        parameters[key] = value;\n      }\n    }\n\n    let loadingTask = getDocument(parameters);\n    this.pdfLoadingTask = loadingTask;\n\n    loadingTask.onPassword = (updateCallback, reason) => {\n      this.pdfLinkService.externalLinkEnabled = false;\n      this.passwordPrompt.setUpdateCallback(updateCallback, reason);\n      this.passwordPrompt.open();\n    };\n\n    loadingTask.onProgress = ({ loaded, total, }) => {\n      this.progress(loaded / total);\n    };\n\n    // Listen for unsupported features to trigger the fallback UI.\n    loadingTask.onUnsupportedFeature = this.fallback.bind(this);\n\n    return loadingTask.promise.then((pdfDocument) => {\n      this.load(pdfDocument);\n    }, (exception) => {\n      if (loadingTask !== this.pdfLoadingTask) {\n        return undefined; // Ignore errors for previously opened PDF files.\n      }\n\n      let message = exception && exception.message;\n      let loadingErrorMessage;\n      if (exception instanceof InvalidPDFException) {\n        // change error message also for other builds\n        loadingErrorMessage = this.l10n.get('invalid_file_error', null,\n                                            'Invalid or corrupted PDF file.');\n      } else if (exception instanceof MissingPDFException) {\n        // special message for missing PDF's\n        loadingErrorMessage = this.l10n.get('missing_file_error', null,\n                                            'Missing PDF file.');\n      } else if (exception instanceof UnexpectedResponseException) {\n        loadingErrorMessage = this.l10n.get('unexpected_response_error', null,\n                                            'Unexpected server response.');\n      } else {\n        loadingErrorMessage = this.l10n.get('loading_error', null,\n          'An error occurred while loading the PDF.');\n      }\n\n      return loadingErrorMessage.then((msg) => {\n        this.error(msg, { message, });\n        throw new Error(msg);\n      });\n    });\n  },\n\n  download() {\n    function downloadByUrl() {\n      downloadManager.downloadUrl(url, filename);\n    }\n\n    let url = this.baseUrl;\n    // Use this.url instead of this.baseUrl to perform filename detection based\n    // on the reference fragment as ultimate fallback if needed.\n    let filename = this.contentDispositionFilename ||\n      getPDFFileNameFromURL(this.url);\n    let downloadManager = this.downloadManager;\n    downloadManager.onerror = (err) => {\n      // This error won't really be helpful because it's likely the\n      // fallback won't work either (or is already open).\n      this.error(`PDF failed to download: ${err}`);\n    };\n\n    // When the PDF document isn't ready, or the PDF file is still downloading,\n    // simply download using the URL.\n    if (!this.pdfDocument || !this.downloadComplete) {\n      downloadByUrl();\n      return;\n    }\n\n    this.pdfDocument.getData().then(function(data) {\n      const blob = new Blob([data], { type: 'application/pdf', });\n      downloadManager.download(blob, url, filename);\n    }).catch(downloadByUrl); // Error occurred, try downloading with the URL.\n  },\n\n  fallback(featureId) {\n    if (typeof PDFJSDev !== 'undefined' &&\n        PDFJSDev.test('FIREFOX || MOZCENTRAL')) {\n      // Only trigger the fallback once so we don't spam the user with messages\n      // for one PDF.\n      if (this.fellback) {\n        return;\n      }\n      this.fellback = true;\n      this.externalServices.fallback({\n        featureId,\n        url: this.baseUrl,\n      }, function response(download) {\n        if (!download) {\n          return;\n        }\n        PDFViewerApplication.download();\n      });\n    }\n  },\n\n  /**\n   * Show the error box.\n   * @param {String} message A message that is human readable.\n   * @param {Object} moreInfo (optional) Further information about the error\n   *                            that is more technical.  Should have a 'message'\n   *                            and optionally a 'stack' property.\n   */\n  error(message, moreInfo) {\n    let moreInfoText = [this.l10n.get('error_version_info',\n      { version: version || '?', build: build || '?', },\n      'PDF.js v{{version}} (build: {{build}})')];\n    if (moreInfo) {\n      moreInfoText.push(\n        this.l10n.get('error_message', { message: moreInfo.message, },\n                      'Message: {{message}}'));\n      if (moreInfo.stack) {\n        moreInfoText.push(\n          this.l10n.get('error_stack', { stack: moreInfo.stack, },\n                        'Stack: {{stack}}'));\n      } else {\n        if (moreInfo.filename) {\n          moreInfoText.push(\n            this.l10n.get('error_file', { file: moreInfo.filename, },\n                          'File: {{file}}'));\n        }\n        if (moreInfo.lineNumber) {\n          moreInfoText.push(\n            this.l10n.get('error_line', { line: moreInfo.lineNumber, },\n                          'Line: {{line}}'));\n        }\n      }\n    }\n\n    if (typeof PDFJSDev === 'undefined' ||\n        !PDFJSDev.test('FIREFOX || MOZCENTRAL')) {\n      let errorWrapperConfig = this.appConfig.errorWrapper;\n      let errorWrapper = errorWrapperConfig.container;\n      errorWrapper.removeAttribute('hidden');\n\n      let errorMessage = errorWrapperConfig.errorMessage;\n      errorMessage.textContent = message;\n\n      let closeButton = errorWrapperConfig.closeButton;\n      closeButton.onclick = function() {\n        errorWrapper.setAttribute('hidden', 'true');\n      };\n\n      let errorMoreInfo = errorWrapperConfig.errorMoreInfo;\n      let moreInfoButton = errorWrapperConfig.moreInfoButton;\n      let lessInfoButton = errorWrapperConfig.lessInfoButton;\n      moreInfoButton.onclick = function() {\n        errorMoreInfo.removeAttribute('hidden');\n        moreInfoButton.setAttribute('hidden', 'true');\n        lessInfoButton.removeAttribute('hidden');\n        errorMoreInfo.style.height = errorMoreInfo.scrollHeight + 'px';\n      };\n      lessInfoButton.onclick = function() {\n        errorMoreInfo.setAttribute('hidden', 'true');\n        moreInfoButton.removeAttribute('hidden');\n        lessInfoButton.setAttribute('hidden', 'true');\n      };\n      moreInfoButton.oncontextmenu = noContextMenuHandler;\n      lessInfoButton.oncontextmenu = noContextMenuHandler;\n      closeButton.oncontextmenu = noContextMenuHandler;\n      moreInfoButton.removeAttribute('hidden');\n      lessInfoButton.setAttribute('hidden', 'true');\n      Promise.all(moreInfoText).then((parts) => {\n        errorMoreInfo.value = parts.join('\\n');\n      });\n    } else {\n      Promise.all(moreInfoText).then((parts) => {\n        console.error(message + '\\n' + parts.join('\\n'));\n      });\n      this.fallback();\n    }\n  },\n\n  progress(level) {\n    if (this.downloadComplete) {\n      // Don't accidentally show the loading bar again when the entire file has\n      // already been fetched (only an issue when disableAutoFetch is enabled).\n      return;\n    }\n    let percent = Math.round(level * 100);\n    // When we transition from full request to range requests, it's possible\n    // that we discard some of the loaded data. This can cause the loading\n    // bar to move backwards. So prevent this by only updating the bar if it\n    // increases.\n    if (percent > this.loadingBar.percent || isNaN(percent)) {\n      this.loadingBar.percent = percent;\n\n      // When disableAutoFetch is enabled, it's not uncommon for the entire file\n      // to never be fetched (depends on e.g. the file structure). In this case\n      // the loading bar will not be completely filled, nor will it be hidden.\n      // To prevent displaying a partially filled loading bar permanently, we\n      // hide it when no data has been loaded during a certain amount of time.\n      const disableAutoFetch = this.pdfDocument ?\n        this.pdfDocument.loadingParams['disableAutoFetch'] :\n        AppOptions.get('disableAutoFetch');\n\n      if (disableAutoFetch && percent) {\n        if (this.disableAutoFetchLoadingBarTimeout) {\n          clearTimeout(this.disableAutoFetchLoadingBarTimeout);\n          this.disableAutoFetchLoadingBarTimeout = null;\n        }\n        this.loadingBar.show();\n\n        this.disableAutoFetchLoadingBarTimeout = setTimeout(() => {\n          this.loadingBar.hide();\n          this.disableAutoFetchLoadingBarTimeout = null;\n        }, DISABLE_AUTO_FETCH_LOADING_BAR_TIMEOUT);\n      }\n    }\n  },\n\n  load(pdfDocument) {\n    this.pdfDocument = pdfDocument;\n\n    pdfDocument.getDownloadInfo().then(() => {\n      this.downloadComplete = true;\n      this.loadingBar.hide();\n\n      firstPagePromise.then(() => {\n        this.eventBus.dispatch('documentloaded', { source: this, });\n      });\n    });\n\n    // Since the `setInitialView` call below depends on this being resolved,\n    // fetch it early to avoid delaying initial rendering of the PDF document.\n    const pageLayoutPromise = pdfDocument.getPageLayout().catch(\n      function() { /* Avoid breaking initial rendering; ignoring errors. */ });\n    const pageModePromise = pdfDocument.getPageMode().catch(\n      function() { /* Avoid breaking initial rendering; ignoring errors. */ });\n    const openActionDestPromise = pdfDocument.getOpenActionDestination().catch(\n      function() { /* Avoid breaking initial rendering; ignoring errors. */ });\n\n    this.toolbar.setPagesCount(pdfDocument.numPages, false);\n    this.secondaryToolbar.setPagesCount(pdfDocument.numPages);\n\n    const store = this.store = new ViewHistory(pdfDocument.fingerprint);\n\n    let baseDocumentUrl;\n    if (typeof PDFJSDev === 'undefined' || PDFJSDev.test('GENERIC')) {\n      baseDocumentUrl = null;\n    } else if (PDFJSDev.test('FIREFOX || MOZCENTRAL')) {\n      baseDocumentUrl = this.baseUrl;\n    } else if (PDFJSDev.test('CHROME')) {\n      baseDocumentUrl = location.href.split('#')[0];\n    }\n    this.pdfLinkService.setDocument(pdfDocument, baseDocumentUrl);\n    this.pdfDocumentProperties.setDocument(pdfDocument, this.url);\n\n    let pdfViewer = this.pdfViewer;\n    pdfViewer.setDocument(pdfDocument);\n    let firstPagePromise = pdfViewer.firstPagePromise;\n    let pagesPromise = pdfViewer.pagesPromise;\n    let onePageRendered = pdfViewer.onePageRendered;\n\n    let pdfThumbnailViewer = this.pdfThumbnailViewer;\n    pdfThumbnailViewer.setDocument(pdfDocument);\n\n    firstPagePromise.then((pdfPage) => {\n      this.loadingBar.setWidth(this.appConfig.viewerContainer);\n\n      const storePromise = store.getMultiple({\n        page: null,\n        zoom: DEFAULT_SCALE_VALUE,\n        scrollLeft: '0',\n        scrollTop: '0',\n        rotation: null,\n        sidebarView: SidebarView.UNKNOWN,\n        scrollMode: ScrollMode.UNKNOWN,\n        spreadMode: SpreadMode.UNKNOWN,\n      }).catch(() => { /* Unable to read from storage; ignoring errors. */ });\n\n      Promise.all([\n        animationStarted,\n        storePromise,\n        pageLayoutPromise,\n        pageModePromise,\n        openActionDestPromise,\n      ]).then(async ([timeStamp, values = {}, pageLayout, pageMode,\n                      openActionDest]) => {\n        const viewOnLoad = AppOptions.get('viewOnLoad');\n\n        this._initializePdfHistory({\n          fingerprint: pdfDocument.fingerprint,\n          viewOnLoad,\n          initialDest: openActionDest,\n        });\n        const initialBookmark = this.initialBookmark;\n\n        // Initialize the default values, from user preferences.\n        const zoom = AppOptions.get('defaultZoomValue');\n        let hash = zoom ? `zoom=${zoom}` : null;\n\n        let rotation = null;\n        let sidebarView = AppOptions.get('sidebarViewOnLoad');\n        let scrollMode = AppOptions.get('scrollModeOnLoad');\n        let spreadMode = AppOptions.get('spreadModeOnLoad');\n\n        if (values.page && viewOnLoad !== ViewOnLoad.INITIAL) {\n          hash = `page=${values.page}&zoom=${zoom || values.zoom},` +\n                 `${values.scrollLeft},${values.scrollTop}`;\n\n          rotation = parseInt(values.rotation, 10);\n          // Always let user preferences take precedence over the view history.\n          if (sidebarView === SidebarView.UNKNOWN) {\n            sidebarView = (values.sidebarView | 0);\n          }\n          if (scrollMode === ScrollMode.UNKNOWN) {\n            scrollMode = (values.scrollMode | 0);\n          }\n          if (spreadMode === SpreadMode.UNKNOWN) {\n            spreadMode = (values.spreadMode | 0);\n          }\n        }\n        // Always let the user preference/view history take precedence.\n        if (pageMode && sidebarView === SidebarView.UNKNOWN) {\n          sidebarView = apiPageModeToSidebarView(pageMode);\n        }\n        if (pageLayout && spreadMode === SpreadMode.UNKNOWN) {\n          spreadMode = apiPageLayoutToSpreadMode(pageLayout);\n        }\n\n        this.setInitialView(hash, {\n          rotation, sidebarView, scrollMode, spreadMode,\n        });\n        this.eventBus.dispatch('documentinit', { source: this, });\n        // Make all navigation keys work on document load,\n        // unless the viewer is embedded in a web page.\n        if (!this.isViewerEmbedded) {\n          pdfViewer.focus();\n        }\n\n        // For documents with different page sizes, once all pages are resolved,\n        // ensure that the correct location becomes visible on load.\n        // (To reduce the risk, in very large and/or slow loading documents,\n        //  that the location changes *after* the user has started interacting\n        //  with the viewer, wait for either `pagesPromise` or a timeout.)\n        await Promise.race([\n          pagesPromise,\n          new Promise((resolve) => {\n            setTimeout(resolve, FORCE_PAGES_LOADED_TIMEOUT);\n          }),\n        ]);\n        if (!initialBookmark && !hash) {\n          return;\n        }\n        if (pdfViewer.hasEqualPageSizes) {\n          return;\n        }\n        this.initialBookmark = initialBookmark;\n\n        // eslint-disable-next-line no-self-assign\n        pdfViewer.currentScaleValue = pdfViewer.currentScaleValue;\n        // Re-apply the initial document location.\n        this.setInitialView(hash);\n      }).catch(() => {\n        // Ensure that the document is always completely initialized,\n        // even if there are any errors thrown above.\n        this.setInitialView();\n      }).then(function() {\n        // At this point, rendering of the initial page(s) should always have\n        // started (and may even have completed).\n        // To prevent any future issues, e.g. the document being completely\n        // blank on load, always trigger rendering here.\n        pdfViewer.update();\n      });\n    });\n\n    pdfDocument.getPageLabels().then((labels) => {\n      if (!labels || AppOptions.get('disablePageLabels')) {\n        return;\n      }\n      let i = 0, numLabels = labels.length;\n      if (numLabels !== this.pagesCount) {\n        console.error('The number of Page Labels does not match ' +\n                      'the number of pages in the document.');\n        return;\n      }\n      // Ignore page labels that correspond to standard page numbering.\n      while (i < numLabels && labels[i] === (i + 1).toString()) {\n        i++;\n      }\n      if (i === numLabels) {\n        return;\n      }\n\n      pdfViewer.setPageLabels(labels);\n      pdfThumbnailViewer.setPageLabels(labels);\n\n      // Changing toolbar page display to use labels and we need to set\n      // the label of the current page.\n      this.toolbar.setPagesCount(pdfDocument.numPages, true);\n      this.toolbar.setPageNumber(pdfViewer.currentPageNumber,\n                                 pdfViewer.currentPageLabel);\n    });\n\n    pagesPromise.then(() => {\n      if (!this.supportsPrinting) {\n        return;\n      }\n      pdfDocument.getJavaScript().then((javaScript) => {\n        if (!javaScript) {\n          return;\n        }\n        javaScript.some((js) => {\n          if (!js) { // Don't warn/fallback for empty JavaScript actions.\n            return false;\n          }\n          console.warn('Warning: JavaScript is not supported');\n          this.fallback(UNSUPPORTED_FEATURES.javaScript);\n          return true;\n        });\n\n        // Hack to support auto printing.\n        let regex = /\\bprint\\s*\\(/;\n        for (let i = 0, ii = javaScript.length; i < ii; i++) {\n          let js = javaScript[i];\n          if (js && regex.test(js)) {\n            setTimeout(function() {\n              window.print();\n            });\n            return;\n          }\n        }\n      });\n    });\n\n    onePageRendered.then(() => {\n      pdfDocument.getOutline().then((outline) => {\n        this.pdfOutlineViewer.render({ outline, });\n      });\n      pdfDocument.getAttachments().then((attachments) => {\n        this.pdfAttachmentViewer.render({ attachments, });\n      });\n    });\n\n    pdfDocument.getMetadata().then(\n        ({ info, metadata, contentDispositionFilename, }) => {\n      this.documentInfo = info;\n      this.metadata = metadata;\n      this.contentDispositionFilename = contentDispositionFilename;\n\n      // Provides some basic debug information\n      console.log('PDF ' + pdfDocument.fingerprint + ' [' +\n                  info.PDFFormatVersion + ' ' + (info.Producer || '-').trim() +\n                  ' / ' + (info.Creator || '-').trim() + ']' +\n                  ' (PDF.js: ' + (version || '-') +\n                  (AppOptions.get('enableWebGL') ? ' [WebGL]' : '') + ')');\n\n      let pdfTitle;\n      if (metadata && metadata.has('dc:title')) {\n        let title = metadata.get('dc:title');\n        // Ghostscript sometimes return 'Untitled', sets the title to 'Untitled'\n        if (title !== 'Untitled') {\n          pdfTitle = title;\n        }\n      }\n\n      if (!pdfTitle && info && info['Title']) {\n        pdfTitle = info['Title'];\n      }\n\n      if (pdfTitle) {\n        this.setTitle(\n          `${pdfTitle} - ${contentDispositionFilename || document.title}`);\n      } else if (contentDispositionFilename) {\n        this.setTitle(contentDispositionFilename);\n      }\n\n      if (info.IsAcroFormPresent) {\n        console.warn('Warning: AcroForm/XFA is not supported');\n        this.fallback(UNSUPPORTED_FEATURES.forms);\n      }\n\n      if (typeof PDFJSDev !== 'undefined' &&\n          PDFJSDev.test('FIREFOX || MOZCENTRAL')) {\n        // Telemetry labels must be C++ variable friendly.\n        const versionId = `v${info.PDFFormatVersion.replace('.', '_')}`;\n        let generatorId = 'other';\n        // Keep these in sync with mozilla central's Histograms.json.\n        const KNOWN_GENERATORS = [\n          'acrobat distiller', 'acrobat pdfwriter', 'adobe livecycle',\n          'adobe pdf library', 'adobe photoshop', 'ghostscript', 'tcpdf',\n          'cairo', 'dvipdfm', 'dvips', 'pdftex', 'pdfkit', 'itext', 'prince',\n          'quarkxpress', 'mac os x', 'microsoft', 'openoffice', 'oracle',\n          'luradocument', 'pdf-xchange', 'antenna house', 'aspose.cells', 'fpdf'\n        ];\n        if (info.Producer) {\n          KNOWN_GENERATORS.some(function (generator, s, i) {\n            if (!generator.includes(s)) {\n              return false;\n            }\n            generatorId = s.replace(/[ .\\-]/g, '_');\n            return true;\n          }.bind(null, info.Producer.toLowerCase()));\n        }\n        let formType = !info.IsAcroFormPresent ? null : info.IsXFAPresent ?\n                      'xfa' : 'acroform';\n        this.externalServices.reportTelemetry({\n          type: 'documentInfo',\n          version: versionId,\n          generator: generatorId,\n          formType,\n        });\n      }\n    });\n  },\n\n  /**\n   * @private\n   */\n  _initializePdfHistory({ fingerprint, viewOnLoad, initialDest = null, }) {\n    if (AppOptions.get('disableHistory') || this.isViewerEmbedded) {\n      // The browsing history is only enabled when the viewer is standalone,\n      // i.e. not when it is embedded in a web page.\n      return;\n    }\n    this.pdfHistory.initialize({\n      fingerprint,\n      resetHistory: viewOnLoad === ViewOnLoad.INITIAL,\n      updateUrl: AppOptions.get('historyUpdateUrl'),\n    });\n\n    if (this.pdfHistory.initialBookmark) {\n      this.initialBookmark = this.pdfHistory.initialBookmark;\n\n      this.initialRotation = this.pdfHistory.initialRotation;\n    }\n\n    // Always let the browser history/document hash take precedence.\n    if (initialDest && !this.initialBookmark &&\n        viewOnLoad === ViewOnLoad.UNKNOWN) {\n      this.initialBookmark = JSON.stringify(initialDest);\n      // TODO: Re-factor the `PDFHistory` initialization to remove this hack\n      // that's currently necessary to prevent weird initial history state.\n      this.pdfHistory.push({ explicitDest: initialDest, pageNumber: null, });\n    }\n  },\n\n  setInitialView(storedHash, { rotation, sidebarView,\n                               scrollMode, spreadMode, } = {}) {\n    const setRotation = (angle) => {\n      if (isValidRotation(angle)) {\n        this.pdfViewer.pagesRotation = angle;\n      }\n    };\n    const setViewerModes = (scroll, spread) => {\n      if (isValidScrollMode(scroll)) {\n        this.pdfViewer.scrollMode = scroll;\n      }\n      if (isValidSpreadMode(spread)) {\n        this.pdfViewer.spreadMode = spread;\n      }\n    };\n    this.isInitialViewSet = true;\n    this.pdfSidebar.setInitialView(sidebarView);\n\n    setViewerModes(scrollMode, spreadMode);\n\n    if (this.initialBookmark) {\n      setRotation(this.initialRotation);\n      delete this.initialRotation;\n\n      this.pdfLinkService.setHash(this.initialBookmark);\n      this.initialBookmark = null;\n    } else if (storedHash) {\n      setRotation(rotation);\n\n      this.pdfLinkService.setHash(storedHash);\n    }\n\n    // Ensure that the correct page number is displayed in the UI,\n    // even if the active page didn't change during document load.\n    this.toolbar.setPageNumber(this.pdfViewer.currentPageNumber,\n                               this.pdfViewer.currentPageLabel);\n    this.secondaryToolbar.setPageNumber(this.pdfViewer.currentPageNumber);\n\n    if (!this.pdfViewer.currentScaleValue) {\n      // Scale was not initialized: invalid bookmark or scale was not specified.\n      // Setting the default one.\n      this.pdfViewer.currentScaleValue = DEFAULT_SCALE_VALUE;\n    }\n  },\n\n  cleanup() {\n    if (!this.pdfDocument) {\n      return; // run cleanup when document is loaded\n    }\n    this.pdfViewer.cleanup();\n    this.pdfThumbnailViewer.cleanup();\n\n    // We don't want to remove fonts used by active page SVGs.\n    if (this.pdfViewer.renderer !== RendererType.SVG) {\n      this.pdfDocument.cleanup();\n    }\n  },\n\n  forceRendering() {\n    this.pdfRenderingQueue.printing = this.printing;\n    this.pdfRenderingQueue.isThumbnailViewEnabled =\n      this.pdfSidebar.isThumbnailViewVisible;\n    this.pdfRenderingQueue.renderHighestPriority();\n  },\n\n  beforePrint() {\n    if (this.printService) {\n      // There is no way to suppress beforePrint/afterPrint events,\n      // but PDFPrintService may generate double events -- this will ignore\n      // the second event that will be coming from native window.print().\n      return;\n    }\n\n    if (!this.supportsPrinting) {\n      this.l10n.get('printing_not_supported', null,\n                    'Warning: Printing is not fully supported by ' +\n                    'this browser.').then((printMessage) => {\n        this.error(printMessage);\n      });\n      return;\n    }\n\n    // The beforePrint is a sync method and we need to know layout before\n    // returning from this method. Ensure that we can get sizes of the pages.\n    if (!this.pdfViewer.pageViewsReady) {\n      this.l10n.get('printing_not_ready', null,\n                    'Warning: The PDF is not fully loaded for printing.').\n          then((notReadyMessage) => {\n        window.alert(notReadyMessage);\n      });\n      return;\n    }\n\n    let pagesOverview = this.pdfViewer.getPagesOverview();\n    let printContainer = this.appConfig.printContainer;\n    let printService = PDFPrintServiceFactory.instance.createPrintService(\n      this.pdfDocument, pagesOverview, printContainer, this.l10n);\n    this.printService = printService;\n    this.forceRendering();\n\n    printService.layout();\n\n    if (typeof PDFJSDev !== 'undefined' &&\n        PDFJSDev.test('FIREFOX || MOZCENTRAL')) {\n      this.externalServices.reportTelemetry({\n        type: 'print',\n      });\n    }\n  },\n\n  afterPrint() {\n    if (this.printService) {\n      this.printService.destroy();\n      this.printService = null;\n    }\n    this.forceRendering();\n  },\n\n  rotatePages(delta) {\n    if (!this.pdfDocument) {\n      return;\n    }\n    let newRotation = (this.pdfViewer.pagesRotation + 360 + delta) % 360;\n    this.pdfViewer.pagesRotation = newRotation;\n    // Note that the thumbnail viewer is updated, and rendering is triggered,\n    // in the 'rotationchanging' event handler.\n  },\n\n  requestPresentationMode() {\n    if (!this.pdfPresentationMode) {\n      return;\n    }\n    this.pdfPresentationMode.request();\n  },\n\n  bindEvents() {\n    let { eventBus, _boundEvents, } = this;\n\n    _boundEvents.beforePrint = this.beforePrint.bind(this);\n    _boundEvents.afterPrint = this.afterPrint.bind(this);\n\n    eventBus.on('resize', webViewerResize);\n    eventBus.on('hashchange', webViewerHashchange);\n    eventBus.on('beforeprint', _boundEvents.beforePrint);\n    eventBus.on('afterprint', _boundEvents.afterPrint);\n    eventBus.on('pagerendered', webViewerPageRendered);\n    eventBus.on('textlayerrendered', webViewerTextLayerRendered);\n    eventBus.on('updateviewarea', webViewerUpdateViewarea);\n    eventBus.on('pagechanging', webViewerPageChanging);\n    eventBus.on('scalechanging', webViewerScaleChanging);\n    eventBus.on('rotationchanging', webViewerRotationChanging);\n    eventBus.on('sidebarviewchanged', webViewerSidebarViewChanged);\n    eventBus.on('pagemode', webViewerPageMode);\n    eventBus.on('namedaction', webViewerNamedAction);\n    eventBus.on('presentationmodechanged', webViewerPresentationModeChanged);\n    eventBus.on('presentationmode', webViewerPresentationMode);\n    eventBus.on('openfile', webViewerOpenFile);\n    eventBus.on('print', webViewerPrint);\n    eventBus.on('download', webViewerDownload);\n    eventBus.on('firstpage', webViewerFirstPage);\n    eventBus.on('lastpage', webViewerLastPage);\n    eventBus.on('nextpage', webViewerNextPage);\n    eventBus.on('previouspage', webViewerPreviousPage);\n    eventBus.on('zoomin', webViewerZoomIn);\n    eventBus.on('zoomout', webViewerZoomOut);\n    eventBus.on('zoomreset', webViewerZoomReset);\n    eventBus.on('pagenumberchanged', webViewerPageNumberChanged);\n    eventBus.on('scalechanged', webViewerScaleChanged);\n    eventBus.on('rotatecw', webViewerRotateCw);\n    eventBus.on('rotateccw', webViewerRotateCcw);\n    eventBus.on('switchscrollmode', webViewerSwitchScrollMode);\n    eventBus.on('scrollmodechanged', webViewerScrollModeChanged);\n    eventBus.on('switchspreadmode', webViewerSwitchSpreadMode);\n    eventBus.on('spreadmodechanged', webViewerSpreadModeChanged);\n    eventBus.on('documentproperties', webViewerDocumentProperties);\n    eventBus.on('find', webViewerFind);\n    eventBus.on('findfromurlhash', webViewerFindFromUrlHash);\n    eventBus.on('updatefindmatchescount', webViewerUpdateFindMatchesCount);\n    eventBus.on('updatefindcontrolstate', webViewerUpdateFindControlState);\n    if (typeof PDFJSDev === 'undefined' || PDFJSDev.test('GENERIC')) {\n      eventBus.on('fileinputchange', webViewerFileInputChange);\n    }\n  },\n\n  bindWindowEvents() {\n    let { eventBus, _boundEvents, } = this;\n\n    _boundEvents.windowResize = () => {\n      eventBus.dispatch('resize', { source: window, });\n    };\n    _boundEvents.windowHashChange = () => {\n      eventBus.dispatch('hashchange', {\n        source: window,\n        hash: document.location.hash.substring(1),\n      });\n    };\n    _boundEvents.windowBeforePrint = () => {\n      eventBus.dispatch('beforeprint', { source: window, });\n    };\n    _boundEvents.windowAfterPrint = () => {\n      eventBus.dispatch('afterprint', { source: window, });\n    };\n\n    window.addEventListener('visibilitychange', webViewerVisibilityChange);\n    window.addEventListener('wheel', webViewerWheel, { passive: false, });\n    window.addEventListener('click', webViewerClick);\n    window.addEventListener('keydown', webViewerKeyDown);\n    window.addEventListener('resize', _boundEvents.windowResize);\n    window.addEventListener('hashchange', _boundEvents.windowHashChange);\n    window.addEventListener('beforeprint', _boundEvents.windowBeforePrint);\n    window.addEventListener('afterprint', _boundEvents.windowAfterPrint);\n  },\n\n  unbindEvents() {\n    let { eventBus, _boundEvents, } = this;\n\n    eventBus.off('resize', webViewerResize);\n    eventBus.off('hashchange', webViewerHashchange);\n    eventBus.off('beforeprint', _boundEvents.beforePrint);\n    eventBus.off('afterprint', _boundEvents.afterPrint);\n    eventBus.off('pagerendered', webViewerPageRendered);\n    eventBus.off('textlayerrendered', webViewerTextLayerRendered);\n    eventBus.off('updateviewarea', webViewerUpdateViewarea);\n    eventBus.off('pagechanging', webViewerPageChanging);\n    eventBus.off('scalechanging', webViewerScaleChanging);\n    eventBus.off('rotationchanging', webViewerRotationChanging);\n    eventBus.off('sidebarviewchanged', webViewerSidebarViewChanged);\n    eventBus.off('pagemode', webViewerPageMode);\n    eventBus.off('namedaction', webViewerNamedAction);\n    eventBus.off('presentationmodechanged', webViewerPresentationModeChanged);\n    eventBus.off('presentationmode', webViewerPresentationMode);\n    eventBus.off('openfile', webViewerOpenFile);\n    eventBus.off('print', webViewerPrint);\n    eventBus.off('download', webViewerDownload);\n    eventBus.off('firstpage', webViewerFirstPage);\n    eventBus.off('lastpage', webViewerLastPage);\n    eventBus.off('nextpage', webViewerNextPage);\n    eventBus.off('previouspage', webViewerPreviousPage);\n    eventBus.off('zoomin', webViewerZoomIn);\n    eventBus.off('zoomout', webViewerZoomOut);\n    eventBus.off('zoomreset', webViewerZoomReset);\n    eventBus.off('pagenumberchanged', webViewerPageNumberChanged);\n    eventBus.off('scalechanged', webViewerScaleChanged);\n    eventBus.off('rotatecw', webViewerRotateCw);\n    eventBus.off('rotateccw', webViewerRotateCcw);\n    eventBus.off('switchscrollmode', webViewerSwitchScrollMode);\n    eventBus.off('scrollmodechanged', webViewerScrollModeChanged);\n    eventBus.off('switchspreadmode', webViewerSwitchSpreadMode);\n    eventBus.off('spreadmodechanged', webViewerSpreadModeChanged);\n    eventBus.off('documentproperties', webViewerDocumentProperties);\n    eventBus.off('find', webViewerFind);\n    eventBus.off('findfromurlhash', webViewerFindFromUrlHash);\n    eventBus.off('updatefindmatchescount', webViewerUpdateFindMatchesCount);\n    eventBus.off('updatefindcontrolstate', webViewerUpdateFindControlState);\n    if (typeof PDFJSDev === 'undefined' || PDFJSDev.test('GENERIC')) {\n      eventBus.off('fileinputchange', webViewerFileInputChange);\n    }\n\n    _boundEvents.beforePrint = null;\n    _boundEvents.afterPrint = null;\n  },\n\n  unbindWindowEvents() {\n    let { _boundEvents, } = this;\n\n    window.removeEventListener('visibilitychange', webViewerVisibilityChange);\n    window.removeEventListener('wheel', webViewerWheel);\n    window.removeEventListener('click', webViewerClick);\n    window.removeEventListener('keydown', webViewerKeyDown);\n    window.removeEventListener('resize', _boundEvents.windowResize);\n    window.removeEventListener('hashchange', _boundEvents.windowHashChange);\n    window.removeEventListener('beforeprint', _boundEvents.windowBeforePrint);\n    window.removeEventListener('afterprint', _boundEvents.windowAfterPrint);\n\n    _boundEvents.windowResize = null;\n    _boundEvents.windowHashChange = null;\n    _boundEvents.windowBeforePrint = null;\n    _boundEvents.windowAfterPrint = null;\n  },\n};\n\nlet validateFileURL;\nif (typeof PDFJSDev === 'undefined' || PDFJSDev.test('GENERIC')) {\n  const HOSTED_VIEWER_ORIGINS = ['null',\n    'http://mozilla.github.io', 'https://mozilla.github.io', 'file://', 'qrc://'];\n  validateFileURL = function validateFileURL(file) {\n    if (file === undefined) {\n      return;\n    }\n    try {\n      let viewerOrigin = new URL(window.location.href).origin || 'null';\n      if (HOSTED_VIEWER_ORIGINS.includes(viewerOrigin)) {\n        // Hosted or local viewer, allow for any file locations\n        return;\n      }\n      let { origin, protocol, } = new URL(file, window.location.href);\n      // Removing of the following line will not guarantee that the viewer will\n      // start accepting URLs from foreign origin -- CORS headers on the remote\n      // server must be properly configured.\n      // IE10 / IE11 does not include an origin in `blob:`-URLs. So don't block\n      // any blob:-URL. The browser's same-origin policy will block requests to\n      // blob:-URLs from other origins, so this is safe.\n      if (origin !== viewerOrigin && protocol !== 'blob:') {\n        throw new Error('file origin does not match viewer\\'s');\n      }\n    } catch (ex) {\n      let message = ex && ex.message;\n      PDFViewerApplication.l10n.get('loading_error', null,\n          'An error occurred while loading the PDF.').\n          then((loadingErrorMessage) => {\n        PDFViewerApplication.error(loadingErrorMessage, { message, });\n      });\n      throw ex;\n    }\n  };\n}\n\nfunction loadFakeWorker() {\n  if (!GlobalWorkerOptions.workerSrc) {\n    GlobalWorkerOptions.workerSrc = AppOptions.get('workerSrc');\n  }\n  if (typeof PDFJSDev === 'undefined' || !PDFJSDev.test('PRODUCTION')) {\n    return new Promise(function(resolve, reject) {\n      if (typeof SystemJS === 'object') {\n        SystemJS.import('pdfjs/core/worker').then((worker) => {\n          window.pdfjsWorker = worker;\n          resolve();\n        }).catch(reject);\n      } else if (typeof require === 'function') {\n        try {\n          window.pdfjsWorker = require('../src/core/worker.js');\n          resolve();\n        } catch (ex) {\n          reject(ex);\n        }\n      } else {\n        reject(new Error(\n          'SystemJS or CommonJS must be used to load fake worker.'));\n      }\n    });\n  }\n  return loadScript(PDFWorker.getWorkerSrc());\n}\n\nfunction loadAndEnablePDFBug(enabledTabs) {\n  let appConfig = PDFViewerApplication.appConfig;\n  return loadScript(appConfig.debuggerScriptPath).then(function() {\n    PDFBug.enable(enabledTabs);\n    PDFBug.init({\n      OPS,\n      createObjectURL,\n    }, appConfig.mainContainer);\n  });\n}\n\nfunction webViewerInitialized() {\n  let appConfig = PDFViewerApplication.appConfig;\n  let file;\n  if (typeof PDFJSDev === 'undefined' || PDFJSDev.test('GENERIC')) {\n    let queryString = document.location.search.substring(1);\n    let params = parseQueryString(queryString);\n    file = 'file' in params ? params.file : AppOptions.get('defaultUrl');\n    validateFileURL(file);\n  } else if (PDFJSDev.test('FIREFOX || MOZCENTRAL')) {\n    file = window.location.href.split('#')[0];\n  } else if (PDFJSDev.test('CHROME')) {\n    file = AppOptions.get('defaultUrl');\n  }\n\n  if (typeof PDFJSDev === 'undefined' || PDFJSDev.test('GENERIC')) {\n    let fileInput = document.createElement('input');\n    fileInput.id = appConfig.openFileInputName;\n    fileInput.className = 'fileInput';\n    fileInput.setAttribute('type', 'file');\n    fileInput.oncontextmenu = noContextMenuHandler;\n    document.body.appendChild(fileInput);\n\n    if (!window.File || !window.FileReader ||\n        !window.FileList || !window.Blob) {\n      appConfig.toolbar.openFile.setAttribute('hidden', 'true');\n      appConfig.secondaryToolbar.openFileButton.setAttribute('hidden', 'true');\n    } else {\n      fileInput.value = null;\n    }\n\n    fileInput.addEventListener('change', function(evt) {\n      let files = evt.target.files;\n      if (!files || files.length === 0) {\n        return;\n      }\n      PDFViewerApplication.eventBus.dispatch('fileinputchange', {\n        source: this,\n        fileInput: evt.target,\n      });\n    });\n\n    // Enable draging-and-dropping a new PDF file onto the viewerContainer.\n    appConfig.mainContainer.addEventListener('dragover', function(evt) {\n      evt.preventDefault();\n\n      evt.dataTransfer.dropEffect = 'move';\n    });\n    appConfig.mainContainer.addEventListener('drop', function(evt) {\n      evt.preventDefault();\n\n      const files = evt.dataTransfer.files;\n      if (!files || files.length === 0) {\n        return;\n      }\n      PDFViewerApplication.eventBus.dispatch('fileinputchange', {\n        source: this,\n        fileInput: evt.dataTransfer,\n      });\n    });\n  } else {\n    appConfig.toolbar.openFile.setAttribute('hidden', 'true');\n    appConfig.secondaryToolbar.openFileButton.setAttribute('hidden', 'true');\n  }\n\n  if (typeof PDFJSDev !== 'undefined' &&\n      PDFJSDev.test('FIREFOX || MOZCENTRAL') &&\n      !PDFViewerApplication.supportsDocumentFonts) {\n    AppOptions.set('disableFontFace', true);\n    PDFViewerApplication.l10n.get('web_fonts_disabled', null,\n      'Web fonts are disabled: unable to use embedded PDF fonts.').\n        then((msg) => {\n      console.warn(msg);\n    });\n  }\n\n  if (!PDFViewerApplication.supportsPrinting) {\n    appConfig.toolbar.print.classList.add('hidden');\n    appConfig.secondaryToolbar.printButton.classList.add('hidden');\n  }\n\n  if (!PDFViewerApplication.supportsFullscreen) {\n    appConfig.toolbar.presentationModeButton.classList.add('hidden');\n    appConfig.secondaryToolbar.presentationModeButton.classList.add('hidden');\n  }\n\n  if (PDFViewerApplication.supportsIntegratedFind) {\n    appConfig.toolbar.viewFind.classList.add('hidden');\n  }\n\n  appConfig.mainContainer.addEventListener('transitionend', function(evt) {\n    if (evt.target === /* mainContainer */ this) {\n      PDFViewerApplication.eventBus.dispatch('resize', { source: this, });\n    }\n  }, true);\n\n  try {\n    webViewerOpenFileViaURL(file);\n  } catch (reason) {\n    PDFViewerApplication.l10n.get('loading_error', null,\n        'An error occurred while loading the PDF.').then((msg) => {\n      PDFViewerApplication.error(msg, reason);\n    });\n  }\n}\n\nlet webViewerOpenFileViaURL;\nif (typeof PDFJSDev === 'undefined' || PDFJSDev.test('GENERIC')) {\n  webViewerOpenFileViaURL = function webViewerOpenFileViaURL(file) {\n    if (file && file.lastIndexOf('file:', 0) === 0) {\n      // file:-scheme. Load the contents in the main thread because QtWebKit\n      // cannot load file:-URLs in a Web Worker. file:-URLs are usually loaded\n      // very quickly, so there is no need to set up progress event listeners.\n      PDFViewerApplication.setTitleUsingUrl(file);\n      const xhr = new XMLHttpRequest();\n      xhr.onload = function() {\n        PDFViewerApplication.open(new Uint8Array(xhr.response));\n      };\n      xhr.open('GET', file);\n      xhr.responseType = 'arraybuffer';\n      xhr.send();\n      return;\n    }\n\n    if (file) {\n      PDFViewerApplication.open(file);\n    }\n  };\n} else if (PDFJSDev.test('FIREFOX || MOZCENTRAL || CHROME')) {\n  webViewerOpenFileViaURL = function webViewerOpenFileViaURL(file) {\n    PDFViewerApplication.setTitleUsingUrl(file);\n    PDFViewerApplication.initPassiveLoading();\n  };\n} else {\n  webViewerOpenFileViaURL = function webViewerOpenFileViaURL(file) {\n    if (file) {\n      throw new Error('Not implemented: webViewerOpenFileViaURL');\n    }\n  };\n}\n\nfunction webViewerPageRendered(evt) {\n  let pageNumber = evt.pageNumber;\n  let pageIndex = pageNumber - 1;\n  let pageView = PDFViewerApplication.pdfViewer.getPageView(pageIndex);\n\n  // If the page is still visible when it has finished rendering,\n  // ensure that the page number input loading indicator is hidden.\n  if (pageNumber === PDFViewerApplication.page) {\n    PDFViewerApplication.toolbar.updateLoadingIndicatorState(false);\n  }\n\n  // Prevent errors in the edge-case where the PDF document is removed *before*\n  // the 'pagerendered' event handler is invoked.\n  if (!pageView) {\n    return;\n  }\n\n  // Use the rendered page to set the corresponding thumbnail image.\n  if (PDFViewerApplication.pdfSidebar.isThumbnailViewVisible) {\n    let thumbnailView = PDFViewerApplication.pdfThumbnailViewer.\n                        getThumbnail(pageIndex);\n    thumbnailView.setImage(pageView);\n  }\n\n  if (typeof Stats !== 'undefined' && Stats.enabled && pageView.stats) {\n    Stats.add(pageNumber, pageView.stats);\n  }\n\n  if (pageView.error) {\n    PDFViewerApplication.l10n.get('rendering_error', null,\n        'An error occurred while rendering the page.').then((msg) => {\n      PDFViewerApplication.error(msg, pageView.error);\n    });\n  }\n\n  if (typeof PDFJSDev !== 'undefined' &&\n      PDFJSDev.test('FIREFOX || MOZCENTRAL')) {\n    PDFViewerApplication.externalServices.reportTelemetry({\n      type: 'pageInfo',\n      timestamp: evt.timestamp,\n    });\n    // It is a good time to report stream and font types.\n    PDFViewerApplication.pdfDocument.getStats().then(function (stats) {\n      PDFViewerApplication.externalServices.reportTelemetry({\n        type: 'documentStats',\n        stats,\n      });\n    });\n  }\n}\n\nfunction webViewerTextLayerRendered(evt) {\n  if (typeof PDFJSDev !== 'undefined' &&\n      PDFJSDev.test('FIREFOX || MOZCENTRAL') &&\n      evt.numTextDivs > 0 && !PDFViewerApplication.supportsDocumentColors) {\n    PDFViewerApplication.l10n.get('document_colors_not_allowed', null,\n      'PDF documents are not allowed to use their own colors: ' +\n      '\\'Allow pages to choose their own colors\\' ' +\n      'is deactivated in the browser.').\n        then((msg) => {\n      console.error(msg);\n    });\n    PDFViewerApplication.fallback();\n  }\n}\n\nfunction webViewerPageMode(evt) {\n  // Handle the 'pagemode' hash parameter, see also `PDFLinkService_setHash`.\n  let mode = evt.mode, view;\n  switch (mode) {\n    case 'thumbs':\n      view = SidebarView.THUMBS;\n      break;\n    case 'bookmarks':\n    case 'outline':\n      view = SidebarView.OUTLINE;\n      break;\n    case 'attachments':\n      view = SidebarView.ATTACHMENTS;\n      break;\n    case 'none':\n      view = SidebarView.NONE;\n      break;\n    default:\n      console.error('Invalid \"pagemode\" hash parameter: ' + mode);\n      return;\n  }\n  PDFViewerApplication.pdfSidebar.switchView(view, /* forceOpen = */ true);\n}\n\nfunction webViewerNamedAction(evt) {\n  // Processing couple of named actions that might be useful.\n  // See also PDFLinkService.executeNamedAction\n  let action = evt.action;\n  switch (action) {\n    case 'GoToPage':\n      PDFViewerApplication.appConfig.toolbar.pageNumber.select();\n      break;\n\n    case 'Find':\n      if (!PDFViewerApplication.supportsIntegratedFind) {\n        PDFViewerApplication.findBar.toggle();\n      }\n      break;\n  }\n}\n\nfunction webViewerPresentationModeChanged(evt) {\n  let { active, switchInProgress, } = evt;\n  PDFViewerApplication.pdfViewer.presentationModeState =\n    switchInProgress ? PresentationModeState.CHANGING :\n    active ? PresentationModeState.FULLSCREEN : PresentationModeState.NORMAL;\n}\n\nfunction webViewerSidebarViewChanged(evt) {\n  PDFViewerApplication.pdfRenderingQueue.isThumbnailViewEnabled =\n    PDFViewerApplication.pdfSidebar.isThumbnailViewVisible;\n\n  let store = PDFViewerApplication.store;\n  if (store && PDFViewerApplication.isInitialViewSet) {\n    // Only update the storage when the document has been loaded *and* rendered.\n    store.set('sidebarView', evt.view).catch(function() { });\n  }\n}\n\nfunction webViewerUpdateViewarea(evt) {\n  let location = evt.location, store = PDFViewerApplication.store;\n\n  if (store && PDFViewerApplication.isInitialViewSet) {\n    store.setMultiple({\n      'page': location.pageNumber,\n      'zoom': location.scale,\n      'scrollLeft': location.left,\n      'scrollTop': location.top,\n      'rotation': location.rotation,\n    }).catch(function() { /* unable to write to storage */ });\n  }\n  let href =\n    PDFViewerApplication.pdfLinkService.getAnchorUrl(location.pdfOpenParams);\n  PDFViewerApplication.appConfig.toolbar.viewBookmark.href = href;\n  PDFViewerApplication.appConfig.secondaryToolbar.viewBookmarkButton.href =\n    href;\n\n  // Show/hide the loading indicator in the page number input element.\n  let currentPage =\n    PDFViewerApplication.pdfViewer.getPageView(PDFViewerApplication.page - 1);\n  let loading = currentPage.renderingState !== RenderingStates.FINISHED;\n  PDFViewerApplication.toolbar.updateLoadingIndicatorState(loading);\n}\n\nfunction webViewerScrollModeChanged(evt) {\n  let store = PDFViewerApplication.store;\n  if (store && PDFViewerApplication.isInitialViewSet) {\n    // Only update the storage when the document has been loaded *and* rendered.\n    store.set('scrollMode', evt.mode).catch(function() { });\n  }\n}\n\nfunction webViewerSpreadModeChanged(evt) {\n  let store = PDFViewerApplication.store;\n  if (store && PDFViewerApplication.isInitialViewSet) {\n    // Only update the storage when the document has been loaded *and* rendered.\n    store.set('spreadMode', evt.mode).catch(function() { });\n  }\n}\n\nfunction webViewerResize() {\n  let { pdfDocument, pdfViewer, } = PDFViewerApplication;\n  if (!pdfDocument) {\n    return;\n  }\n  let currentScaleValue = pdfViewer.currentScaleValue;\n  if (currentScaleValue === 'auto' ||\n      currentScaleValue === 'page-fit' ||\n      currentScaleValue === 'page-width') {\n    // Note: the scale is constant for 'page-actual'.\n    pdfViewer.currentScaleValue = currentScaleValue;\n  }\n  pdfViewer.update();\n}\n\nfunction webViewerHashchange(evt) {\n  let hash = evt.hash;\n  if (!hash) {\n    return;\n  }\n  if (!PDFViewerApplication.isInitialViewSet) {\n    PDFViewerApplication.initialBookmark = hash;\n  } else if (!PDFViewerApplication.pdfHistory.popStateInProgress) {\n    PDFViewerApplication.pdfLinkService.setHash(hash);\n  }\n}\n\nlet webViewerFileInputChange;\nif (typeof PDFJSDev === 'undefined' || PDFJSDev.test('GENERIC')) {\n  webViewerFileInputChange = function webViewerFileInputChange(evt) {\n    if (PDFViewerApplication.pdfViewer &&\n        PDFViewerApplication.pdfViewer.isInPresentationMode) {\n      return; // Opening a new PDF file isn't supported in Presentation Mode.\n    }\n    let file = evt.fileInput.files[0];\n\n    if (URL.createObjectURL && !AppOptions.get('disableCreateObjectURL')) {\n      let url = URL.createObjectURL(file);\n      if (file.name) {\n        url = { url, originalUrl: file.name, };\n      }\n      PDFViewerApplication.open(url);\n    } else {\n      PDFViewerApplication.setTitleUsingUrl(file.name);\n      // Read the local file into a Uint8Array.\n      let fileReader = new FileReader();\n      fileReader.onload = function webViewerChangeFileReaderOnload(evt) {\n        let buffer = evt.target.result;\n        PDFViewerApplication.open(new Uint8Array(buffer));\n      };\n      fileReader.readAsArrayBuffer(file);\n    }\n\n    // URL does not reflect proper document location - hiding some icons.\n    let appConfig = PDFViewerApplication.appConfig;\n    appConfig.toolbar.viewBookmark.setAttribute('hidden', 'true');\n    appConfig.secondaryToolbar.viewBookmarkButton.setAttribute('hidden',\n                                                               'true');\n    appConfig.toolbar.download.setAttribute('hidden', 'true');\n    appConfig.secondaryToolbar.downloadButton.setAttribute('hidden', 'true');\n  };\n}\n\nfunction webViewerPresentationMode() {\n  PDFViewerApplication.requestPresentationMode();\n}\nfunction webViewerOpenFile() {\n  if (typeof PDFJSDev === 'undefined' || PDFJSDev.test('GENERIC')) {\n    let openFileInputName = PDFViewerApplication.appConfig.openFileInputName;\n    document.getElementById(openFileInputName).click();\n  }\n}\nfunction webViewerPrint() {\n  window.print();\n}\nfunction webViewerDownload() {\n  PDFViewerApplication.download();\n}\nfunction webViewerFirstPage() {\n  if (PDFViewerApplication.pdfDocument) {\n    PDFViewerApplication.page = 1;\n  }\n}\nfunction webViewerLastPage() {\n  if (PDFViewerApplication.pdfDocument) {\n    PDFViewerApplication.page = PDFViewerApplication.pagesCount;\n  }\n}\nfunction webViewerNextPage() {\n  PDFViewerApplication.page++;\n}\nfunction webViewerPreviousPage() {\n  PDFViewerApplication.page--;\n}\nfunction webViewerZoomIn() {\n  PDFViewerApplication.zoomIn();\n}\nfunction webViewerZoomOut() {\n  PDFViewerApplication.zoomOut();\n}\nfunction webViewerZoomReset() {\n  PDFViewerApplication.zoomReset();\n}\nfunction webViewerPageNumberChanged(evt) {\n  let pdfViewer = PDFViewerApplication.pdfViewer;\n  // Note that for `<input type=\"number\">` HTML elements, an empty string will\n  // be returned for non-number inputs; hence we simply do nothing in that case.\n  if (evt.value !== '') {\n    pdfViewer.currentPageLabel = evt.value;\n  }\n\n  // Ensure that the page number input displays the correct value, even if the\n  // value entered by the user was invalid (e.g. a floating point number).\n  if (evt.value !== pdfViewer.currentPageNumber.toString() &&\n      evt.value !== pdfViewer.currentPageLabel) {\n    PDFViewerApplication.toolbar.setPageNumber(\n      pdfViewer.currentPageNumber, pdfViewer.currentPageLabel);\n  }\n}\nfunction webViewerScaleChanged(evt) {\n  PDFViewerApplication.pdfViewer.currentScaleValue = evt.value;\n}\nfunction webViewerRotateCw() {\n  PDFViewerApplication.rotatePages(90);\n}\nfunction webViewerRotateCcw() {\n  PDFViewerApplication.rotatePages(-90);\n}\nfunction webViewerSwitchScrollMode(evt) {\n  PDFViewerApplication.pdfViewer.scrollMode = evt.mode;\n}\nfunction webViewerSwitchSpreadMode(evt) {\n  PDFViewerApplication.pdfViewer.spreadMode = evt.mode;\n}\nfunction webViewerDocumentProperties() {\n  PDFViewerApplication.pdfDocumentProperties.open();\n}\n\nfunction webViewerFind(evt) {\n  PDFViewerApplication.findController.executeCommand('find' + evt.type, {\n    query: evt.query,\n    phraseSearch: evt.phraseSearch,\n    caseSensitive: evt.caseSensitive,\n    entireWord: evt.entireWord,\n    highlightAll: evt.highlightAll,\n    findPrevious: evt.findPrevious,\n  });\n}\n\nfunction webViewerFindFromUrlHash(evt) {\n  PDFViewerApplication.findController.executeCommand('find', {\n    query: evt.query,\n    phraseSearch: evt.phraseSearch,\n    caseSensitive: false,\n    entireWord: false,\n    highlightAll: true,\n    findPrevious: false,\n  });\n}\n\nfunction webViewerUpdateFindMatchesCount({ matchesCount, }) {\n  if (PDFViewerApplication.supportsIntegratedFind) {\n    PDFViewerApplication.externalServices.updateFindMatchesCount(matchesCount);\n  } else {\n    PDFViewerApplication.findBar.updateResultsCount(matchesCount);\n  }\n}\n\nfunction webViewerUpdateFindControlState({ state, previous, matchesCount, }) {\n  if (PDFViewerApplication.supportsIntegratedFind) {\n    PDFViewerApplication.externalServices.updateFindControlState({\n      result: state,\n      findPrevious: previous,\n      matchesCount,\n    });\n  } else {\n    PDFViewerApplication.findBar.updateUIState(state, previous, matchesCount);\n  }\n}\n\nfunction webViewerScaleChanging(evt) {\n  PDFViewerApplication.toolbar.setPageScale(evt.presetValue, evt.scale);\n\n  PDFViewerApplication.pdfViewer.update();\n}\n\nfunction webViewerRotationChanging(evt) {\n  PDFViewerApplication.pdfThumbnailViewer.pagesRotation = evt.pagesRotation;\n\n  PDFViewerApplication.forceRendering();\n  // Ensure that the active page doesn't change during rotation.\n  PDFViewerApplication.pdfViewer.currentPageNumber = evt.pageNumber;\n}\n\nfunction webViewerPageChanging(evt) {\n  let page = evt.pageNumber;\n\n  PDFViewerApplication.toolbar.setPageNumber(page, evt.pageLabel || null);\n  PDFViewerApplication.secondaryToolbar.setPageNumber(page);\n\n  if (PDFViewerApplication.pdfSidebar.isThumbnailViewVisible) {\n    PDFViewerApplication.pdfThumbnailViewer.scrollThumbnailIntoView(page);\n  }\n\n  // We need to update stats.\n  if (typeof Stats !== 'undefined' && Stats.enabled) {\n    let pageView = PDFViewerApplication.pdfViewer.getPageView(page - 1);\n    if (pageView && pageView.stats) {\n      Stats.add(page, pageView.stats);\n    }\n  }\n}\n\nfunction webViewerVisibilityChange(evt) {\n  if (document.visibilityState === 'visible') {\n    // Ignore mouse wheel zooming during tab switches (bug 1503412).\n    setZoomDisabledTimeout();\n  }\n}\n\nlet zoomDisabledTimeout = null;\nfunction setZoomDisabledTimeout() {\n  if (zoomDisabledTimeout) {\n    clearTimeout(zoomDisabledTimeout);\n  }\n  zoomDisabledTimeout = setTimeout(function() {\n    zoomDisabledTimeout = null;\n  }, WHEEL_ZOOM_DISABLED_TIMEOUT);\n}\n\nfunction webViewerWheel(evt) {\n  const { pdfViewer, supportedMouseWheelZoomModifierKeys, } =\n    PDFViewerApplication;\n\n  if (pdfViewer.isInPresentationMode) {\n    return;\n  }\n\n  if ((evt.ctrlKey && supportedMouseWheelZoomModifierKeys.ctrlKey) ||\n      (evt.metaKey && supportedMouseWheelZoomModifierKeys.metaKey)) {\n    // Only zoom the pages, not the entire viewer.\n    evt.preventDefault();\n    // NOTE: this check must be placed *after* preventDefault.\n    if (zoomDisabledTimeout || document.visibilityState === 'hidden') {\n      return;\n    }\n\n    let previousScale = pdfViewer.currentScale;\n\n    let delta = normalizeWheelEventDelta(evt);\n\n    const MOUSE_WHEEL_DELTA_PER_PAGE_SCALE = 3.0;\n    let ticks = delta * MOUSE_WHEEL_DELTA_PER_PAGE_SCALE;\n    if (ticks < 0) {\n      PDFViewerApplication.zoomOut(-ticks);\n    } else {\n      PDFViewerApplication.zoomIn(ticks);\n    }\n\n    let currentScale = pdfViewer.currentScale;\n    if (previousScale !== currentScale) {\n      // After scaling the page via zoomIn/zoomOut, the position of the upper-\n      // left corner is restored. When the mouse wheel is used, the position\n      // under the cursor should be restored instead.\n      let scaleCorrectionFactor = currentScale / previousScale - 1;\n      let rect = pdfViewer.container.getBoundingClientRect();\n      let dx = evt.clientX - rect.left;\n      let dy = evt.clientY - rect.top;\n      pdfViewer.container.scrollLeft += dx * scaleCorrectionFactor;\n      pdfViewer.container.scrollTop += dy * scaleCorrectionFactor;\n    }\n  } else {\n    setZoomDisabledTimeout();\n  }\n}\n\nfunction webViewerClick(evt) {\n  if (!PDFViewerApplication.secondaryToolbar.isOpen) {\n    return;\n  }\n  let appConfig = PDFViewerApplication.appConfig;\n  if (PDFViewerApplication.pdfViewer.containsElement(evt.target) ||\n      (appConfig.toolbar.container.contains(evt.target) &&\n       evt.target !== appConfig.secondaryToolbar.toggleButton)) {\n    PDFViewerApplication.secondaryToolbar.close();\n  }\n}\n\nfunction webViewerKeyDown(evt) {\n  if (PDFViewerApplication.overlayManager.active) {\n    return;\n  }\n\n  let handled = false, ensureViewerFocused = false;\n  let cmd = (evt.ctrlKey ? 1 : 0) |\n            (evt.altKey ? 2 : 0) |\n            (evt.shiftKey ? 4 : 0) |\n            (evt.metaKey ? 8 : 0);\n\n  let pdfViewer = PDFViewerApplication.pdfViewer;\n  let isViewerInPresentationMode = pdfViewer && pdfViewer.isInPresentationMode;\n\n  // First, handle the key bindings that are independent whether an input\n  // control is selected or not.\n  if (cmd === 1 || cmd === 8 || cmd === 5 || cmd === 12) {\n    // either CTRL or META key with optional SHIFT.\n    switch (evt.keyCode) {\n      case 70: // f\n        if (!PDFViewerApplication.supportsIntegratedFind) {\n          PDFViewerApplication.findBar.open();\n          handled = true;\n        }\n        break;\n      case 71: // g\n        if (!PDFViewerApplication.supportsIntegratedFind) {\n          let findState = PDFViewerApplication.findController.state;\n          if (findState) {\n            PDFViewerApplication.findController.executeCommand('findagain', {\n              query: findState.query,\n              phraseSearch: findState.phraseSearch,\n              caseSensitive: findState.caseSensitive,\n              entireWord: findState.entireWord,\n              highlightAll: findState.highlightAll,\n              findPrevious: cmd === 5 || cmd === 12,\n            });\n          }\n          handled = true;\n        }\n        break;\n      case 61: // FF/Mac '='\n      case 107: // FF '+' and '='\n      case 187: // Chrome '+'\n      case 171: // FF with German keyboard\n        if (!isViewerInPresentationMode) {\n          PDFViewerApplication.zoomIn();\n        }\n        handled = true;\n        break;\n      case 173: // FF/Mac '-'\n      case 109: // FF '-'\n      case 189: // Chrome '-'\n        if (!isViewerInPresentationMode) {\n          PDFViewerApplication.zoomOut();\n        }\n        handled = true;\n        break;\n      case 48: // '0'\n      case 96: // '0' on Numpad of Swedish keyboard\n        if (!isViewerInPresentationMode) {\n          // keeping it unhandled (to restore page zoom to 100%)\n          setTimeout(function() {\n            // ... and resetting the scale after browser adjusts its scale\n            PDFViewerApplication.zoomReset();\n          });\n          handled = false;\n        }\n        break;\n\n      case 38: // up arrow\n        if (isViewerInPresentationMode || PDFViewerApplication.page > 1) {\n          PDFViewerApplication.page = 1;\n          handled = true;\n          ensureViewerFocused = true;\n        }\n        break;\n      case 40: // down arrow\n        if (isViewerInPresentationMode ||\n            PDFViewerApplication.page < PDFViewerApplication.pagesCount) {\n          PDFViewerApplication.page = PDFViewerApplication.pagesCount;\n          handled = true;\n          ensureViewerFocused = true;\n        }\n        break;\n    }\n  }\n\n  if (typeof PDFJSDev === 'undefined' ||\n      !PDFJSDev.test('FIREFOX || MOZCENTRAL')) {\n    // CTRL or META without shift\n    if (cmd === 1 || cmd === 8) {\n      switch (evt.keyCode) {\n        case 83: // s\n          handled = true;\n          break;\n      }\n    }\n  }\n\n  // CTRL+ALT or Option+Command\n  if (cmd === 3 || cmd === 10) {\n    switch (evt.keyCode) {\n      case 80: // p\n        PDFViewerApplication.requestPresentationMode();\n        handled = true;\n        break;\n      case 71: // g\n        // focuses input#pageNumber field\n        PDFViewerApplication.appConfig.toolbar.pageNumber.select();\n        handled = true;\n        break;\n    }\n  }\n\n  if (handled) {\n    if (ensureViewerFocused && !isViewerInPresentationMode) {\n      pdfViewer.focus();\n    }\n    evt.preventDefault();\n    return;\n  }\n\n  // Some shortcuts should not get handled if a control/input element\n  // is selected.\n  let curElement = document.activeElement || document.querySelector(':focus');\n  let curElementTagName = curElement && curElement.tagName.toUpperCase();\n  if (curElementTagName === 'INPUT' ||\n      curElementTagName === 'TEXTAREA' ||\n      curElementTagName === 'SELECT') {\n    // Make sure that the secondary toolbar is closed when Escape is pressed.\n    if (evt.keyCode !== 27) { // 'Esc'\n      return;\n    }\n  }\n\n  if (cmd === 0) { // no control key pressed at all.\n    let turnPage = 0, turnOnlyIfPageFit = false;\n    switch (evt.keyCode) {\n      case 38: // up arrow\n      case 33: // pg up\n        // vertical scrolling using arrow/pg keys\n        if (pdfViewer.isVerticalScrollbarEnabled) {\n          turnOnlyIfPageFit = true;\n        }\n        turnPage = -1;\n        break;\n      case 8: // backspace\n        if (!isViewerInPresentationMode) {\n          turnOnlyIfPageFit = true;\n        }\n        turnPage = -1;\n        break;\n      case 37: // left arrow\n        // horizontal scrolling using arrow keys\n        if (pdfViewer.isHorizontalScrollbarEnabled) {\n          turnOnlyIfPageFit = true;\n        }\n        /* falls through */\n      case 75: // 'k'\n      case 80: // 'p'\n        turnPage = -1;\n        break;\n      case 27: // esc key\n        if (PDFViewerApplication.secondaryToolbar.isOpen) {\n          PDFViewerApplication.secondaryToolbar.close();\n          handled = true;\n        }\n        if (!PDFViewerApplication.supportsIntegratedFind &&\n            PDFViewerApplication.findBar.opened) {\n          PDFViewerApplication.findBar.close();\n          handled = true;\n        }\n        break;\n      case 40: // down arrow\n      case 34: // pg down\n        // vertical scrolling using arrow/pg keys\n        if (pdfViewer.isVerticalScrollbarEnabled) {\n          turnOnlyIfPageFit = true;\n        }\n        turnPage = 1;\n        break;\n      case 13: // enter key\n      case 32: // spacebar\n        if (!isViewerInPresentationMode) {\n          turnOnlyIfPageFit = true;\n        }\n        turnPage = 1;\n        break;\n      case 39: // right arrow\n        // horizontal scrolling using arrow keys\n        if (pdfViewer.isHorizontalScrollbarEnabled) {\n          turnOnlyIfPageFit = true;\n        }\n        /* falls through */\n      case 74: // 'j'\n      case 78: // 'n'\n        turnPage = 1;\n        break;\n\n      case 36: // home\n        if (isViewerInPresentationMode || PDFViewerApplication.page > 1) {\n          PDFViewerApplication.page = 1;\n          handled = true;\n          ensureViewerFocused = true;\n        }\n        break;\n      case 35: // end\n        if (isViewerInPresentationMode ||\n            PDFViewerApplication.page < PDFViewerApplication.pagesCount) {\n          PDFViewerApplication.page = PDFViewerApplication.pagesCount;\n          handled = true;\n          ensureViewerFocused = true;\n        }\n        break;\n\n      case 83: // 's'\n        PDFViewerApplication.pdfCursorTools.switchTool(CursorTool.SELECT);\n        break;\n      case 72: // 'h'\n        PDFViewerApplication.pdfCursorTools.switchTool(CursorTool.HAND);\n        break;\n\n      case 82: // 'r'\n        PDFViewerApplication.rotatePages(90);\n        break;\n\n      case 115: // F4\n        PDFViewerApplication.pdfSidebar.toggle();\n        break;\n    }\n\n    if (turnPage !== 0 &&\n        (!turnOnlyIfPageFit || pdfViewer.currentScaleValue === 'page-fit')) {\n      if (turnPage > 0) {\n        if (PDFViewerApplication.page < PDFViewerApplication.pagesCount) {\n          PDFViewerApplication.page++;\n        }\n      } else {\n        if (PDFViewerApplication.page > 1) {\n          PDFViewerApplication.page--;\n        }\n      }\n      handled = true;\n    }\n  }\n\n  if (cmd === 4) { // shift-key\n    switch (evt.keyCode) {\n      case 13: // enter key\n      case 32: // spacebar\n        if (!isViewerInPresentationMode &&\n            pdfViewer.currentScaleValue !== 'page-fit') {\n          break;\n        }\n        if (PDFViewerApplication.page > 1) {\n          PDFViewerApplication.page--;\n        }\n        handled = true;\n        break;\n\n      case 82: // 'r'\n        PDFViewerApplication.rotatePages(-90);\n        break;\n    }\n  }\n\n  if (!handled && !isViewerInPresentationMode) {\n    // 33=Page Up  34=Page Down  35=End    36=Home\n    // 37=Left     38=Up         39=Right  40=Down\n    // 32=Spacebar\n    if ((evt.keyCode >= 33 && evt.keyCode <= 40) ||\n        (evt.keyCode === 32 && curElementTagName !== 'BUTTON')) {\n      ensureViewerFocused = true;\n    }\n  }\n\n  if (ensureViewerFocused && !pdfViewer.containsElement(curElement)) {\n    // The page container is not focused, but a page navigation key has been\n    // pressed. Change the focus to the viewer container to make sure that\n    // navigation by keyboard works as expected.\n    pdfViewer.focus();\n  }\n\n  if (handled) {\n    evt.preventDefault();\n  }\n}\n\n/**\n * Converts API PageLayout values to the format used by `PDFViewer`.\n * NOTE: This is supported to the extent that the viewer implements the\n *       necessary Scroll/Spread modes (since SinglePage, TwoPageLeft,\n *       and TwoPageRight all suggests using non-continuous scrolling).\n * @param {string} mode - The API PageLayout value.\n * @returns {number} A value from {SpreadMode}.\n */\nfunction apiPageLayoutToSpreadMode(layout) {\n  switch (layout) {\n    case 'SinglePage':\n    case 'OneColumn':\n      return SpreadMode.NONE;\n    case 'TwoColumnLeft':\n    case 'TwoPageLeft':\n      return SpreadMode.ODD;\n    case 'TwoColumnRight':\n    case 'TwoPageRight':\n      return SpreadMode.EVEN;\n  }\n  return SpreadMode.NONE; // Default value.\n}\n\n/**\n * Converts API PageMode values to the format used by `PDFSidebar`.\n * NOTE: There's also a \"FullScreen\" parameter which is not possible to support,\n *       since the Fullscreen API used in browsers requires that entering\n *       fullscreen mode only occurs as a result of a user-initiated event.\n * @param {string} mode - The API PageMode value.\n * @returns {number} A value from {SidebarView}.\n */\nfunction apiPageModeToSidebarView(mode) {\n  switch (mode) {\n    case 'UseNone':\n      return SidebarView.NONE;\n    case 'UseThumbs':\n      return SidebarView.THUMBS;\n    case 'UseOutlines':\n      return SidebarView.OUTLINE;\n    case 'UseAttachments':\n      return SidebarView.ATTACHMENTS;\n    case 'UseOC':\n      // Not implemented, since we don't support Optional Content Groups yet.\n  }\n  return SidebarView.NONE; // Default value.\n}\n\n/* Abstract factory for the print service. */\nlet PDFPrintServiceFactory = {\n  instance: {\n    supportsPrinting: false,\n    createPrintService() {\n      throw new Error('Not implemented: createPrintService');\n    },\n  },\n};\n\nexport {\n  PDFViewerApplication,\n  DefaultExternalServices,\n  PDFPrintServiceFactory,\n};\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst CSS_UNITS = 96.0 / 72.0;\nconst DEFAULT_SCALE_VALUE = 'auto';\nconst DEFAULT_SCALE = 1.0;\nconst MIN_SCALE = 0.10;\nconst MAX_SCALE = 10.0;\nconst UNKNOWN_SCALE = 0;\nconst MAX_AUTO_SCALE = 1.25;\nconst SCROLLBAR_PADDING = 40;\nconst VERTICAL_PADDING = 5;\n\nconst PresentationModeState = {\n  UNKNOWN: 0,\n  NORMAL: 1,\n  CHANGING: 2,\n  FULLSCREEN: 3,\n};\n\nconst RendererType = {\n  CANVAS: 'canvas',\n  SVG: 'svg',\n};\n\nconst TextLayerMode = {\n  DISABLE: 0,\n  ENABLE: 1,\n  ENABLE_ENHANCE: 2,\n};\n\nconst ScrollMode = {\n  UNKNOWN: -1,\n  VERTICAL: 0, // Default value.\n  HORIZONTAL: 1,\n  WRAPPED: 2,\n};\n\nconst SpreadMode = {\n  UNKNOWN: -1,\n  NONE: 0, // Default value.\n  ODD: 1,\n  EVEN: 2,\n};\n\n// Replaces {{arguments}} with their values.\nfunction formatL10nValue(text, args) {\n  if (!args) {\n    return text;\n  }\n  return text.replace(/\\{\\{\\s*(\\w+)\\s*\\}\\}/g, (all, name) => {\n    return (name in args ? args[name] : '{{' + name + '}}');\n  });\n}\n\n/**\n * No-op implementation of the localization service.\n * @implements {IL10n}\n */\nlet NullL10n = {\n  async getLanguage() {\n    return 'en-us';\n  },\n\n  async getDirection() {\n    return 'ltr';\n  },\n\n  async get(property, args, fallback) {\n    return formatL10nValue(fallback, args);\n  },\n\n  async translate(element) { },\n};\n\n/**\n * Returns scale factor for the canvas. It makes sense for the HiDPI displays.\n * @return {Object} The object with horizontal (sx) and vertical (sy)\n                    scales. The scaled property is set to false if scaling is\n                    not required, true otherwise.\n */\nfunction getOutputScale(ctx) {\n  let devicePixelRatio = window.devicePixelRatio || 1;\n  let backingStoreRatio = ctx.webkitBackingStorePixelRatio ||\n                          ctx.mozBackingStorePixelRatio ||\n                          ctx.msBackingStorePixelRatio ||\n                          ctx.oBackingStorePixelRatio ||\n                          ctx.backingStorePixelRatio || 1;\n  let pixelRatio = devicePixelRatio / backingStoreRatio;\n  return {\n    sx: pixelRatio,\n    sy: pixelRatio,\n    scaled: pixelRatio !== 1,\n  };\n}\n\n/**\n * Scrolls specified element into view of its parent.\n * @param {Object} element - The element to be visible.\n * @param {Object} spot - An object with optional top and left properties,\n *   specifying the offset from the top left edge.\n * @param {boolean} skipOverflowHiddenElements - Ignore elements that have\n *   the CSS rule `overflow: hidden;` set. The default is false.\n */\nfunction scrollIntoView(element, spot, skipOverflowHiddenElements = false) {\n  // Assuming offsetParent is available (it's not available when viewer is in\n  // hidden iframe or object). We have to scroll: if the offsetParent is not set\n  // producing the error. See also animationStarted.\n  let parent = element.offsetParent;\n  if (!parent) {\n    console.error('offsetParent is not set -- cannot scroll');\n    return;\n  }\n  let offsetY = element.offsetTop + element.clientTop;\n  let offsetX = element.offsetLeft + element.clientLeft;\n  while ((parent.clientHeight === parent.scrollHeight &&\n          parent.clientWidth === parent.scrollWidth) ||\n         (skipOverflowHiddenElements &&\n          getComputedStyle(parent).overflow === 'hidden')) {\n    if (parent.dataset._scaleY) {\n      offsetY /= parent.dataset._scaleY;\n      offsetX /= parent.dataset._scaleX;\n    }\n    offsetY += parent.offsetTop;\n    offsetX += parent.offsetLeft;\n    parent = parent.offsetParent;\n    if (!parent) {\n      return; // no need to scroll\n    }\n  }\n  if (spot) {\n    if (spot.top !== undefined) {\n      offsetY += spot.top;\n    }\n    if (spot.left !== undefined) {\n      offsetX += spot.left;\n      parent.scrollLeft = offsetX;\n    }\n  }\n  parent.scrollTop = offsetY;\n}\n\n/**\n * Helper function to start monitoring the scroll event and converting them into\n * PDF.js friendly one: with scroll debounce and scroll direction.\n */\nfunction watchScroll(viewAreaElement, callback) {\n  let debounceScroll = function(evt) {\n    if (rAF) {\n      return;\n    }\n    // schedule an invocation of scroll for next animation frame.\n    rAF = window.requestAnimationFrame(function viewAreaElementScrolled() {\n      rAF = null;\n\n      let currentX = viewAreaElement.scrollLeft;\n      let lastX = state.lastX;\n      if (currentX !== lastX) {\n        state.right = currentX > lastX;\n      }\n      state.lastX = currentX;\n      let currentY = viewAreaElement.scrollTop;\n      let lastY = state.lastY;\n      if (currentY !== lastY) {\n        state.down = currentY > lastY;\n      }\n      state.lastY = currentY;\n      callback(state);\n    });\n  };\n\n  let state = {\n    right: true,\n    down: true,\n    lastX: viewAreaElement.scrollLeft,\n    lastY: viewAreaElement.scrollTop,\n    _eventHandler: debounceScroll,\n  };\n\n  let rAF = null;\n  viewAreaElement.addEventListener('scroll', debounceScroll, true);\n  return state;\n}\n\n/**\n * Helper function to parse query string (e.g. ?param1=value&parm2=...).\n */\nfunction parseQueryString(query) {\n  let parts = query.split('&');\n  let params = Object.create(null);\n  for (let i = 0, ii = parts.length; i < ii; ++i) {\n    let param = parts[i].split('=');\n    let key = param[0].toLowerCase();\n    let value = param.length > 1 ? param[1] : null;\n    params[decodeURIComponent(key)] = decodeURIComponent(value);\n  }\n  return params;\n}\n\n/**\n * Use binary search to find the index of the first item in a given array which\n * passes a given condition. The items are expected to be sorted in the sense\n * that if the condition is true for one item in the array, then it is also true\n * for all following items.\n *\n * @returns {Number} Index of the first array element to pass the test,\n *                   or |items.length| if no such element exists.\n */\nfunction binarySearchFirstItem(items, condition) {\n  let minIndex = 0;\n  let maxIndex = items.length - 1;\n\n  if (items.length === 0 || !condition(items[maxIndex])) {\n    return items.length;\n  }\n  if (condition(items[minIndex])) {\n    return minIndex;\n  }\n\n  while (minIndex < maxIndex) {\n    let currentIndex = (minIndex + maxIndex) >> 1;\n    let currentItem = items[currentIndex];\n    if (condition(currentItem)) {\n      maxIndex = currentIndex;\n    } else {\n      minIndex = currentIndex + 1;\n    }\n  }\n  return minIndex; /* === maxIndex */\n}\n\n/**\n *  Approximates float number as a fraction using Farey sequence (max order\n *  of 8).\n *  @param {number} x - Positive float number.\n *  @returns {Array} Estimated fraction: the first array item is a numerator,\n *                   the second one is a denominator.\n */\nfunction approximateFraction(x) {\n  // Fast paths for int numbers or their inversions.\n  if (Math.floor(x) === x) {\n    return [x, 1];\n  }\n  let xinv = 1 / x;\n  let limit = 8;\n  if (xinv > limit) {\n    return [1, limit];\n  } else if (Math.floor(xinv) === xinv) {\n    return [1, xinv];\n  }\n\n  let x_ = x > 1 ? xinv : x;\n  // a/b and c/d are neighbours in Farey sequence.\n  let a = 0, b = 1, c = 1, d = 1;\n  // Limiting search to order 8.\n  while (true) {\n    // Generating next term in sequence (order of q).\n    let p = a + c, q = b + d;\n    if (q > limit) {\n      break;\n    }\n    if (x_ <= p / q) {\n      c = p; d = q;\n    } else {\n      a = p; b = q;\n    }\n  }\n  let result;\n  // Select closest of the neighbours to x.\n  if (x_ - a / b < c / d - x_) {\n    result = x_ === x ? [a, b] : [b, a];\n  } else {\n    result = x_ === x ? [c, d] : [d, c];\n  }\n  return result;\n}\n\nfunction roundToDivide(x, div) {\n  let r = x % div;\n  return r === 0 ? x : Math.round(x - r + div);\n}\n\n/**\n * Gets the size of the specified page, converted from PDF units to inches.\n * @param {Object} An Object containing the properties: {Array} `view`,\n *   {number} `userUnit`, and {number} `rotate`.\n * @return {Object} An Object containing the properties: {number} `width`\n *   and {number} `height`, given in inches.\n */\nfunction getPageSizeInches({ view, userUnit, rotate, }) {\n  const [x1, y1, x2, y2] = view;\n  // We need to take the page rotation into account as well.\n  const changeOrientation = rotate % 180 !== 0;\n\n  const width = (x2 - x1) / 72 * userUnit;\n  const height = (y2 - y1) / 72 * userUnit;\n\n  return {\n    width: (changeOrientation ? height : width),\n    height: (changeOrientation ? width : height),\n  };\n}\n\n/**\n * Helper function for getVisibleElements.\n *\n * @param {number} index - initial guess at the first visible element\n * @param {Array} views - array of pages, into which `index` is an index\n * @param {number} top - the top of the scroll pane\n * @returns {number} less than or equal to `index` that is definitely at or\n *   before the first visible element in `views`, but not by too much. (Usually,\n *   this will be the first element in the first partially visible row in\n *   `views`, although sometimes it goes back one row further.)\n */\nfunction backtrackBeforeAllVisibleElements(index, views, top) {\n  // binarySearchFirstItem's assumption is that the input is ordered, with only\n  // one index where the conditions flips from false to true: [false ...,\n  // true...]. With vertical scrolling and spreads, it is possible to have\n  // [false ..., true, false, true ...]. With wrapped scrolling we can have a\n  // similar sequence, with many more mixed true and false in the middle.\n  //\n  // So there is no guarantee that the binary search yields the index of the\n  // first visible element. It could have been any of the other visible elements\n  // that were preceded by a hidden element.\n\n  // Of course, if either this element or the previous (hidden) element is also\n  // the first element, there's nothing to worry about.\n  if (index < 2) {\n    return index;\n  }\n\n  // That aside, the possible cases are represented below.\n  //\n  //     ****  = fully hidden\n  //     A*B*  = mix of partially visible and/or hidden pages\n  //     CDEF  = fully visible\n  //\n  // (1) Binary search could have returned A, in which case we can stop.\n  // (2) Binary search could also have returned B, in which case we need to\n  // check the whole row.\n  // (3) Binary search could also have returned C, in which case we need to\n  // check the whole previous row.\n  //\n  // There's one other possibility:\n  //\n  //     ****  = fully hidden\n  //     ABCD  = mix of fully and/or partially visible pages\n  //\n  // (4) Binary search could only have returned A.\n\n  // Initially assume that we need to find the beginning of the current row\n  // (case 1, 2, or 4), which means finding a page that is above the current\n  // page's top. If the found page is partially visible, we're definitely not in\n  // case 3, and this assumption is correct.\n  let elt = views[index].div;\n  let pageTop = elt.offsetTop + elt.clientTop;\n\n  if (pageTop >= top) {\n    // The found page is fully visible, so we're actually either in case 3 or 4,\n    // and unfortunately we can't tell the difference between them without\n    // scanning the entire previous row, so we just conservatively assume that\n    // we do need to backtrack to that row. In both cases, the previous page is\n    // in the previous row, so use its top instead.\n    elt = views[index - 1].div;\n    pageTop = elt.offsetTop + elt.clientTop;\n  }\n\n  // Now we backtrack to the first page that still has its bottom below\n  // `pageTop`, which is the top of a page in the first visible row (unless\n  // we're in case 4, in which case it's the row before that).\n  // `index` is found by binary search, so the page at `index - 1` is\n  // invisible and we can start looking for potentially visible pages from\n  // `index - 2`. (However, if this loop terminates on its first iteration,\n  // which is the case when pages are stacked vertically, `index` should remain\n  // unchanged, so we use a distinct loop variable.)\n  for (let i = index - 2; i >= 0; --i) {\n    elt = views[i].div;\n    if (elt.offsetTop + elt.clientTop + elt.clientHeight <= pageTop) {\n      // We have reached the previous row, so stop now.\n      // This loop is expected to terminate relatively quickly because the\n      // number of pages per row is expected to be small.\n      break;\n    }\n    index = i;\n  }\n  return index;\n}\n\n/**\n * Generic helper to find out what elements are visible within a scroll pane.\n *\n * Well, pretty generic. There are some assumptions placed on the elements\n * referenced by `views`:\n *   - If `horizontal`, no left of any earlier element is to the right of the\n *     left of any later element.\n *   - Otherwise, `views` can be split into contiguous rows where, within a row,\n *     no top of any element is below the bottom of any other element, and\n *     between rows, no bottom of any element in an earlier row is below the\n *     top of any element in a later row.\n *\n * (Here, top, left, etc. all refer to the padding edge of the element in\n * question. For pages, that ends up being equivalent to the bounding box of the\n * rendering canvas. Earlier and later refer to index in `views`, not page\n * layout.)\n *\n * @param scrollEl {HTMLElement} - a container that can possibly scroll\n * @param views {Array} - objects with a `div` property that contains an\n *   HTMLElement, which should all be descendents of `scrollEl` satisfying the\n *   above layout assumptions\n * @param sortByVisibility {boolean} - if true, the returned elements are sorted\n *   in descending order of the percent of their padding box that is visible\n * @param horizontal {boolean} - if true, the elements are assumed to be laid\n *   out horizontally instead of vertically\n * @returns {Object} `{ first, last, views: [{ id, x, y, view, percent }] }`\n */\nfunction getVisibleElements(scrollEl, views, sortByVisibility = false,\n                            horizontal = false) {\n  const top = scrollEl.scrollTop, bottom = top + scrollEl.clientHeight;\n  const left = scrollEl.scrollLeft, right = left + scrollEl.clientWidth;\n\n  // Throughout this \"generic\" function, comments will assume we're working with\n  // PDF document pages, which is the most important and complex case. In this\n  // case, the visible elements we're actually interested is the page canvas,\n  // which is contained in a wrapper which adds no padding/border/margin, which\n  // is itself contained in `view.div` which adds no padding (but does add a\n  // border). So, as specified in this function's doc comment, this function\n  // does all of its work on the padding edge of the provided views, starting at\n  // offsetLeft/Top (which includes margin) and adding clientLeft/Top (which is\n  // the border). Adding clientWidth/Height gets us the bottom-right corner of\n  // the padding edge.\n  function isElementBottomAfterViewTop(view) {\n    const element = view.div;\n    const elementBottom =\n      element.offsetTop + element.clientTop + element.clientHeight;\n    return elementBottom > top;\n  }\n  function isElementRightAfterViewLeft(view) {\n    const element = view.div;\n    const elementRight =\n      element.offsetLeft + element.clientLeft + element.clientWidth;\n    return elementRight > left;\n  }\n\n  const visible = [], numViews = views.length;\n  let firstVisibleElementInd = numViews === 0 ? 0 :\n    binarySearchFirstItem(views, horizontal ? isElementRightAfterViewLeft :\n                                              isElementBottomAfterViewTop);\n\n  // Please note the return value of the `binarySearchFirstItem` function when\n  // no valid element is found (hence the `firstVisibleElementInd` check below).\n  if (firstVisibleElementInd > 0 && firstVisibleElementInd < numViews &&\n      !horizontal) {\n    // In wrapped scrolling (or vertical scrolling with spreads), with some page\n    // sizes, isElementBottomAfterViewTop doesn't satisfy the binary search\n    // condition: there can be pages with bottoms above the view top between\n    // pages with bottoms below. This function detects and corrects that error;\n    // see it for more comments.\n    firstVisibleElementInd =\n      backtrackBeforeAllVisibleElements(firstVisibleElementInd, views, top);\n  }\n\n  // lastEdge acts as a cutoff for us to stop looping, because we know all\n  // subsequent pages will be hidden.\n  //\n  // When using wrapped scrolling or vertical scrolling with spreads, we can't\n  // simply stop the first time we reach a page below the bottom of the view;\n  // the tops of subsequent pages on the same row could still be visible. In\n  // horizontal scrolling, we don't have that issue, so we can stop as soon as\n  // we pass `right`, without needing the code below that handles the -1 case.\n  let lastEdge = horizontal ? right : -1;\n\n  for (let i = firstVisibleElementInd; i < numViews; i++) {\n    const view = views[i], element = view.div;\n    const currentWidth = element.offsetLeft + element.clientLeft;\n    const currentHeight = element.offsetTop + element.clientTop;\n    const viewWidth = element.clientWidth, viewHeight = element.clientHeight;\n    const viewRight = currentWidth + viewWidth;\n    const viewBottom = currentHeight + viewHeight;\n\n    if (lastEdge === -1) {\n      // As commented above, this is only needed in non-horizontal cases.\n      // Setting lastEdge to the bottom of the first page that is partially\n      // visible ensures that the next page fully below lastEdge is on the\n      // next row, which has to be fully hidden along with all subsequent rows.\n      if (viewBottom >= bottom) {\n        lastEdge = viewBottom;\n      }\n    } else if ((horizontal ? currentWidth : currentHeight) > lastEdge) {\n      break;\n    }\n\n    if (viewBottom <= top || currentHeight >= bottom ||\n        viewRight <= left || currentWidth >= right) {\n      continue;\n    }\n\n    const hiddenHeight = Math.max(0, top - currentHeight) +\n                         Math.max(0, viewBottom - bottom);\n    const hiddenWidth = Math.max(0, left - currentWidth) +\n                        Math.max(0, viewRight - right);\n    const percent = ((viewHeight - hiddenHeight) * (viewWidth - hiddenWidth) *\n                     100 / viewHeight / viewWidth) | 0;\n    visible.push({\n      id: view.id,\n      x: currentWidth,\n      y: currentHeight,\n      view,\n      percent,\n    });\n  }\n\n  const first = visible[0], last = visible[visible.length - 1];\n\n  if (sortByVisibility) {\n    visible.sort(function(a, b) {\n      let pc = a.percent - b.percent;\n      if (Math.abs(pc) > 0.001) {\n        return -pc;\n      }\n      return a.id - b.id; // ensure stability\n    });\n  }\n  return { first, last, views: visible, };\n}\n\n/**\n * Event handler to suppress context menu.\n */\nfunction noContextMenuHandler(evt) {\n  evt.preventDefault();\n}\n\nfunction isDataSchema(url) {\n  let i = 0, ii = url.length;\n  while (i < ii && url[i].trim() === '') {\n    i++;\n  }\n  return url.substring(i, i + 5).toLowerCase() === 'data:';\n}\n\n/**\n * Returns the filename or guessed filename from the url (see issue 3455).\n * @param {string} url - The original PDF location.\n * @param {string} defaultFilename - The value returned if the filename is\n *   unknown, or the protocol is unsupported.\n * @returns {string} Guessed PDF filename.\n */\nfunction getPDFFileNameFromURL(url, defaultFilename = 'document.pdf') {\n  if (typeof url !== 'string') {\n    return defaultFilename;\n  }\n  if (isDataSchema(url)) {\n    console.warn('getPDFFileNameFromURL: ' +\n                 'ignoring \"data:\" URL for performance reasons.');\n    return defaultFilename;\n  }\n  const reURI = /^(?:(?:[^:]+:)?\\/\\/[^\\/]+)?([^?#]*)(\\?[^#]*)?(#.*)?$/;\n  //            SCHEME        HOST         1.PATH  2.QUERY   3.REF\n  // Pattern to get last matching NAME.pdf\n  const reFilename = /[^\\/?#=]+\\.pdf\\b(?!.*\\.pdf\\b)/i;\n  let splitURI = reURI.exec(url);\n  let suggestedFilename = reFilename.exec(splitURI[1]) ||\n                          reFilename.exec(splitURI[2]) ||\n                          reFilename.exec(splitURI[3]);\n  if (suggestedFilename) {\n    suggestedFilename = suggestedFilename[0];\n    if (suggestedFilename.includes('%')) {\n      // URL-encoded %2Fpath%2Fto%2Ffile.pdf should be file.pdf\n      try {\n        suggestedFilename =\n          reFilename.exec(decodeURIComponent(suggestedFilename))[0];\n      } catch (ex) { // Possible (extremely rare) errors:\n        // URIError \"Malformed URI\", e.g. for \"%AA.pdf\"\n        // TypeError \"null has no properties\", e.g. for \"%2F.pdf\"\n      }\n    }\n  }\n  return suggestedFilename || defaultFilename;\n}\n\nfunction normalizeWheelEventDelta(evt) {\n  let delta = Math.sqrt(evt.deltaX * evt.deltaX + evt.deltaY * evt.deltaY);\n  let angle = Math.atan2(evt.deltaY, evt.deltaX);\n  if (-0.25 * Math.PI < angle && angle < 0.75 * Math.PI) {\n    // All that is left-up oriented has to change the sign.\n    delta = -delta;\n  }\n\n  const MOUSE_DOM_DELTA_PIXEL_MODE = 0;\n  const MOUSE_DOM_DELTA_LINE_MODE = 1;\n  const MOUSE_PIXELS_PER_LINE = 30;\n  const MOUSE_LINES_PER_PAGE = 30;\n\n  // Converts delta to per-page units\n  if (evt.deltaMode === MOUSE_DOM_DELTA_PIXEL_MODE) {\n    delta /= MOUSE_PIXELS_PER_LINE * MOUSE_LINES_PER_PAGE;\n  } else if (evt.deltaMode === MOUSE_DOM_DELTA_LINE_MODE) {\n    delta /= MOUSE_LINES_PER_PAGE;\n  }\n  return delta;\n}\n\nfunction isValidRotation(angle) {\n  return Number.isInteger(angle) && angle % 90 === 0;\n}\n\nfunction isValidScrollMode(mode) {\n  return (Number.isInteger(mode) && Object.values(ScrollMode).includes(mode) &&\n          mode !== ScrollMode.UNKNOWN);\n}\n\nfunction isValidSpreadMode(mode) {\n  return (Number.isInteger(mode) && Object.values(SpreadMode).includes(mode) &&\n          mode !== SpreadMode.UNKNOWN);\n}\n\nfunction isPortraitOrientation(size) {\n  return size.width <= size.height;\n}\n\nconst WaitOnType = {\n  EVENT: 'event',\n  TIMEOUT: 'timeout',\n};\n\n/**\n * @typedef {Object} WaitOnEventOrTimeoutParameters\n * @property {Object} target - The event target, can for example be:\n *   `window`, `document`, a DOM element, or an {EventBus} instance.\n * @property {string} name - The name of the event.\n * @property {number} delay - The delay, in milliseconds, after which the\n *   timeout occurs (if the event wasn't already dispatched).\n */\n\n/**\n * Allows waiting for an event or a timeout, whichever occurs first.\n * Can be used to ensure that an action always occurs, even when an event\n * arrives late or not at all.\n *\n * @param {WaitOnEventOrTimeoutParameters}\n * @returns {Promise} A promise that is resolved with a {WaitOnType} value.\n */\nfunction waitOnEventOrTimeout({ target, name, delay = 0, }) {\n  return new Promise(function(resolve, reject) {\n    if (typeof target !== 'object' || !(name && typeof name === 'string') ||\n        !(Number.isInteger(delay) && delay >= 0)) {\n      throw new Error('waitOnEventOrTimeout - invalid parameters.');\n    }\n\n    function handler(type) {\n      if (target instanceof EventBus) {\n        target.off(name, eventHandler);\n      } else {\n        target.removeEventListener(name, eventHandler);\n      }\n\n      if (timeout) {\n        clearTimeout(timeout);\n      }\n      resolve(type);\n    }\n\n    const eventHandler = handler.bind(null, WaitOnType.EVENT);\n    if (target instanceof EventBus) {\n      target.on(name, eventHandler);\n    } else {\n      target.addEventListener(name, eventHandler);\n    }\n\n    const timeoutHandler = handler.bind(null, WaitOnType.TIMEOUT);\n    let timeout = setTimeout(timeoutHandler, delay);\n  });\n}\n\n/**\n * Promise that is resolved when DOM window becomes visible.\n */\nlet animationStarted = new Promise(function (resolve) {\n  if ((typeof PDFJSDev !== 'undefined' && PDFJSDev.test('LIB')) &&\n      typeof window === 'undefined') {\n    // Prevent \"ReferenceError: window is not defined\" errors when running the\n    // unit-tests in Node.js/Travis.\n    setTimeout(resolve, 20);\n    return;\n  }\n  window.requestAnimationFrame(resolve);\n});\n\n/**\n * Simple event bus for an application. Listeners are attached using the\n * `on` and `off` methods. To raise an event, the `dispatch` method shall be\n * used.\n */\nclass EventBus {\n  constructor({ dispatchToDOM = false, } = {}) {\n    this._listeners = Object.create(null);\n    this._dispatchToDOM = dispatchToDOM === true;\n  }\n\n  on(eventName, listener) {\n    let eventListeners = this._listeners[eventName];\n    if (!eventListeners) {\n      eventListeners = [];\n      this._listeners[eventName] = eventListeners;\n    }\n    eventListeners.push(listener);\n  }\n\n  off(eventName, listener) {\n    let eventListeners = this._listeners[eventName];\n    let i;\n    if (!eventListeners || ((i = eventListeners.indexOf(listener)) < 0)) {\n      return;\n    }\n    eventListeners.splice(i, 1);\n  }\n\n  dispatch(eventName) {\n    let eventListeners = this._listeners[eventName];\n    if (!eventListeners || eventListeners.length === 0) {\n      if (this._dispatchToDOM) {\n        const args = Array.prototype.slice.call(arguments, 1);\n        this._dispatchDOMEvent(eventName, args);\n      }\n      return;\n    }\n    // Passing all arguments after the eventName to the listeners.\n    const args = Array.prototype.slice.call(arguments, 1);\n    // Making copy of the listeners array in case if it will be modified\n    // during dispatch.\n    eventListeners.slice(0).forEach(function (listener) {\n      listener.apply(null, args);\n    });\n    if (this._dispatchToDOM) {\n      this._dispatchDOMEvent(eventName, args);\n    }\n  }\n\n  /**\n   * @private\n   */\n  _dispatchDOMEvent(eventName, args = null) {\n    const details = Object.create(null);\n    if (args && args.length > 0) {\n      const obj = args[0];\n      for (let key in obj) {\n        const value = obj[key];\n        if (key === 'source') {\n          if (value === window || value === document) {\n            return; // No need to re-dispatch (already) global events.\n          }\n          continue; // Ignore the `source` property.\n        }\n        details[key] = value;\n      }\n    }\n    const event = document.createEvent('CustomEvent');\n    event.initCustomEvent(eventName, true, true, details);\n    document.dispatchEvent(event);\n  }\n}\n\nlet globalEventBus = null;\nfunction getGlobalEventBus(dispatchToDOM = false) {\n  if (!globalEventBus) {\n    globalEventBus = new EventBus({ dispatchToDOM, });\n  }\n  return globalEventBus;\n}\n\nfunction clamp(v, min, max) {\n  return Math.min(Math.max(v, min), max);\n}\n\nclass ProgressBar {\n  constructor(id, { height, width, units, } = {}) {\n    this.visible = true;\n\n    // Fetch the sub-elements for later.\n    this.div = document.querySelector(id + ' .progress');\n    // Get the loading bar element, so it can be resized to fit the viewer.\n    this.bar = this.div.parentNode;\n\n    // Get options, with sensible defaults.\n    this.height = height || 100;\n    this.width = width || 100;\n    this.units = units || '%';\n\n    // Initialize heights.\n    this.div.style.height = this.height + this.units;\n    this.percent = 0;\n  }\n\n  _updateBar() {\n    if (this._indeterminate) {\n      this.div.classList.add('indeterminate');\n      this.div.style.width = this.width + this.units;\n      return;\n    }\n\n    this.div.classList.remove('indeterminate');\n    let progressSize = this.width * this._percent / 100;\n    this.div.style.width = progressSize + this.units;\n  }\n\n  get percent() {\n    return this._percent;\n  }\n\n  set percent(val) {\n    this._indeterminate = isNaN(val);\n    this._percent = clamp(val, 0, 100);\n    this._updateBar();\n  }\n\n  setWidth(viewer) {\n    if (!viewer) {\n      return;\n    }\n    let container = viewer.parentNode;\n    let scrollbarWidth = container.offsetWidth - viewer.offsetWidth;\n    if (scrollbarWidth > 0) {\n      this.bar.setAttribute('style', 'width: calc(100% - ' +\n                                     scrollbarWidth + 'px);');\n    }\n  }\n\n  hide() {\n    if (!this.visible) {\n      return;\n    }\n    this.visible = false;\n    this.bar.classList.add('hidden');\n    document.body.classList.remove('loadingInProgress');\n  }\n\n  show() {\n    if (this.visible) {\n      return;\n    }\n    this.visible = true;\n    document.body.classList.add('loadingInProgress');\n    this.bar.classList.remove('hidden');\n  }\n}\n\n/**\n * Moves all elements of an array that satisfy condition to the end of the\n * array, preserving the order of the rest.\n */\nfunction moveToEndOfArray(arr, condition) {\n  const moved = [], len = arr.length;\n  let write = 0;\n  for (let read = 0; read < len; ++read) {\n    if (condition(arr[read])) {\n      moved.push(arr[read]);\n    } else {\n      arr[write] = arr[read];\n      ++write;\n    }\n  }\n  for (let read = 0; write < len; ++read, ++write) {\n    arr[write] = moved[read];\n  }\n}\n\nexport {\n  CSS_UNITS,\n  DEFAULT_SCALE_VALUE,\n  DEFAULT_SCALE,\n  MIN_SCALE,\n  MAX_SCALE,\n  UNKNOWN_SCALE,\n  MAX_AUTO_SCALE,\n  SCROLLBAR_PADDING,\n  VERTICAL_PADDING,\n  isValidRotation,\n  isValidScrollMode,\n  isValidSpreadMode,\n  isPortraitOrientation,\n  PresentationModeState,\n  RendererType,\n  TextLayerMode,\n  ScrollMode,\n  SpreadMode,\n  NullL10n,\n  EventBus,\n  getGlobalEventBus,\n  ProgressBar,\n  getPDFFileNameFromURL,\n  noContextMenuHandler,\n  parseQueryString,\n  backtrackBeforeAllVisibleElements, // only exported for testing\n  getVisibleElements,\n  roundToDivide,\n  getPageSizeInches,\n  approximateFraction,\n  getOutputScale,\n  scrollIntoView,\n  watchScroll,\n  binarySearchFirstItem,\n  normalizeWheelEventDelta,\n  animationStarted,\n  WaitOnType,\n  waitOnEventOrTimeout,\n  moveToEndOfArray,\n};\n","/* Copyright 2018 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { apiCompatibilityParams } from 'pdfjs-lib';\nimport { viewerCompatibilityParams } from './viewer_compatibility';\n\nconst OptionKind = {\n  VIEWER: 0x02,\n  API: 0x04,\n  WORKER: 0x08,\n  PREFERENCE: 0x80,\n};\n\n/**\n * PLEASE NOTE: To avoid introducing unnecessary dependencies, we specify the\n *              values below *explicitly* rather than relying on imported types.\n */\nconst defaultOptions = {\n  cursorToolOnLoad: {\n    /** @type {number} */\n    value: 0,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  defaultUrl: {\n    /** @type {string} */\n    value: '',\n    kind: OptionKind.VIEWER,\n  },\n  defaultZoomValue: {\n    /** @type {string} */\n    value: '',\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  disableHistory: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.VIEWER,\n  },\n  disablePageLabels: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  /**\n   * The `disablePreferences` is, conditionally, defined below.\n   */\n  enablePrintAutoRotate: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  enableWebGL: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  eventBusDispatchToDOM: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  externalLinkRel: {\n    /** @type {string} */\n    value: 'noopener noreferrer nofollow',\n    kind: OptionKind.VIEWER,\n  },\n  externalLinkTarget: {\n    /** @type {number} */\n    value: 0,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  historyUpdateUrl: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  imageResourcesPath: {\n    /** @type {string} */\n    value: './images/',\n    kind: OptionKind.VIEWER,\n  },\n  /**\n   * The `locale` is, conditionally, defined below.\n   */\n  maxCanvasPixels: {\n    /** @type {number} */\n    value: 16777216,\n    compatibility: viewerCompatibilityParams.maxCanvasPixels,\n    kind: OptionKind.VIEWER,\n  },\n  pdfBugEnabled: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  /**\n   * The `printResolution` is, conditionally, defined below.\n   */\n  renderer: {\n    /** @type {string} */\n    value: 'canvas',\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  renderInteractiveForms: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  sidebarViewOnLoad: {\n    /** @type {number} */\n    value: -1,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  scrollModeOnLoad: {\n    /** @type {number} */\n    value: -1,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  spreadModeOnLoad: {\n    /** @type {number} */\n    value: -1,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  textLayerMode: {\n    /** @type {number} */\n    value: 1,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  useOnlyCssZoom: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n  viewOnLoad: {\n    /** @type {boolean} */\n    value: 0,\n    kind: OptionKind.VIEWER + OptionKind.PREFERENCE,\n  },\n\n  cMapPacked: {\n    /** @type {boolean} */\n    value: true,\n    kind: OptionKind.API,\n  },\n  cMapUrl: {\n    /** @type {string} */\n    value: (typeof PDFJSDev === 'undefined' || !PDFJSDev.test('PRODUCTION') ?\n            '../external/bcmaps/' : '../web/cmaps/'),\n    kind: OptionKind.API,\n  },\n  disableAutoFetch: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.API + OptionKind.PREFERENCE,\n  },\n  disableCreateObjectURL: {\n    /** @type {boolean} */\n    value: false,\n    compatibility: apiCompatibilityParams.disableCreateObjectURL,\n    kind: OptionKind.API,\n  },\n  disableFontFace: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.API + OptionKind.PREFERENCE,\n  },\n  disableRange: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.API + OptionKind.PREFERENCE,\n  },\n  disableStream: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.API + OptionKind.PREFERENCE,\n  },\n  docBaseUrl: {\n    /** @type {string} */\n    value: '',\n    kind: OptionKind.API,\n  },\n  isEvalSupported: {\n    /** @type {boolean} */\n    value: true,\n    kind: OptionKind.API,\n  },\n  maxImageSize: {\n    /** @type {number} */\n    value: -1,\n    kind: OptionKind.API,\n  },\n  pdfBug: {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.API,\n  },\n  verbosity: {\n    /** @type {number} */\n    value: 1,\n    kind: OptionKind.API,\n  },\n\n  workerPort: {\n    /** @type {Object} */\n    value: null,\n    kind: OptionKind.WORKER,\n  },\n  workerSrc: {\n    /** @type {string} */\n    value: (typeof PDFJSDev === 'undefined' || !PDFJSDev.test('PRODUCTION') ?\n            '../src/worker_loader.js' : '../build/pdf.worker.js'),\n    kind: OptionKind.WORKER,\n  },\n};\nif (typeof PDFJSDev === 'undefined' ||\n    PDFJSDev.test('!PRODUCTION || (GENERIC && !LIB)')) {\n  defaultOptions.disablePreferences = {\n    /** @type {boolean} */\n    value: false,\n    kind: OptionKind.VIEWER,\n  };\n  defaultOptions.locale = {\n    /** @type {string} */\n    value: (typeof navigator !== 'undefined' ? navigator.language : 'en-US'),\n    kind: OptionKind.VIEWER,\n  };\n  defaultOptions.printResolution = {\n    /** @type {number} */\n    value: 150,\n    kind: OptionKind.VIEWER,\n  };\n}\n\nconst userOptions = Object.create(null);\n\nclass AppOptions {\n  constructor() {\n    throw new Error('Cannot initialize AppOptions.');\n  }\n\n  static get(name) {\n    const userOption = userOptions[name];\n    if (userOption !== undefined) {\n      return userOption;\n    }\n    const defaultOption = defaultOptions[name];\n    if (defaultOption !== undefined) {\n      return (defaultOption.compatibility || defaultOption.value);\n    }\n    return undefined;\n  }\n\n  static getAll(kind = null) {\n    const options = Object.create(null);\n    for (const name in defaultOptions) {\n      const defaultOption = defaultOptions[name];\n      if (kind) {\n        if ((kind & defaultOption.kind) === 0) {\n          continue;\n        }\n        if (kind === OptionKind.PREFERENCE) {\n          const value = defaultOption.value, valueType = typeof value;\n\n          if (valueType === 'boolean' || valueType === 'string' ||\n              (valueType === 'number' && Number.isInteger(value))) {\n            options[name] = value;\n            continue;\n          }\n          throw new Error(`Invalid type for preference: ${name}`);\n        }\n      }\n      const userOption = userOptions[name];\n      options[name] = (userOption !== undefined ? userOption :\n                       (defaultOption.compatibility || defaultOption.value));\n    }\n    return options;\n  }\n\n  static set(name, value) {\n    userOptions[name] = value;\n  }\n\n  static remove(name) {\n    delete userOptions[name];\n  }\n}\n\nexport {\n  AppOptions,\n  OptionKind,\n};\n","/* Copyright 2016 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/* globals module, __non_webpack_require__ */\n\n'use strict';\n\nlet pdfjsLib;\nif (typeof window !== 'undefined' && window['pdfjs-dist/build/pdf']) {\n  pdfjsLib = window['pdfjs-dist/build/pdf'];\n} else {\n  pdfjsLib = __non_webpack_require__('../build/pdf.js');\n}\nmodule.exports = pdfjsLib;\n","/* Copyright 2018 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nlet compatibilityParams = Object.create(null);\nif (typeof PDFJSDev === 'undefined' || PDFJSDev.test('GENERIC')) {\n  const userAgent =\n    (typeof navigator !== 'undefined' && navigator.userAgent) || '';\n  const isAndroid = /Android/.test(userAgent);\n  const isIOS = /\\b(iPad|iPhone|iPod)(?=;)/.test(userAgent);\n\n  // Limit canvas size to 5 mega-pixels on mobile.\n  // Support: Android, iOS\n  (function checkCanvasSizeLimitation() {\n    if (isIOS || isAndroid) {\n      compatibilityParams.maxCanvasPixels = 5242880;\n    }\n  })();\n}\n\nexports.viewerCompatibilityParams = Object.freeze(compatibilityParams);\n","/* Copyright 2017 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { GrabToPan } from './grab_to_pan';\n\nconst CursorTool = {\n  SELECT: 0, // The default value.\n  HAND: 1,\n  ZOOM: 2,\n};\n\n/**\n * @typedef {Object} PDFCursorToolsOptions\n * @property {HTMLDivElement} container - The document container.\n * @property {EventBus} eventBus - The application event bus.\n * @property {number} cursorToolOnLoad - (optional) The cursor tool that will be\n *   enabled on load; the constants from {CursorTool} should be used.\n *   The default value is `CursorTool.SELECT`.\n */\n\nclass PDFCursorTools {\n  /**\n   * @param {PDFCursorToolsOptions} options\n   */\n  constructor({ container, eventBus, cursorToolOnLoad = CursorTool.SELECT, }) {\n    this.container = container;\n    this.eventBus = eventBus;\n\n    this.active = CursorTool.SELECT;\n    this.activeBeforePresentationMode = null;\n\n    this.handTool = new GrabToPan({\n      element: this.container,\n    });\n\n    this._addEventListeners();\n\n    // Defer the initial `switchTool` call, to give other viewer components\n    // time to initialize *and* register 'cursortoolchanged' event listeners.\n    Promise.resolve().then(() => {\n      this.switchTool(cursorToolOnLoad);\n    });\n  }\n\n  /**\n   * @returns {number} One of the values in {CursorTool}.\n   */\n  get activeTool() {\n    return this.active;\n  }\n\n  /**\n   * NOTE: This method is ignored while Presentation Mode is active.\n   * @param {number} tool - The cursor mode that should be switched to,\n   *                        must be one of the values in {CursorTool}.\n   */\n  switchTool(tool) {\n    if (this.activeBeforePresentationMode !== null) {\n      return; // Cursor tools cannot be used in Presentation Mode.\n    }\n    if (tool === this.active) {\n      return; // The requested tool is already active.\n    }\n\n    let disableActiveTool = () => {\n      switch (this.active) {\n        case CursorTool.SELECT:\n          break;\n        case CursorTool.HAND:\n          this.handTool.deactivate();\n          break;\n        case CursorTool.ZOOM:\n          /* falls through */\n      }\n    };\n\n    switch (tool) { // Enable the new cursor tool.\n      case CursorTool.SELECT:\n        disableActiveTool();\n        break;\n      case CursorTool.HAND:\n        disableActiveTool();\n        this.handTool.activate();\n        break;\n      case CursorTool.ZOOM:\n        /* falls through */\n      default:\n        console.error(`switchTool: \"${tool}\" is an unsupported value.`);\n        return;\n    }\n    // Update the active tool *after* it has been validated above,\n    // in order to prevent setting it to an invalid state.\n    this.active = tool;\n\n    this._dispatchEvent();\n  }\n\n  /**\n   * @private\n   */\n  _dispatchEvent() {\n    this.eventBus.dispatch('cursortoolchanged', {\n      source: this,\n      tool: this.active,\n    });\n  }\n\n  /**\n   * @private\n   */\n  _addEventListeners() {\n    this.eventBus.on('switchcursortool', (evt) => {\n      this.switchTool(evt.tool);\n    });\n\n    this.eventBus.on('presentationmodechanged', (evt) => {\n      if (evt.switchInProgress) {\n        return;\n      }\n      let previouslyActive;\n\n      if (evt.active) {\n        previouslyActive = this.active;\n\n        this.switchTool(CursorTool.SELECT);\n        this.activeBeforePresentationMode = previouslyActive;\n      } else {\n        previouslyActive = this.activeBeforePresentationMode;\n\n        this.activeBeforePresentationMode = null;\n        this.switchTool(previouslyActive);\n      }\n    });\n  }\n}\n\nexport {\n  CursorTool,\n  PDFCursorTools,\n};\n","/* Copyright 2013 Rob Wu <rob@robwu.nl>\n * https://github.com/Rob--W/grab-to-pan.js\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/* eslint-disable no-var */\n\n/**\n * Construct a GrabToPan instance for a given HTML element.\n * @param options.element {Element}\n * @param options.ignoreTarget {function} optional. See `ignoreTarget(node)`\n * @param options.onActiveChanged {function(boolean)} optional. Called\n *  when grab-to-pan is (de)activated. The first argument is a boolean that\n *  shows whether grab-to-pan is activated.\n */\nfunction GrabToPan(options) {\n  this.element = options.element;\n  this.document = options.element.ownerDocument;\n  if (typeof options.ignoreTarget === 'function') {\n    this.ignoreTarget = options.ignoreTarget;\n  }\n  this.onActiveChanged = options.onActiveChanged;\n\n  // Bind the contexts to ensure that `this` always points to\n  // the GrabToPan instance.\n  this.activate = this.activate.bind(this);\n  this.deactivate = this.deactivate.bind(this);\n  this.toggle = this.toggle.bind(this);\n  this._onmousedown = this._onmousedown.bind(this);\n  this._onmousemove = this._onmousemove.bind(this);\n  this._endPan = this._endPan.bind(this);\n\n  // This overlay will be inserted in the document when the mouse moves during\n  // a grab operation, to ensure that the cursor has the desired appearance.\n  var overlay = this.overlay = document.createElement('div');\n  overlay.className = 'grab-to-pan-grabbing';\n}\nGrabToPan.prototype = {\n  /**\n   * Class name of element which can be grabbed\n   */\n  CSS_CLASS_GRAB: 'grab-to-pan-grab',\n\n  /**\n   * Bind a mousedown event to the element to enable grab-detection.\n   */\n  activate: function GrabToPan_activate() {\n    if (!this.active) {\n      this.active = true;\n      this.element.addEventListener('mousedown', this._onmousedown, true);\n      this.element.classList.add(this.CSS_CLASS_GRAB);\n      if (this.onActiveChanged) {\n        this.onActiveChanged(true);\n      }\n    }\n  },\n\n  /**\n   * Removes all events. Any pending pan session is immediately stopped.\n   */\n  deactivate: function GrabToPan_deactivate() {\n    if (this.active) {\n      this.active = false;\n      this.element.removeEventListener('mousedown', this._onmousedown, true);\n      this._endPan();\n      this.element.classList.remove(this.CSS_CLASS_GRAB);\n      if (this.onActiveChanged) {\n        this.onActiveChanged(false);\n      }\n    }\n  },\n\n  toggle: function GrabToPan_toggle() {\n    if (this.active) {\n      this.deactivate();\n    } else {\n      this.activate();\n    }\n  },\n\n  /**\n   * Whether to not pan if the target element is clicked.\n   * Override this method to change the default behaviour.\n   *\n   * @param node {Element} The target of the event\n   * @return {boolean} Whether to not react to the click event.\n   */\n  ignoreTarget: function GrabToPan_ignoreTarget(node) {\n    // Use matchesSelector to check whether the clicked element\n    // is (a child of) an input element / link\n    return node[matchesSelector](\n      'a[href], a[href] *, input, textarea, button, button *, select, option'\n    );\n  },\n\n  /**\n   * @private\n   */\n  _onmousedown: function GrabToPan__onmousedown(event) {\n    if (event.button !== 0 || this.ignoreTarget(event.target)) {\n      return;\n    }\n    if (event.originalTarget) {\n      try {\n        // eslint-disable-next-line no-unused-expressions\n        event.originalTarget.tagName;\n      } catch (e) {\n        // Mozilla-specific: element is a scrollbar (XUL element)\n        return;\n      }\n    }\n\n    this.scrollLeftStart = this.element.scrollLeft;\n    this.scrollTopStart = this.element.scrollTop;\n    this.clientXStart = event.clientX;\n    this.clientYStart = event.clientY;\n    this.document.addEventListener('mousemove', this._onmousemove, true);\n    this.document.addEventListener('mouseup', this._endPan, true);\n    // When a scroll event occurs before a mousemove, assume that the user\n    // dragged a scrollbar (necessary for Opera Presto, Safari and IE)\n    // (not needed for Chrome/Firefox)\n    this.element.addEventListener('scroll', this._endPan, true);\n    event.preventDefault();\n    event.stopPropagation();\n\n    var focusedElement = document.activeElement;\n    if (focusedElement && !focusedElement.contains(event.target)) {\n      focusedElement.blur();\n    }\n  },\n\n  /**\n   * @private\n   */\n  _onmousemove: function GrabToPan__onmousemove(event) {\n    this.element.removeEventListener('scroll', this._endPan, true);\n    if (isLeftMouseReleased(event)) {\n      this._endPan();\n      return;\n    }\n    var xDiff = event.clientX - this.clientXStart;\n    var yDiff = event.clientY - this.clientYStart;\n    var scrollTop = this.scrollTopStart - yDiff;\n    var scrollLeft = this.scrollLeftStart - xDiff;\n    if (this.element.scrollTo) {\n      this.element.scrollTo({\n        top: scrollTop,\n        left: scrollLeft,\n        behavior: 'instant',\n      });\n    } else {\n      this.element.scrollTop = scrollTop;\n      this.element.scrollLeft = scrollLeft;\n    }\n    if (!this.overlay.parentNode) {\n      document.body.appendChild(this.overlay);\n    }\n  },\n\n  /**\n   * @private\n   */\n  _endPan: function GrabToPan__endPan() {\n    this.element.removeEventListener('scroll', this._endPan, true);\n    this.document.removeEventListener('mousemove', this._onmousemove, true);\n    this.document.removeEventListener('mouseup', this._endPan, true);\n    // Note: ChildNode.remove doesn't throw if the parentNode is undefined.\n    this.overlay.remove();\n  },\n};\n\n// Get the correct (vendor-prefixed) name of the matches method.\nvar matchesSelector;\n['webkitM', 'mozM', 'msM', 'oM', 'm'].some(function(prefix) {\n  var name = prefix + 'atches';\n  if (name in document.documentElement) {\n    matchesSelector = name;\n  }\n  name += 'Selector';\n  if (name in document.documentElement) {\n    matchesSelector = name;\n  }\n  return matchesSelector; // If found, then truthy, and [].some() ends.\n});\n\n// Browser sniffing because it's impossible to feature-detect\n// whether event.which for onmousemove is reliable\nvar isNotIEorIsIE10plus = !document.documentMode || document.documentMode > 9;\nvar chrome = window.chrome;\nvar isChrome15OrOpera15plus = chrome && (chrome.webstore || chrome.app);\n//                                       ^ Chrome 15+       ^ Opera 15+\nvar isSafari6plus = /Apple/.test(navigator.vendor) &&\n                    /Version\\/([6-9]\\d*|[1-5]\\d+)/.test(navigator.userAgent);\n\n/**\n * Whether the left mouse is not pressed.\n * @param event {MouseEvent}\n * @return {boolean} True if the left mouse button is not pressed.\n *                   False if unsure or if the left mouse button is pressed.\n */\nfunction isLeftMouseReleased(event) {\n  if ('buttons' in event && isNotIEorIsIE10plus) {\n    // http://www.w3.org/TR/DOM-Level-3-Events/#events-MouseEvent-buttons\n    // Firefox 15+\n    // Internet Explorer 10+\n    return !(event.buttons & 1);\n  }\n  if (isChrome15OrOpera15plus || isSafari6plus) {\n    // Chrome 14+\n    // Opera 15+\n    // Safari 6.0+\n    return event.which === 0;\n  }\n  return false;\n}\n\nexport {\n  GrabToPan,\n};\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst CLEANUP_TIMEOUT = 30000;\n\nconst RenderingStates = {\n  INITIAL: 0,\n  RUNNING: 1,\n  PAUSED: 2,\n  FINISHED: 3,\n};\n\n/**\n * Controls rendering of the views for pages and thumbnails.\n */\nclass PDFRenderingQueue {\n  constructor() {\n    this.pdfViewer = null;\n    this.pdfThumbnailViewer = null;\n    this.onIdle = null;\n    this.highestPriorityPage = null;\n    this.idleTimeout = null;\n    this.printing = false;\n    this.isThumbnailViewEnabled = false;\n  }\n\n  /**\n   * @param {PDFViewer} pdfViewer\n   */\n  setViewer(pdfViewer) {\n    this.pdfViewer = pdfViewer;\n  }\n\n  /**\n   * @param {PDFThumbnailViewer} pdfThumbnailViewer\n   */\n  setThumbnailViewer(pdfThumbnailViewer) {\n    this.pdfThumbnailViewer = pdfThumbnailViewer;\n  }\n\n  /**\n   * @param {IRenderableView} view\n   * @returns {boolean}\n   */\n  isHighestPriority(view) {\n    return this.highestPriorityPage === view.renderingId;\n  }\n\n  /**\n   * @param {Object} currentlyVisiblePages\n   */\n  renderHighestPriority(currentlyVisiblePages) {\n    if (this.idleTimeout) {\n      clearTimeout(this.idleTimeout);\n      this.idleTimeout = null;\n    }\n\n    // Pages have a higher priority than thumbnails, so check them first.\n    if (this.pdfViewer.forceRendering(currentlyVisiblePages)) {\n      return;\n    }\n    // No pages needed rendering, so check thumbnails.\n    if (this.pdfThumbnailViewer && this.isThumbnailViewEnabled) {\n      if (this.pdfThumbnailViewer.forceRendering()) {\n        return;\n      }\n    }\n\n    if (this.printing) {\n      // If printing is currently ongoing do not reschedule cleanup.\n      return;\n    }\n\n    if (this.onIdle) {\n      this.idleTimeout = setTimeout(this.onIdle.bind(this), CLEANUP_TIMEOUT);\n    }\n  }\n\n  /**\n   * @param {Object} visible\n   * @param {Array} views\n   * @param {boolean} scrolledDown\n   */\n  getHighestPriority(visible, views, scrolledDown) {\n    /**\n     * The state has changed. Figure out which page has the highest priority to\n     * render next (if any).\n     *\n     * Priority:\n     * 1. visible pages\n     * 2. if last scrolled down, the page after the visible pages, or\n     *    if last scrolled up, the page before the visible pages\n     */\n    let visibleViews = visible.views;\n\n    let numVisible = visibleViews.length;\n    if (numVisible === 0) {\n      return null;\n    }\n    for (let i = 0; i < numVisible; ++i) {\n      let view = visibleViews[i].view;\n      if (!this.isViewFinished(view)) {\n        return view;\n      }\n    }\n\n    // All the visible views have rendered; try to render next/previous pages.\n    if (scrolledDown) {\n      let nextPageIndex = visible.last.id;\n      // IDs start at 1, so no need to add 1.\n      if (views[nextPageIndex] && !this.isViewFinished(views[nextPageIndex])) {\n        return views[nextPageIndex];\n      }\n    } else {\n      let previousPageIndex = visible.first.id - 2;\n      if (views[previousPageIndex] &&\n          !this.isViewFinished(views[previousPageIndex])) {\n        return views[previousPageIndex];\n      }\n    }\n    // Everything that needs to be rendered has been.\n    return null;\n  }\n\n  /**\n   * @param {IRenderableView} view\n   * @returns {boolean}\n   */\n  isViewFinished(view) {\n    return view.renderingState === RenderingStates.FINISHED;\n  }\n\n  /**\n   * Render a page or thumbnail view. This calls the appropriate function\n   * based on the views state. If the view is already rendered it will return\n   * `false`.\n   *\n   * @param {IRenderableView} view\n   */\n  renderView(view) {\n    switch (view.renderingState) {\n      case RenderingStates.FINISHED:\n        return false;\n      case RenderingStates.PAUSED:\n        this.highestPriorityPage = view.renderingId;\n        view.resume();\n        break;\n      case RenderingStates.RUNNING:\n        this.highestPriorityPage = view.renderingId;\n        break;\n      case RenderingStates.INITIAL:\n        this.highestPriorityPage = view.renderingId;\n        view.draw().finally(() => {\n          this.renderHighestPriority();\n        });\n        break;\n    }\n    return true;\n  }\n}\n\nexport {\n  RenderingStates,\n  PDFRenderingQueue,\n};\n","/* Copyright 2016 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { NullL10n } from './ui_utils';\nimport { RenderingStates } from './pdf_rendering_queue';\n\nconst UI_NOTIFICATION_CLASS = 'pdfSidebarNotification';\n\nconst SidebarView = {\n  UNKNOWN: -1,\n  NONE: 0,\n  THUMBS: 1, // Default value.\n  OUTLINE: 2,\n  ATTACHMENTS: 3,\n  LAYERS: 4,\n};\n\n/**\n * @typedef {Object} PDFSidebarOptions\n * @property {PDFSidebarElements} elements - The DOM elements.\n * @property {PDFViewer} pdfViewer - The document viewer.\n * @property {PDFThumbnailViewer} pdfThumbnailViewer - The thumbnail viewer.\n * @property {EventBus} eventBus - The application event bus.\n * @property {IL10n} l10n - The localization service.\n * @property {boolean} disableNotification - (optional) Disable the notification\n *   for documents containing outline/attachments. The default value is `false`.\n */\n\n/**\n * @typedef {Object} PDFSidebarElements\n * @property {HTMLDivElement} outerContainer - The outer container\n *   (encasing both the viewer and sidebar elements).\n * @property {HTMLDivElement} viewerContainer - The viewer container\n *   (in which the viewer element is placed).\n * @property {HTMLButtonElement} toggleButton - The button used for\n *   opening/closing the sidebar.\n * @property {HTMLButtonElement} thumbnailButton - The button used to show\n *   the thumbnail view.\n * @property {HTMLButtonElement} outlineButton - The button used to show\n *   the outline view.\n * @property {HTMLButtonElement} attachmentsButton - The button used to show\n *   the attachments view.\n * @property {HTMLDivElement} thumbnailView - The container in which\n *   the thumbnails are placed.\n * @property {HTMLDivElement} outlineView - The container in which\n *   the outline is placed.\n * @property {HTMLDivElement} attachmentsView - The container in which\n *   the attachments are placed.\n */\n\nclass PDFSidebar {\n  /**\n   * @param {PDFSidebarOptions} options\n   */\n  constructor({ elements, pdfViewer, pdfThumbnailViewer, eventBus,\n                l10n = NullL10n, disableNotification = false, }) {\n    this.isOpen = false;\n    this.active = SidebarView.THUMBS;\n    this.isInitialViewSet = false;\n\n    /**\n     * Callback used when the sidebar has been opened/closed, to ensure that\n     * the viewers (PDFViewer/PDFThumbnailViewer) are updated correctly.\n     */\n    this.onToggled = null;\n\n    this.pdfViewer = pdfViewer;\n    this.pdfThumbnailViewer = pdfThumbnailViewer;\n\n    this.outerContainer = elements.outerContainer;\n    this.viewerContainer = elements.viewerContainer;\n    this.toggleButton = elements.toggleButton;\n\n    this.thumbnailButton = elements.thumbnailButton;\n    this.outlineButton = elements.outlineButton;\n    this.attachmentsButton = elements.attachmentsButton;\n\n    this.thumbnailView = elements.thumbnailView;\n    this.outlineView = elements.outlineView;\n    this.attachmentsView = elements.attachmentsView;\n\n    this.eventBus = eventBus;\n    this.l10n = l10n;\n    this._disableNotification = disableNotification;\n\n    this._addEventListeners();\n  }\n\n  reset() {\n    this.isInitialViewSet = false;\n\n    this._hideUINotification(null);\n    this.switchView(SidebarView.THUMBS);\n\n    this.outlineButton.disabled = false;\n    this.attachmentsButton.disabled = false;\n  }\n\n  /**\n   * @returns {number} One of the values in {SidebarView}.\n   */\n  get visibleView() {\n    return (this.isOpen ? this.active : SidebarView.NONE);\n  }\n\n  get isThumbnailViewVisible() {\n    return (this.isOpen && this.active === SidebarView.THUMBS);\n  }\n\n  get isOutlineViewVisible() {\n    return (this.isOpen && this.active === SidebarView.OUTLINE);\n  }\n\n  get isAttachmentsViewVisible() {\n    return (this.isOpen && this.active === SidebarView.ATTACHMENTS);\n  }\n\n  /**\n   * @param {number} view - The sidebar view that should become visible,\n   *                        must be one of the values in {SidebarView}.\n   */\n  setInitialView(view = SidebarView.NONE) {\n    if (this.isInitialViewSet) {\n      return;\n    }\n    this.isInitialViewSet = true;\n\n    // If the user has already manually opened the sidebar, immediately closing\n    // it would be bad UX; also ignore the \"unknown\" sidebar view value.\n    if (view === SidebarView.NONE || view === SidebarView.UNKNOWN) {\n      this._dispatchEvent();\n      return;\n    }\n    // Prevent dispatching two back-to-back `sidebarviewchanged` events,\n    // since `this._switchView` dispatched the event if the view changed.\n    if (!this._switchView(view, /* forceOpen */ true)) {\n      this._dispatchEvent();\n    }\n  }\n\n  /**\n   * @param {number} view - The sidebar view that should be switched to,\n   *                        must be one of the values in {SidebarView}.\n   * @param {boolean} forceOpen - (optional) Ensure that the sidebar is open.\n   *                              The default value is `false`.\n   */\n  switchView(view, forceOpen = false) {\n    this._switchView(view, forceOpen);\n  }\n\n  /**\n   * @returns {boolean} Indicating if `this._dispatchEvent` was called.\n   * @private\n   */\n  _switchView(view, forceOpen = false) {\n    const isViewChanged = (view !== this.active);\n    let shouldForceRendering = false;\n\n    switch (view) {\n      case SidebarView.NONE:\n        if (this.isOpen) {\n          this.close();\n          return true; // Closing will trigger rendering and dispatch the event.\n        }\n        return false;\n      case SidebarView.THUMBS:\n        if (this.isOpen && isViewChanged) {\n          shouldForceRendering = true;\n        }\n        break;\n      case SidebarView.OUTLINE:\n        if (this.outlineButton.disabled) {\n          return false;\n        }\n        break;\n      case SidebarView.ATTACHMENTS:\n        if (this.attachmentsButton.disabled) {\n          return false;\n        }\n        break;\n      default:\n        console.error(`PDFSidebar._switchView: \"${view}\" is not a valid view.`);\n        return false;\n    }\n    // Update the active view *after* it has been validated above,\n    // in order to prevent setting it to an invalid state.\n    this.active = view;\n\n    // Update the CSS classes, for all buttons...\n    this.thumbnailButton.classList.toggle('toggled',\n      view === SidebarView.THUMBS);\n    this.outlineButton.classList.toggle('toggled',\n      view === SidebarView.OUTLINE);\n    this.attachmentsButton.classList.toggle('toggled',\n      view === SidebarView.ATTACHMENTS);\n    // ... and for all views.\n    this.thumbnailView.classList.toggle('hidden', view !== SidebarView.THUMBS);\n    this.outlineView.classList.toggle('hidden', view !== SidebarView.OUTLINE);\n    this.attachmentsView.classList.toggle('hidden',\n      view !== SidebarView.ATTACHMENTS);\n\n    if (forceOpen && !this.isOpen) {\n      this.open();\n      return true; // Opening will trigger rendering and dispatch the event.\n    }\n    if (shouldForceRendering) {\n      this._updateThumbnailViewer();\n      this._forceRendering();\n    }\n    if (isViewChanged) {\n      this._dispatchEvent();\n    }\n    this._hideUINotification(this.active);\n    return isViewChanged;\n  }\n\n  open() {\n    if (this.isOpen) {\n      return;\n    }\n    this.isOpen = true;\n    this.toggleButton.classList.add('toggled');\n\n    this.outerContainer.classList.add('sidebarMoving', 'sidebarOpen');\n\n    if (this.active === SidebarView.THUMBS) {\n      this._updateThumbnailViewer();\n    }\n    this._forceRendering();\n    this._dispatchEvent();\n\n    this._hideUINotification(this.active);\n  }\n\n  close() {\n    if (!this.isOpen) {\n      return;\n    }\n    this.isOpen = false;\n    this.toggleButton.classList.remove('toggled');\n\n    this.outerContainer.classList.add('sidebarMoving');\n    this.outerContainer.classList.remove('sidebarOpen');\n\n    this._forceRendering();\n    this._dispatchEvent();\n  }\n\n  toggle() {\n    if (this.isOpen) {\n      this.close();\n    } else {\n      this.open();\n    }\n  }\n\n  /**\n   * @private\n   */\n  _dispatchEvent() {\n    this.eventBus.dispatch('sidebarviewchanged', {\n      source: this,\n      view: this.visibleView,\n    });\n  }\n\n  /**\n   * @private\n   */\n  _forceRendering() {\n    if (this.onToggled) {\n      this.onToggled();\n    } else { // Fallback\n      this.pdfViewer.forceRendering();\n      this.pdfThumbnailViewer.forceRendering();\n    }\n  }\n\n  /**\n   * @private\n   */\n  _updateThumbnailViewer() {\n    let { pdfViewer, pdfThumbnailViewer, } = this;\n\n    // Use the rendered pages to set the corresponding thumbnail images.\n    let pagesCount = pdfViewer.pagesCount;\n    for (let pageIndex = 0; pageIndex < pagesCount; pageIndex++) {\n      let pageView = pdfViewer.getPageView(pageIndex);\n      if (pageView && pageView.renderingState === RenderingStates.FINISHED) {\n        let thumbnailView = pdfThumbnailViewer.getThumbnail(pageIndex);\n        thumbnailView.setImage(pageView);\n      }\n    }\n    pdfThumbnailViewer.scrollThumbnailIntoView(pdfViewer.currentPageNumber);\n  }\n\n  /**\n   * @private\n   */\n  _showUINotification(view) {\n    if (this._disableNotification) {\n      return;\n    }\n\n    this.l10n.get('toggle_sidebar_notification.title', null,\n                  'Toggle Sidebar (document contains outline/attachments)').\n        then((msg) => {\n      this.toggleButton.title = msg;\n    });\n\n    if (!this.isOpen) {\n      // Only show the notification on the `toggleButton` if the sidebar is\n      // currently closed, to avoid unnecessarily bothering the user.\n      this.toggleButton.classList.add(UI_NOTIFICATION_CLASS);\n    } else if (view === this.active) {\n      // If the sidebar is currently open *and* the `view` is visible, do not\n      // bother the user with a notification on the corresponding button.\n      return;\n    }\n\n    switch (view) {\n      case SidebarView.OUTLINE:\n        this.outlineButton.classList.add(UI_NOTIFICATION_CLASS);\n        break;\n      case SidebarView.ATTACHMENTS:\n        this.attachmentsButton.classList.add(UI_NOTIFICATION_CLASS);\n        break;\n    }\n  }\n\n  /**\n   * @private\n   */\n  _hideUINotification(view) {\n    if (this._disableNotification) {\n      return;\n    }\n\n    let removeNotification = (view) => {\n      switch (view) {\n        case SidebarView.OUTLINE:\n          this.outlineButton.classList.remove(UI_NOTIFICATION_CLASS);\n          break;\n        case SidebarView.ATTACHMENTS:\n          this.attachmentsButton.classList.remove(UI_NOTIFICATION_CLASS);\n          break;\n      }\n    };\n\n    if (!this.isOpen && view !== null) {\n      // Only hide the notifications when the sidebar is currently open,\n      // or when it is being reset (i.e. `view === null`).\n      return;\n    }\n    this.toggleButton.classList.remove(UI_NOTIFICATION_CLASS);\n\n    if (view !== null) {\n      removeNotification(view);\n      return;\n    }\n    for (view in SidebarView) { // Remove all sidebar notifications on reset.\n      removeNotification(SidebarView[view]);\n    }\n\n    this.l10n.get('toggle_sidebar.title', null, 'Toggle Sidebar').\n        then((msg) => {\n      this.toggleButton.title = msg;\n    });\n  }\n\n  /**\n   * @private\n   */\n  _addEventListeners() {\n    this.viewerContainer.addEventListener('transitionend', (evt) => {\n      if (evt.target === this.viewerContainer) {\n        this.outerContainer.classList.remove('sidebarMoving');\n      }\n    });\n\n    this.toggleButton.addEventListener('click', () => {\n      this.toggle();\n    });\n\n    // Buttons for switching views.\n    this.thumbnailButton.addEventListener('click', () => {\n      this.switchView(SidebarView.THUMBS);\n    });\n\n    this.outlineButton.addEventListener('click', () => {\n      this.switchView(SidebarView.OUTLINE);\n    });\n    this.outlineButton.addEventListener('dblclick', () => {\n      this.eventBus.dispatch('toggleoutlinetree', { source: this, });\n    });\n\n    this.attachmentsButton.addEventListener('click', () => {\n      this.switchView(SidebarView.ATTACHMENTS);\n    });\n\n    // Disable/enable views.\n    this.eventBus.on('outlineloaded', (evt) => {\n      let outlineCount = evt.outlineCount;\n\n      this.outlineButton.disabled = !outlineCount;\n\n      if (outlineCount) {\n        this._showUINotification(SidebarView.OUTLINE);\n      } else if (this.active === SidebarView.OUTLINE) {\n        // If the outline view was opened during document load, switch away\n        // from it if it turns out that the document has no outline.\n        this.switchView(SidebarView.THUMBS);\n      }\n    });\n\n    this.eventBus.on('attachmentsloaded', (evt) => {\n      if (evt.attachmentsCount) {\n        this.attachmentsButton.disabled = false;\n\n        this._showUINotification(SidebarView.ATTACHMENTS);\n        return;\n      }\n\n      // Attempt to avoid temporarily disabling, and switching away from, the\n      // attachment view for documents that do not contain proper attachments\n      // but *only* FileAttachment annotations. Hence we defer those operations\n      // slightly to allow time for parsing any FileAttachment annotations that\n      // may be present on the *initially* rendered page of the document.\n      Promise.resolve().then(() => {\n        if (this.attachmentsView.hasChildNodes()) {\n          // FileAttachment annotations were appended to the attachment view.\n          return;\n        }\n        this.attachmentsButton.disabled = true;\n\n        if (this.active === SidebarView.ATTACHMENTS) {\n          // If the attachment view was opened during document load, switch away\n          // from it if it turns out that the document has no attachments.\n          this.switchView(SidebarView.THUMBS);\n        }\n      });\n    });\n\n    // Update the thumbnailViewer, if visible, when exiting presentation mode.\n    this.eventBus.on('presentationmodechanged', (evt) => {\n      if (!evt.active && !evt.switchInProgress && this.isThumbnailViewVisible) {\n        this._updateThumbnailViewer();\n      }\n    });\n  }\n}\n\nexport {\n  SidebarView,\n  PDFSidebar,\n};\n","/* Copyright 2014 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nclass OverlayManager {\n  constructor() {\n    this._overlays = {};\n    this._active = null;\n    this._keyDownBound = this._keyDown.bind(this);\n  }\n\n  get active() {\n    return this._active;\n  }\n\n  /**\n   * @param {string} name - The name of the overlay that is registered.\n   * @param {HTMLDivElement} element - The overlay's DOM element.\n   * @param {function} callerCloseMethod - (optional) The method that, if\n   *                   present, calls `OverlayManager.close` from the object\n   *                   registering the overlay. Access to this method is\n   *                   necessary in order to run cleanup code when e.g.\n   *                   the overlay is force closed. The default is `null`.\n   * @param {boolean} canForceClose - (optional) Indicates if opening the\n   *                  overlay closes an active overlay. The default is `false`.\n   * @returns {Promise} A promise that is resolved when the overlay has been\n   *                    registered.\n   */\n  async register(name, element, callerCloseMethod = null,\n                 canForceClose = false) {\n    let container;\n    if (!name || !element || !(container = element.parentNode)) {\n      throw new Error('Not enough parameters.');\n    } else if (this._overlays[name]) {\n      throw new Error('The overlay is already registered.');\n    }\n    this._overlays[name] = {\n      element,\n      container,\n      callerCloseMethod,\n      canForceClose,\n    };\n  }\n\n  /**\n   * @param {string} name - The name of the overlay that is unregistered.\n   * @returns {Promise} A promise that is resolved when the overlay has been\n   *                    unregistered.\n   */\n  async unregister(name) {\n    if (!this._overlays[name]) {\n      throw new Error('The overlay does not exist.');\n    } else if (this._active === name) {\n      throw new Error('The overlay cannot be removed while it is active.');\n    }\n    delete this._overlays[name];\n  }\n\n  /**\n   * @param {string} name - The name of the overlay that should be opened.\n   * @returns {Promise} A promise that is resolved when the overlay has been\n   *                    opened.\n   */\n  async open(name) {\n    if (!this._overlays[name]) {\n      throw new Error('The overlay does not exist.');\n    } else if (this._active) {\n      if (this._overlays[name].canForceClose) {\n        this._closeThroughCaller();\n      } else if (this._active === name) {\n        throw new Error('The overlay is already active.');\n      } else {\n        throw new Error('Another overlay is currently active.');\n      }\n    }\n    this._active = name;\n    this._overlays[this._active].element.classList.remove('hidden');\n    this._overlays[this._active].container.classList.remove('hidden');\n\n    window.addEventListener('keydown', this._keyDownBound);\n  }\n\n  /**\n   * @param {string} name - The name of the overlay that should be closed.\n   * @returns {Promise} A promise that is resolved when the overlay has been\n   *                    closed.\n   */\n  async close(name) {\n    if (!this._overlays[name]) {\n      throw new Error('The overlay does not exist.');\n    } else if (!this._active) {\n      throw new Error('The overlay is currently not active.');\n    } else if (this._active !== name) {\n      throw new Error('Another overlay is currently active.');\n    }\n    this._overlays[this._active].container.classList.add('hidden');\n    this._overlays[this._active].element.classList.add('hidden');\n    this._active = null;\n\n    window.removeEventListener('keydown', this._keyDownBound);\n  }\n\n  /**\n   * @private\n   */\n  _keyDown(evt) {\n    if (this._active && evt.keyCode === 27) { // Esc key.\n      this._closeThroughCaller();\n      evt.preventDefault();\n    }\n  }\n\n  /**\n   * @private\n   */\n  _closeThroughCaller() {\n    if (this._overlays[this._active].callerCloseMethod) {\n      this._overlays[this._active].callerCloseMethod();\n    }\n    if (this._active) {\n      this.close(this._active);\n    }\n  }\n}\n\nexport {\n  OverlayManager,\n};\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { NullL10n } from './ui_utils';\nimport { PasswordResponses } from 'pdfjs-lib';\n\n/**\n * @typedef {Object} PasswordPromptOptions\n * @property {string} overlayName - Name of the overlay for the overlay manager.\n * @property {HTMLDivElement} container - Div container for the overlay.\n * @property {HTMLParagraphElement} label - Label containing instructions for\n *                                          entering the password.\n * @property {HTMLInputElement} input - Input field for entering the password.\n * @property {HTMLButtonElement} submitButton - Button for submitting the\n *                                              password.\n * @property {HTMLButtonElement} cancelButton - Button for cancelling password\n *                                              entry.\n */\n\nclass PasswordPrompt {\n  /**\n   * @param {PasswordPromptOptions} options\n   * @param {OverlayManager} overlayManager - Manager for the viewer overlays.\n   * @param {IL10n} l10n - Localization service.\n   */\n  constructor(options, overlayManager, l10n = NullL10n) {\n    this.overlayName = options.overlayName;\n    this.container = options.container;\n    this.label = options.label;\n    this.input = options.input;\n    this.submitButton = options.submitButton;\n    this.cancelButton = options.cancelButton;\n    this.overlayManager = overlayManager;\n    this.l10n = l10n;\n\n    this.updateCallback = null;\n    this.reason = null;\n\n    // Attach the event listeners.\n    this.submitButton.addEventListener('click', this.verify.bind(this));\n    this.cancelButton.addEventListener('click', this.close.bind(this));\n    this.input.addEventListener('keydown', (e) => {\n      if (e.keyCode === 13) { // Enter key\n        this.verify();\n      }\n    });\n\n    this.overlayManager.register(this.overlayName, this.container,\n                                 this.close.bind(this), true);\n  }\n\n  open() {\n    this.overlayManager.open(this.overlayName).then(() => {\n      this.input.focus();\n\n      let promptString;\n      if (this.reason === PasswordResponses.INCORRECT_PASSWORD) {\n        promptString = this.l10n.get('password_invalid', null,\n          'Invalid password. Please try again.');\n      } else {\n        promptString = this.l10n.get('password_label', null,\n          'Enter the password to open this PDF file.');\n      }\n\n      promptString.then((msg) => {\n        this.label.textContent = msg;\n      });\n    });\n  }\n\n  close() {\n    this.overlayManager.close(this.overlayName).then(() => {\n      this.input.value = '';\n    });\n  }\n\n  verify() {\n    let password = this.input.value;\n    if (password && password.length > 0) {\n      this.close();\n      this.updateCallback(password);\n    }\n  }\n\n  setUpdateCallback(updateCallback, reason) {\n    this.updateCallback = updateCallback;\n    this.reason = reason;\n  }\n}\n\nexport {\n  PasswordPrompt,\n};\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  createObjectURL, createPromiseCapability, getFilenameFromUrl,\n  removeNullCharacters\n} from 'pdfjs-lib';\n\n/**\n * @typedef {Object} PDFAttachmentViewerOptions\n * @property {HTMLDivElement} container - The viewer element.\n * @property {EventBus} eventBus - The application event bus.\n * @property {DownloadManager} downloadManager - The download manager.\n */\n\n/**\n * @typedef {Object} PDFAttachmentViewerRenderParameters\n * @property {Object|null} attachments - A lookup table of attachment objects.\n */\n\nclass PDFAttachmentViewer {\n  /**\n   * @param {PDFAttachmentViewerOptions} options\n   */\n  constructor({ container, eventBus, downloadManager, }) {\n    this.container = container;\n    this.eventBus = eventBus;\n    this.downloadManager = downloadManager;\n\n    this.reset();\n\n    this.eventBus.on('fileattachmentannotation',\n      this._appendAttachment.bind(this));\n  }\n\n  reset(keepRenderedCapability = false) {\n    this.attachments = null;\n\n    // Remove the attachments from the DOM.\n    this.container.textContent = '';\n\n    if (!keepRenderedCapability) {\n      // NOTE: The *only* situation in which the `_renderedCapability` should\n      //       not be replaced is when appending file attachment annotations.\n      this._renderedCapability = createPromiseCapability();\n    }\n  }\n\n  /**\n   * @private\n   */\n  _dispatchEvent(attachmentsCount) {\n    this._renderedCapability.resolve();\n\n    this.eventBus.dispatch('attachmentsloaded', {\n      source: this,\n      attachmentsCount,\n    });\n  }\n\n  /**\n   * @private\n   */\n  _bindPdfLink(button, content, filename) {\n    if (this.downloadManager.disableCreateObjectURL) {\n      throw new Error(\n        'bindPdfLink: Unsupported \"disableCreateObjectURL\" value.');\n    }\n    let blobUrl;\n    button.onclick = function() {\n      if (!blobUrl) {\n        blobUrl = createObjectURL(content, 'application/pdf');\n      }\n      let viewerUrl;\n      if (typeof PDFJSDev === 'undefined' || PDFJSDev.test('GENERIC')) {\n        // The current URL is the viewer, let's use it and append the file.\n        viewerUrl = '?file=' + encodeURIComponent(blobUrl + '#' + filename);\n      } else if (PDFJSDev.test('CHROME')) {\n        // In the Chrome extension, the URL is rewritten using the history API\n        // in viewer.js, so an absolute URL must be generated.\n        // eslint-disable-next-line no-undef\n        viewerUrl = chrome.runtime.getURL('/content/web/viewer.html') +\n          '?file=' + encodeURIComponent(blobUrl + '#' + filename);\n      } else if (PDFJSDev.test('FIREFOX || MOZCENTRAL')) {\n        // Let Firefox's content handler catch the URL and display the PDF.\n        viewerUrl = blobUrl + '?' + encodeURIComponent(filename);\n      }\n      window.open(viewerUrl);\n      return false;\n    };\n  }\n\n  /**\n   * @private\n   */\n  _bindLink(button, content, filename) {\n    button.onclick = () => {\n      this.downloadManager.downloadData(content, filename, '');\n      return false;\n    };\n  }\n\n  /**\n   * @param {PDFAttachmentViewerRenderParameters} params\n   */\n  render({ attachments, keepRenderedCapability = false, }) {\n    let attachmentsCount = 0;\n\n    if (this.attachments) {\n      this.reset(keepRenderedCapability === true);\n    }\n    this.attachments = attachments || null;\n\n    if (!attachments) {\n      this._dispatchEvent(attachmentsCount);\n      return;\n    }\n\n    let names = Object.keys(attachments).sort(function(a, b) {\n      return a.toLowerCase().localeCompare(b.toLowerCase());\n    });\n    attachmentsCount = names.length;\n\n    for (let i = 0; i < attachmentsCount; i++) {\n      let item = attachments[names[i]];\n      let filename = removeNullCharacters(getFilenameFromUrl(item.filename));\n\n      let div = document.createElement('div');\n      div.className = 'attachmentsItem';\n      let button = document.createElement('button');\n      button.textContent = filename;\n      if (/\\.pdf$/i.test(filename) &&\n          !this.downloadManager.disableCreateObjectURL) {\n        this._bindPdfLink(button, item.content, filename);\n      } else {\n        this._bindLink(button, item.content, filename);\n      }\n\n      div.appendChild(button);\n      this.container.appendChild(div);\n    }\n\n    this._dispatchEvent(attachmentsCount);\n  }\n\n  /**\n   * Used to append FileAttachment annotations to the sidebar.\n   * @private\n   */\n  _appendAttachment({ id, filename, content, }) {\n    this._renderedCapability.promise.then(() => {\n      let attachments = this.attachments;\n\n      if (!attachments) {\n        attachments = Object.create(null);\n      } else {\n        for (let name in attachments) {\n          if (id === name) {\n            return; // Ignore the new attachment if it already exists.\n          }\n        }\n      }\n      attachments[id] = {\n        filename,\n        content,\n      };\n      this.render({\n        attachments,\n        keepRenderedCapability: true,\n      });\n    });\n  }\n}\n\nexport {\n  PDFAttachmentViewer,\n};\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createPromiseCapability, PDFDateString } from 'pdfjs-lib';\nimport {\n  getPageSizeInches, getPDFFileNameFromURL, isPortraitOrientation, NullL10n\n} from './ui_utils';\n\nconst DEFAULT_FIELD_CONTENT = '-';\n\n// See https://en.wikibooks.org/wiki/Lentis/Conversion_to_the_Metric_Standard_in_the_United_States\nconst NON_METRIC_LOCALES = ['en-us', 'en-lr', 'my'];\n\n// Should use the format: `width x height`, in portrait orientation.\n// See https://en.wikipedia.org/wiki/Paper_size\nconst US_PAGE_NAMES = {\n  '8.5x11': 'Letter',\n  '8.5x14': 'Legal',\n};\nconst METRIC_PAGE_NAMES = {\n  '297x420': 'A3',\n  '210x297': 'A4',\n};\n\nfunction getPageName(size, isPortrait, pageNames) {\n  const width = (isPortrait ? size.width : size.height);\n  const height = (isPortrait ? size.height : size.width);\n\n  return pageNames[`${width}x${height}`];\n}\n\n/**\n * @typedef {Object} PDFDocumentPropertiesOptions\n * @property {string} overlayName - Name/identifier for the overlay.\n * @property {Object} fields - Names and elements of the overlay's fields.\n * @property {HTMLDivElement} container - Div container for the overlay.\n * @property {HTMLButtonElement} closeButton - Button for closing the overlay.\n */\n\nclass PDFDocumentProperties {\n  /**\n   * @param {PDFDocumentPropertiesOptions} options\n   * @param {OverlayManager} overlayManager - Manager for the viewer overlays.\n   * @param {EventBus} eventBus - The application event bus.\n   * @param {IL10n} l10n - Localization service.\n   */\n  constructor({ overlayName, fields, container, closeButton, },\n              overlayManager, eventBus, l10n = NullL10n) {\n    this.overlayName = overlayName;\n    this.fields = fields;\n    this.container = container;\n    this.overlayManager = overlayManager;\n    this.l10n = l10n;\n\n    this._reset();\n\n    if (closeButton) { // Bind the event listener for the Close button.\n      closeButton.addEventListener('click', this.close.bind(this));\n    }\n    this.overlayManager.register(this.overlayName, this.container,\n                                 this.close.bind(this));\n\n    if (eventBus) {\n      eventBus.on('pagechanging', (evt) => {\n        this._currentPageNumber = evt.pageNumber;\n      });\n      eventBus.on('rotationchanging', (evt) => {\n        this._pagesRotation = evt.pagesRotation;\n      });\n    }\n\n    this._isNonMetricLocale = true; // The default viewer locale is 'en-us'.\n    l10n.getLanguage().then((locale) => {\n      this._isNonMetricLocale = NON_METRIC_LOCALES.includes(locale);\n    });\n  }\n\n  /**\n   * Open the document properties overlay.\n   */\n  open() {\n    let freezeFieldData = (data) => {\n      Object.defineProperty(this, 'fieldData', {\n        value: Object.freeze(data),\n        writable: false,\n        enumerable: true,\n        configurable: true,\n      });\n    };\n\n    Promise.all([this.overlayManager.open(this.overlayName),\n                 this._dataAvailableCapability.promise]).then(() => {\n      const currentPageNumber = this._currentPageNumber;\n      const pagesRotation = this._pagesRotation;\n\n      // If the document properties were previously fetched (for this PDF file),\n      // just update the dialog immediately to avoid redundant lookups.\n      if (this.fieldData &&\n          currentPageNumber === this.fieldData['_currentPageNumber'] &&\n          pagesRotation === this.fieldData['_pagesRotation']) {\n        this._updateUI();\n        return;\n      }\n\n      // Get the document properties.\n      this.pdfDocument.getMetadata().then(\n          ({ info, metadata, contentDispositionFilename, }) => {\n        return Promise.all([\n          info,\n          metadata,\n          contentDispositionFilename || getPDFFileNameFromURL(this.url || ''),\n          this._parseFileSize(this.maybeFileSize),\n          this._parseDate(info.CreationDate),\n          this._parseDate(info.ModDate),\n          this.pdfDocument.getPage(currentPageNumber).then((pdfPage) => {\n            return this._parsePageSize(getPageSizeInches(pdfPage),\n                                       pagesRotation);\n          }),\n          this._parseLinearization(info.IsLinearized),\n        ]);\n      }).then(([info, metadata, fileName, fileSize, creationDate, modDate,\n                pageSize, isLinearized]) => {\n        freezeFieldData({\n          'fileName': fileName,\n          'fileSize': fileSize,\n          'title': info.Title,\n          'author': info.Author,\n          'subject': info.Subject,\n          'keywords': info.Keywords,\n          'creationDate': creationDate,\n          'modificationDate': modDate,\n          'creator': info.Creator,\n          'producer': info.Producer,\n          'version': info.PDFFormatVersion,\n          'pageCount': this.pdfDocument.numPages,\n          'pageSize': pageSize,\n          'linearized': isLinearized,\n          '_currentPageNumber': currentPageNumber,\n          '_pagesRotation': pagesRotation,\n        });\n        this._updateUI();\n\n        // Get the correct fileSize, since it may not have been set (if\n        // `this.setFileSize` wasn't called) or may be incorrectly set.\n        return this.pdfDocument.getDownloadInfo();\n      }).then(({ length, }) => {\n        this.maybeFileSize = length;\n        return this._parseFileSize(length);\n      }).then((fileSize) => {\n        if (fileSize === this.fieldData['fileSize']) {\n          return; // The fileSize has already been correctly set.\n        }\n        let data = Object.assign(Object.create(null), this.fieldData);\n        data['fileSize'] = fileSize;\n\n        freezeFieldData(data);\n        this._updateUI();\n      });\n    });\n  }\n\n  /**\n   * Close the document properties overlay.\n   */\n  close() {\n    this.overlayManager.close(this.overlayName);\n  }\n\n  /**\n   * Set a reference to the PDF document and the URL in order\n   * to populate the overlay fields with the document properties.\n   * Note that the overlay will contain no information if this method\n   * is not called.\n   *\n   * @param {PDFDocumentProxy} pdfDocument - A reference to the PDF document.\n   * @param {string} url - The URL of the document.\n   */\n  setDocument(pdfDocument, url = null) {\n    if (this.pdfDocument) {\n      this._reset();\n      this._updateUI(true);\n    }\n    if (!pdfDocument) {\n      return;\n    }\n    this.pdfDocument = pdfDocument;\n    this.url = url;\n\n    this._dataAvailableCapability.resolve();\n  }\n\n  /**\n   * Set the file size of the PDF document. This method is used to\n   * update the file size in the document properties overlay once it\n   * is known so we do not have to wait until the entire file is loaded.\n   *\n   * @param {number} fileSize - The file size of the PDF document.\n   */\n  setFileSize(fileSize) {\n    if (Number.isInteger(fileSize) && fileSize > 0) {\n      this.maybeFileSize = fileSize;\n    }\n  }\n\n  /**\n   * @private\n   */\n  _reset() {\n    this.pdfDocument = null;\n    this.url = null;\n\n    this.maybeFileSize = 0;\n    delete this.fieldData;\n    this._dataAvailableCapability = createPromiseCapability();\n    this._currentPageNumber = 1;\n    this._pagesRotation = 0;\n  }\n\n  /**\n   * Always updates all of the dialog fields, to prevent inconsistent UI state.\n   * NOTE: If the contents of a particular field is neither a non-empty string,\n   *       nor a number, it will fall back to `DEFAULT_FIELD_CONTENT`.\n   * @private\n   */\n  _updateUI(reset = false) {\n    if (reset || !this.fieldData) {\n      for (let id in this.fields) {\n        this.fields[id].textContent = DEFAULT_FIELD_CONTENT;\n      }\n      return;\n    }\n    if (this.overlayManager.active !== this.overlayName) {\n      // Don't bother updating the dialog if has already been closed,\n      // since it will be updated the next time `this.open` is called.\n      return;\n    }\n    for (let id in this.fields) {\n      let content = this.fieldData[id];\n      this.fields[id].textContent = (content || content === 0) ?\n                                    content : DEFAULT_FIELD_CONTENT;\n    }\n  }\n\n  /**\n   * @private\n   */\n  async _parseFileSize(fileSize = 0) {\n    let kb = fileSize / 1024;\n    if (!kb) {\n      return undefined;\n    } else if (kb < 1024) {\n      return this.l10n.get('document_properties_kb', {\n        size_kb: (+kb.toPrecision(3)).toLocaleString(),\n        size_b: fileSize.toLocaleString(),\n      }, '{{size_kb}} KB ({{size_b}} bytes)');\n    }\n    return this.l10n.get('document_properties_mb', {\n      size_mb: (+(kb / 1024).toPrecision(3)).toLocaleString(),\n      size_b: fileSize.toLocaleString(),\n    }, '{{size_mb}} MB ({{size_b}} bytes)');\n  }\n\n  /**\n   * @private\n   */\n  async _parsePageSize(pageSizeInches, pagesRotation) {\n    if (!pageSizeInches) {\n      return undefined;\n    }\n    // Take the viewer rotation into account as well; compare with Adobe Reader.\n    if (pagesRotation % 180 !== 0) {\n      pageSizeInches = {\n        width: pageSizeInches.height,\n        height: pageSizeInches.width,\n      };\n    }\n    const isPortrait = isPortraitOrientation(pageSizeInches);\n\n    let sizeInches = {\n      width: Math.round(pageSizeInches.width * 100) / 100,\n      height: Math.round(pageSizeInches.height * 100) / 100,\n    };\n    // 1in == 25.4mm; no need to round to 2 decimals for millimeters.\n    let sizeMillimeters = {\n      width: Math.round(pageSizeInches.width * 25.4 * 10) / 10,\n      height: Math.round(pageSizeInches.height * 25.4 * 10) / 10,\n    };\n\n    let pageName = null;\n    let name = getPageName(sizeInches, isPortrait, US_PAGE_NAMES) ||\n               getPageName(sizeMillimeters, isPortrait, METRIC_PAGE_NAMES);\n\n    if (!name && !(Number.isInteger(sizeMillimeters.width) &&\n                   Number.isInteger(sizeMillimeters.height))) {\n      // Attempt to improve the page name detection by falling back to fuzzy\n      // matching of the metric dimensions, to account for e.g. rounding errors\n      // and/or PDF files that define the page sizes in an imprecise manner.\n      const exactMillimeters = {\n        width: pageSizeInches.width * 25.4,\n        height: pageSizeInches.height * 25.4,\n      };\n      const intMillimeters = {\n        width: Math.round(sizeMillimeters.width),\n        height: Math.round(sizeMillimeters.height),\n      };\n\n      // Try to avoid false positives, by only considering \"small\" differences.\n      if (Math.abs(exactMillimeters.width - intMillimeters.width) < 0.1 &&\n          Math.abs(exactMillimeters.height - intMillimeters.height) < 0.1) {\n\n        name = getPageName(intMillimeters, isPortrait, METRIC_PAGE_NAMES);\n        if (name) {\n          // Update *both* sizes, computed above, to ensure that the displayed\n          // dimensions always correspond to the detected page name.\n          sizeInches = {\n            width: Math.round(intMillimeters.width / 25.4 * 100) / 100,\n            height: Math.round(intMillimeters.height / 25.4 * 100) / 100,\n          };\n          sizeMillimeters = intMillimeters;\n        }\n      }\n    }\n    if (name) {\n      pageName = this.l10n.get('document_properties_page_size_name_' +\n                               name.toLowerCase(), null, name);\n    }\n\n    return Promise.all([\n      (this._isNonMetricLocale ? sizeInches : sizeMillimeters),\n      this.l10n.get('document_properties_page_size_unit_' +\n                    (this._isNonMetricLocale ? 'inches' : 'millimeters'), null,\n                    this._isNonMetricLocale ? 'in' : 'mm'),\n      pageName,\n      this.l10n.get('document_properties_page_size_orientation_' +\n                    (isPortrait ? 'portrait' : 'landscape'), null,\n                    isPortrait ? 'portrait' : 'landscape'),\n    ]).then(([{ width, height, }, unit, name, orientation]) => {\n      return this.l10n.get('document_properties_page_size_dimension_' +\n                           (name ? 'name_' : '') + 'string', {\n          width: width.toLocaleString(),\n          height: height.toLocaleString(),\n          unit,\n          name,\n          orientation,\n        }, '{{width}} × {{height}} {{unit}} (' +\n           (name ? '{{name}}, ' : '') + '{{orientation}})');\n    });\n  }\n\n  /**\n   * @private\n   */\n  async _parseDate(inputDate) {\n    const dateObject = PDFDateString.toDateObject(inputDate);\n    if (!dateObject) {\n      return undefined;\n    }\n    return this.l10n.get('document_properties_date_string', {\n        date: dateObject.toLocaleDateString(),\n        time: dateObject.toLocaleTimeString(),\n      }, '{{date}}, {{time}}');\n  }\n\n  /**\n   * @private\n   */\n  _parseLinearization(isLinearized) {\n    return this.l10n.get('document_properties_linearized_' +\n                         (isLinearized ? 'yes' : 'no'), null,\n                         (isLinearized ? 'Yes' : 'No'));\n  }\n}\n\nexport {\n  PDFDocumentProperties,\n};\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { getGlobalEventBus, NullL10n } from './ui_utils';\nimport { FindState } from './pdf_find_controller';\n\nconst MATCHES_COUNT_LIMIT = 1000;\n\n/**\n * Creates a \"search bar\" given a set of DOM elements that act as controls\n * for searching or for setting search preferences in the UI. This object\n * also sets up the appropriate events for the controls. Actual searching\n * is done by PDFFindController.\n */\nclass PDFFindBar {\n  constructor(options, eventBus = getGlobalEventBus(), l10n = NullL10n) {\n    this.opened = false;\n\n    this.bar = options.bar || null;\n    this.toggleButton = options.toggleButton || null;\n    this.findField = options.findField || null;\n    this.highlightAll = options.highlightAllCheckbox || null;\n    this.caseSensitive = options.caseSensitiveCheckbox || null;\n    this.entireWord = options.entireWordCheckbox || null;\n    this.findMsg = options.findMsg || null;\n    this.findResultsCount = options.findResultsCount || null;\n    this.findPreviousButton = options.findPreviousButton || null;\n    this.findNextButton = options.findNextButton || null;\n    this.eventBus = eventBus;\n    this.l10n = l10n;\n\n    // Add event listeners to the DOM elements.\n    this.toggleButton.addEventListener('click', () => {\n      this.toggle();\n    });\n\n    this.findField.addEventListener('input', () => {\n      this.dispatchEvent('');\n    });\n\n    this.bar.addEventListener('keydown', (e) => {\n      switch (e.keyCode) {\n        case 13: // Enter\n          if (e.target === this.findField) {\n            this.dispatchEvent('again', e.shiftKey);\n          }\n          break;\n        case 27: // Escape\n          this.close();\n          break;\n      }\n    });\n\n    this.findPreviousButton.addEventListener('click', () => {\n      this.dispatchEvent('again', true);\n    });\n\n    this.findNextButton.addEventListener('click', () => {\n      this.dispatchEvent('again', false);\n    });\n\n    this.highlightAll.addEventListener('click', () => {\n      this.dispatchEvent('highlightallchange');\n    });\n\n    this.caseSensitive.addEventListener('click', () => {\n      this.dispatchEvent('casesensitivitychange');\n    });\n\n    this.entireWord.addEventListener('click', () => {\n      this.dispatchEvent('entirewordchange');\n    });\n\n    this.eventBus.on('resize', this._adjustWidth.bind(this));\n  }\n\n  reset() {\n    this.updateUIState();\n  }\n\n  dispatchEvent(type, findPrev) {\n    this.eventBus.dispatch('find', {\n      source: this,\n      type,\n      query: this.findField.value,\n      phraseSearch: true,\n      caseSensitive: this.caseSensitive.checked,\n      entireWord: this.entireWord.checked,\n      highlightAll: this.highlightAll.checked,\n      findPrevious: findPrev,\n    });\n  }\n\n  updateUIState(state, previous, matchesCount) {\n    let notFound = false;\n    let findMsg = '';\n    let status = '';\n\n    switch (state) {\n      case FindState.FOUND:\n        break;\n\n      case FindState.PENDING:\n        status = 'pending';\n        break;\n\n      case FindState.NOT_FOUND:\n        findMsg = this.l10n.get('find_not_found', null, 'Phrase not found');\n        notFound = true;\n        break;\n\n      case FindState.WRAPPED:\n        if (previous) {\n          findMsg = this.l10n.get('find_reached_top', null,\n            'Reached top of document, continued from bottom');\n        } else {\n          findMsg = this.l10n.get('find_reached_bottom', null,\n            'Reached end of document, continued from top');\n        }\n        break;\n    }\n\n    this.findField.classList.toggle('notFound', notFound);\n    this.findField.setAttribute('data-status', status);\n\n    Promise.resolve(findMsg).then((msg) => {\n      this.findMsg.textContent = msg;\n      this._adjustWidth();\n    });\n\n    this.updateResultsCount(matchesCount);\n  }\n\n  updateResultsCount({ current = 0, total = 0, } = {}) {\n    if (!this.findResultsCount) {\n      return; // No UI control is provided.\n    }\n    let matchesCountMsg = '', limit = MATCHES_COUNT_LIMIT;\n\n    if (total > 0) {\n      if (total > limit) {\n        if (typeof PDFJSDev !== 'undefined' && PDFJSDev.test('MOZCENTRAL')) {\n          // TODO: Remove this hard-coded `[other]` form once plural support has\n          // been implemented in the mozilla-central specific `l10n.js` file.\n          matchesCountMsg = this.l10n.get('find_match_count_limit[other]', {\n            limit,\n          }, 'More than {{limit}} matches');\n        } else {\n          matchesCountMsg = this.l10n.get('find_match_count_limit', {\n            limit,\n          }, 'More than {{limit}} match' + (limit !== 1 ? 'es' : ''));\n        }\n      } else {\n        if (typeof PDFJSDev !== 'undefined' && PDFJSDev.test('MOZCENTRAL')) {\n          // TODO: Remove this hard-coded `[other]` form once plural support has\n          // been implemented in the mozilla-central specific `l10n.js` file.\n          matchesCountMsg = this.l10n.get('find_match_count[other]', {\n            current,\n            total,\n          }, '{{current}} of {{total}} matches');\n        } else {\n          matchesCountMsg = this.l10n.get('find_match_count', {\n            current,\n            total,\n          }, '{{current}} of {{total}} match' + (total !== 1 ? 'es' : ''));\n        }\n      }\n    }\n    Promise.resolve(matchesCountMsg).then((msg) => {\n      this.findResultsCount.textContent = msg;\n      this.findResultsCount.classList.toggle('hidden', !total);\n      // Since `updateResultsCount` may be called from `PDFFindController`,\n      // ensure that the width of the findbar is always updated correctly.\n      this._adjustWidth();\n    });\n  }\n\n  open() {\n    if (!this.opened) {\n      this.opened = true;\n      this.toggleButton.classList.add('toggled');\n      this.bar.classList.remove('hidden');\n    }\n    this.findField.select();\n    this.findField.focus();\n\n    this._adjustWidth();\n  }\n\n  close() {\n    if (!this.opened) {\n      return;\n    }\n    this.opened = false;\n    this.toggleButton.classList.remove('toggled');\n    this.bar.classList.add('hidden');\n\n    this.eventBus.dispatch('findbarclose', { source: this, });\n  }\n\n  toggle() {\n    if (this.opened) {\n      this.close();\n    } else {\n      this.open();\n    }\n  }\n\n  /**\n   * @private\n   */\n  _adjustWidth() {\n    if (!this.opened) {\n      return;\n    }\n\n    // The find bar has an absolute position and thus the browser extends\n    // its width to the maximum possible width once the find bar does not fit\n    // entirely within the window anymore (and its elements are automatically\n    // wrapped). Here we detect and fix that.\n    this.bar.classList.remove('wrapContainers');\n\n    let findbarHeight = this.bar.clientHeight;\n    let inputContainerHeight = this.bar.firstElementChild.clientHeight;\n\n    if (findbarHeight > inputContainerHeight) {\n      // The findbar is taller than the input container, which means that\n      // the browser wrapped some of the elements. For a consistent look,\n      // wrap all of them to adjust the width of the find bar.\n      this.bar.classList.add('wrapContainers');\n    }\n  }\n}\n\nexport {\n  PDFFindBar,\n};\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { getGlobalEventBus, scrollIntoView } from './ui_utils';\nimport { createPromiseCapability } from 'pdfjs-lib';\nimport { getCharacterType } from './pdf_find_utils';\n\nconst FindState = {\n  FOUND: 0,\n  NOT_FOUND: 1,\n  WRAPPED: 2,\n  PENDING: 3,\n};\n\nconst FIND_TIMEOUT = 250; // ms\nconst MATCH_SCROLL_OFFSET_TOP = -50; // px\nconst MATCH_SCROLL_OFFSET_LEFT = -400; // px\n\nconst CHARACTERS_TO_NORMALIZE = {\n  '\\u2018': '\\'', // Left single quotation mark\n  '\\u2019': '\\'', // Right single quotation mark\n  '\\u201A': '\\'', // Single low-9 quotation mark\n  '\\u201B': '\\'', // Single high-reversed-9 quotation mark\n  '\\u201C': '\"', // Left double quotation mark\n  '\\u201D': '\"', // Right double quotation mark\n  '\\u201E': '\"', // Double low-9 quotation mark\n  '\\u201F': '\"', // Double high-reversed-9 quotation mark\n  '\\u00BC': '1/4', // Vulgar fraction one quarter\n  '\\u00BD': '1/2', // Vulgar fraction one half\n  '\\u00BE': '3/4', // Vulgar fraction three quarters\n};\n\nlet normalizationRegex = null;\nfunction normalize(text) {\n  if (!normalizationRegex) {\n    // Compile the regular expression for text normalization once.\n    const replace = Object.keys(CHARACTERS_TO_NORMALIZE).join('');\n    normalizationRegex = new RegExp(`[${replace}]`, 'g');\n  }\n  return text.replace(normalizationRegex, function(ch) {\n    return CHARACTERS_TO_NORMALIZE[ch];\n  });\n}\n\n/**\n * @typedef {Object} PDFFindControllerOptions\n * @property {IPDFLinkService} linkService - The navigation/linking service.\n * @property {EventBus} eventBus - The application event bus.\n */\n\n/**\n * Provides search functionality to find a given string in a PDF document.\n */\nclass PDFFindController {\n  /**\n   * @param {PDFFindControllerOptions} options\n   */\n  constructor({ linkService, eventBus = getGlobalEventBus(), }) {\n    this._linkService = linkService;\n    this._eventBus = eventBus;\n\n    this._reset();\n    eventBus.on('findbarclose', this._onFindBarClose.bind(this));\n  }\n\n  get highlightMatches() {\n    return this._highlightMatches;\n  }\n\n  get pageMatches() {\n    return this._pageMatches;\n  }\n\n  get pageMatchesLength() {\n    return this._pageMatchesLength;\n  }\n\n  get selected() {\n    return this._selected;\n  }\n\n  get state() {\n    return this._state;\n  }\n\n  /**\n   * Set a reference to the PDF document in order to search it.\n   * Note that searching is not possible if this method is not called.\n   *\n   * @param {PDFDocumentProxy} pdfDocument - The PDF document to search.\n   */\n  setDocument(pdfDocument) {\n    if (this._pdfDocument) {\n      this._reset();\n    }\n    if (!pdfDocument) {\n      return;\n    }\n    this._pdfDocument = pdfDocument;\n    this._firstPageCapability.resolve();\n  }\n\n  executeCommand(cmd, state) {\n    if (!state) {\n      return;\n    }\n    const pdfDocument = this._pdfDocument;\n\n    if (this._state === null || this._shouldDirtyMatch(cmd, state)) {\n      this._dirtyMatch = true;\n    }\n    this._state = state;\n    if (cmd !== 'findhighlightallchange') {\n      this._updateUIState(FindState.PENDING);\n    }\n\n    this._firstPageCapability.promise.then(() => {\n      // If the document was closed before searching began, or if the search\n      // operation was relevant for a previously opened document, do nothing.\n      if (!this._pdfDocument ||\n          (pdfDocument && this._pdfDocument !== pdfDocument)) {\n        return;\n      }\n      this._extractText();\n\n      const findbarClosed = !this._highlightMatches;\n      const pendingTimeout = !!this._findTimeout;\n\n      if (this._findTimeout) {\n        clearTimeout(this._findTimeout);\n        this._findTimeout = null;\n      }\n      if (cmd === 'find') {\n        // Trigger the find action with a small delay to avoid starting the\n        // search when the user is still typing (saving resources).\n        this._findTimeout = setTimeout(() => {\n          this._nextMatch();\n          this._findTimeout = null;\n        }, FIND_TIMEOUT);\n      } else if (this._dirtyMatch) {\n        // Immediately trigger searching for non-'find' operations, when the\n        // current state needs to be reset and matches re-calculated.\n        this._nextMatch();\n      } else if (cmd === 'findagain') {\n        this._nextMatch();\n\n        // When the findbar was previously closed, and `highlightAll` is set,\n        // ensure that the matches on all active pages are highlighted again.\n        if (findbarClosed && this._state.highlightAll) {\n          this._updateAllPages();\n        }\n      } else if (cmd === 'findhighlightallchange') {\n        // If there was a pending search operation, synchronously trigger a new\n        // search *first* to ensure that the correct matches are highlighted.\n        if (pendingTimeout) {\n          this._nextMatch();\n        } else {\n          this._highlightMatches = true;\n        }\n        this._updateAllPages(); // Update the highlighting on all active pages.\n      } else {\n        this._nextMatch();\n      }\n    });\n  }\n\n  scrollMatchIntoView({ element = null, pageIndex = -1, matchIndex = -1, }) {\n    if (!this._scrollMatches || !element) {\n      return;\n    } else if (matchIndex === -1 || matchIndex !== this._selected.matchIdx) {\n      return;\n    } else if (pageIndex === -1 || pageIndex !== this._selected.pageIdx) {\n      return;\n    }\n    this._scrollMatches = false; // Ensure that scrolling only happens once.\n\n    const spot = {\n      top: MATCH_SCROLL_OFFSET_TOP,\n      left: MATCH_SCROLL_OFFSET_LEFT,\n    };\n    scrollIntoView(element, spot, /* skipOverflowHiddenElements = */ true);\n  }\n\n  _reset() {\n    this._highlightMatches = false;\n    this._scrollMatches = false;\n    this._pdfDocument = null;\n    this._pageMatches = [];\n    this._pageMatchesLength = [];\n    this._state = null;\n    this._selected = { // Currently selected match.\n      pageIdx: -1,\n      matchIdx: -1,\n    };\n    this._offset = { // Where the find algorithm currently is in the document.\n      pageIdx: null,\n      matchIdx: null,\n      wrapped: false,\n    };\n    this._extractTextPromises = [];\n    this._pageContents = []; // Stores the normalized text for each page.\n    this._matchesCountTotal = 0;\n    this._pagesToSearch = null;\n    this._pendingFindMatches = Object.create(null);\n    this._resumePageIdx = null;\n    this._dirtyMatch = false;\n    clearTimeout(this._findTimeout);\n    this._findTimeout = null;\n\n    this._firstPageCapability = createPromiseCapability();\n  }\n\n  /**\n   * @return {string} The (current) normalized search query.\n   */\n  get _query() {\n    if (this._state.query !== this._rawQuery) {\n      this._rawQuery = this._state.query;\n      this._normalizedQuery = normalize(this._state.query);\n    }\n    return this._normalizedQuery;\n  }\n\n  _shouldDirtyMatch(cmd, state) {\n    // When the search query changes, regardless of the actual search command\n    // used, always re-calculate matches to avoid errors (fixes bug 1030622).\n    if (state.query !== this._state.query) {\n      return true;\n    }\n    switch (cmd) {\n      case 'findagain':\n        const pageNumber = this._selected.pageIdx + 1;\n        const linkService = this._linkService;\n        // Only treat a 'findagain' event as a new search operation when it's\n        // *absolutely* certain that the currently selected match is no longer\n        // visible, e.g. as a result of the user scrolling in the document.\n        //\n        // NOTE: If only a simple `this._linkService.page` check was used here,\n        // there's a risk that consecutive 'findagain' operations could \"skip\"\n        // over matches at the top/bottom of pages thus making them completely\n        // inaccessible when there's multiple pages visible in the viewer.\n        if (pageNumber >= 1 && pageNumber <= linkService.pagesCount &&\n            pageNumber !== linkService.page &&\n            !linkService.isPageVisible(pageNumber)) {\n          return true;\n        }\n        return false;\n      case 'findhighlightallchange':\n        return false;\n    }\n    return true;\n  }\n\n  /**\n   * Helper for multi-term search that fills the `matchesWithLength` array\n   * and handles cases where one search term includes another search term (for\n   * example, \"tamed tame\" or \"this is\"). It looks for intersecting terms in\n   * the `matches` and keeps elements with a longer match length.\n   */\n  _prepareMatches(matchesWithLength, matches, matchesLength) {\n    function isSubTerm(matchesWithLength, currentIndex) {\n      const currentElem = matchesWithLength[currentIndex];\n      const nextElem = matchesWithLength[currentIndex + 1];\n\n      // Check for cases like \"TAMEd TAME\".\n      if (currentIndex < matchesWithLength.length - 1 &&\n          currentElem.match === nextElem.match) {\n        currentElem.skipped = true;\n        return true;\n      }\n\n      // Check for cases like \"thIS IS\".\n      for (let i = currentIndex - 1; i >= 0; i--) {\n        const prevElem = matchesWithLength[i];\n        if (prevElem.skipped) {\n          continue;\n        }\n        if (prevElem.match + prevElem.matchLength < currentElem.match) {\n          break;\n        }\n        if (prevElem.match + prevElem.matchLength >=\n            currentElem.match + currentElem.matchLength) {\n          currentElem.skipped = true;\n          return true;\n        }\n      }\n      return false;\n    }\n\n    // Sort the array of `{ match: <match>, matchLength: <matchLength> }`\n    // objects on increasing index first and on the length otherwise.\n    matchesWithLength.sort(function(a, b) {\n      return a.match === b.match ? a.matchLength - b.matchLength :\n                                   a.match - b.match;\n    });\n    for (let i = 0, len = matchesWithLength.length; i < len; i++) {\n      if (isSubTerm(matchesWithLength, i)) {\n        continue;\n      }\n      matches.push(matchesWithLength[i].match);\n      matchesLength.push(matchesWithLength[i].matchLength);\n    }\n  }\n\n  /**\n   * Determine if the search query constitutes a \"whole word\", by comparing the\n   * first/last character type with the preceding/following character type.\n   */\n  _isEntireWord(content, startIdx, length) {\n    if (startIdx > 0) {\n      const first = content.charCodeAt(startIdx);\n      const limit = content.charCodeAt(startIdx - 1);\n      if (getCharacterType(first) === getCharacterType(limit)) {\n        return false;\n      }\n    }\n    const endIdx = (startIdx + length - 1);\n    if (endIdx < (content.length - 1)) {\n      const last = content.charCodeAt(endIdx);\n      const limit = content.charCodeAt(endIdx + 1);\n      if (getCharacterType(last) === getCharacterType(limit)) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  _calculatePhraseMatch(query, pageIndex, pageContent, entireWord) {\n    const matches = [];\n    const queryLen = query.length;\n\n    let matchIdx = -queryLen;\n    while (true) {\n      matchIdx = pageContent.indexOf(query, matchIdx + queryLen);\n      if (matchIdx === -1) {\n        break;\n      }\n      if (entireWord && !this._isEntireWord(pageContent, matchIdx, queryLen)) {\n        continue;\n      }\n      matches.push(matchIdx);\n    }\n    this._pageMatches[pageIndex] = matches;\n  }\n\n  _calculateWordMatch(query, pageIndex, pageContent, entireWord) {\n    const matchesWithLength = [];\n\n    // Divide the query into pieces and search for text in each piece.\n    const queryArray = query.match(/\\S+/g);\n    for (let i = 0, len = queryArray.length; i < len; i++) {\n      const subquery = queryArray[i];\n      const subqueryLen = subquery.length;\n\n      let matchIdx = -subqueryLen;\n      while (true) {\n        matchIdx = pageContent.indexOf(subquery, matchIdx + subqueryLen);\n        if (matchIdx === -1) {\n          break;\n        }\n        if (entireWord &&\n            !this._isEntireWord(pageContent, matchIdx, subqueryLen)) {\n          continue;\n        }\n        // Other searches do not, so we store the length.\n        matchesWithLength.push({\n          match: matchIdx,\n          matchLength: subqueryLen,\n          skipped: false,\n        });\n      }\n    }\n\n    // Prepare arrays for storing the matches.\n    this._pageMatchesLength[pageIndex] = [];\n    this._pageMatches[pageIndex] = [];\n\n    // Sort `matchesWithLength`, remove intersecting terms and put the result\n    // into the two arrays.\n    this._prepareMatches(matchesWithLength, this._pageMatches[pageIndex],\n      this._pageMatchesLength[pageIndex]);\n  }\n\n  _calculateMatch(pageIndex) {\n    let pageContent = this._pageContents[pageIndex];\n    let query = this._query;\n    const { caseSensitive, entireWord, phraseSearch, } = this._state;\n\n    if (query.length === 0) {\n      // Do nothing: the matches should be wiped out already.\n      return;\n    }\n\n    if (!caseSensitive) {\n      pageContent = pageContent.toLowerCase();\n      query = query.toLowerCase();\n    }\n\n    if (phraseSearch) {\n      this._calculatePhraseMatch(query, pageIndex, pageContent, entireWord);\n    } else {\n      this._calculateWordMatch(query, pageIndex, pageContent, entireWord);\n    }\n\n    // When `highlightAll` is set, ensure that the matches on previously\n    // rendered (and still active) pages are correctly highlighted.\n    if (this._state.highlightAll) {\n      this._updatePage(pageIndex);\n    }\n    if (this._resumePageIdx === pageIndex) {\n      this._resumePageIdx = null;\n      this._nextPageMatch();\n    }\n\n    // Update the match count.\n    const pageMatchesCount = this._pageMatches[pageIndex].length;\n    if (pageMatchesCount > 0) {\n      this._matchesCountTotal += pageMatchesCount;\n      this._updateUIResultsCount();\n    }\n  }\n\n  _extractText() {\n    // Perform text extraction once if this method is called multiple times.\n    if (this._extractTextPromises.length > 0) {\n      return;\n    }\n\n    let promise = Promise.resolve();\n    for (let i = 0, ii = this._linkService.pagesCount; i < ii; i++) {\n      const extractTextCapability = createPromiseCapability();\n      this._extractTextPromises[i] = extractTextCapability.promise;\n\n      promise = promise.then(() => {\n        return this._pdfDocument.getPage(i + 1).then((pdfPage) => {\n          return pdfPage.getTextContent({\n            normalizeWhitespace: true,\n          });\n        }).then((textContent) => {\n          const textItems = textContent.items;\n          const strBuf = [];\n\n          for (let j = 0, jj = textItems.length; j < jj; j++) {\n            strBuf.push(textItems[j].str);\n          }\n\n          // Store the normalized page content (text items) as one string.\n          this._pageContents[i] = normalize(strBuf.join(''));\n          extractTextCapability.resolve(i);\n        }, (reason) => {\n          console.error(`Unable to get text content for page ${i + 1}`, reason);\n          // Page error -- assuming no text content.\n          this._pageContents[i] = '';\n          extractTextCapability.resolve(i);\n        });\n      });\n    }\n  }\n\n  _updatePage(index) {\n    if (this._scrollMatches && this._selected.pageIdx === index) {\n      // If the page is selected, scroll the page into view, which triggers\n      // rendering the page, which adds the text layer. Once the text layer\n      // is built, it will attempt to scroll the selected match into view.\n      this._linkService.page = index + 1;\n    }\n\n    this._eventBus.dispatch('updatetextlayermatches', {\n      source: this,\n      pageIndex: index,\n    });\n  }\n\n  _updateAllPages() {\n    this._eventBus.dispatch('updatetextlayermatches', {\n      source: this,\n      pageIndex: -1,\n    });\n  }\n\n  _nextMatch() {\n    const previous = this._state.findPrevious;\n    const currentPageIndex = this._linkService.page - 1;\n    const numPages = this._linkService.pagesCount;\n\n    this._highlightMatches = true;\n\n    if (this._dirtyMatch) {\n      // Need to recalculate the matches, reset everything.\n      this._dirtyMatch = false;\n      this._selected.pageIdx = this._selected.matchIdx = -1;\n      this._offset.pageIdx = currentPageIndex;\n      this._offset.matchIdx = null;\n      this._offset.wrapped = false;\n      this._resumePageIdx = null;\n      this._pageMatches.length = 0;\n      this._pageMatchesLength.length = 0;\n      this._matchesCountTotal = 0;\n\n      this._updateAllPages(); // Wipe out any previously highlighted matches.\n\n      for (let i = 0; i < numPages; i++) {\n        // Start finding the matches as soon as the text is extracted.\n        if (this._pendingFindMatches[i] === true) {\n          continue;\n        }\n        this._pendingFindMatches[i] = true;\n        this._extractTextPromises[i].then((pageIdx) => {\n          delete this._pendingFindMatches[pageIdx];\n          this._calculateMatch(pageIdx);\n        });\n      }\n    }\n\n    // If there's no query there's no point in searching.\n    if (this._query === '') {\n      this._updateUIState(FindState.FOUND);\n      return;\n    }\n    // If we're waiting on a page, we return since we can't do anything else.\n    if (this._resumePageIdx) {\n      return;\n    }\n\n    const offset = this._offset;\n    // Keep track of how many pages we should maximally iterate through.\n    this._pagesToSearch = numPages;\n    // If there's already a `matchIdx` that means we are iterating through a\n    // page's matches.\n    if (offset.matchIdx !== null) {\n      const numPageMatches = this._pageMatches[offset.pageIdx].length;\n      if ((!previous && offset.matchIdx + 1 < numPageMatches) ||\n          (previous && offset.matchIdx > 0)) {\n        // The simple case; we just have advance the matchIdx to select\n        // the next match on the page.\n        offset.matchIdx = (previous ? offset.matchIdx - 1 :\n                                      offset.matchIdx + 1);\n        this._updateMatch(/* found = */ true);\n        return;\n      }\n      // We went beyond the current page's matches, so we advance to\n      // the next page.\n      this._advanceOffsetPage(previous);\n    }\n    // Start searching through the page.\n    this._nextPageMatch();\n  }\n\n  _matchesReady(matches) {\n    const offset = this._offset;\n    const numMatches = matches.length;\n    const previous = this._state.findPrevious;\n\n    if (numMatches) {\n      // There were matches for the page, so initialize `matchIdx`.\n      offset.matchIdx = (previous ? numMatches - 1 : 0);\n      this._updateMatch(/* found = */ true);\n      return true;\n    }\n    // No matches, so attempt to search the next page.\n    this._advanceOffsetPage(previous);\n    if (offset.wrapped) {\n      offset.matchIdx = null;\n      if (this._pagesToSearch < 0) {\n        // No point in wrapping again, there were no matches.\n        this._updateMatch(/* found = */ false);\n        // While matches were not found, searching for a page\n        // with matches should nevertheless halt.\n        return true;\n      }\n    }\n    // Matches were not found (and searching is not done).\n    return false;\n  }\n\n  _nextPageMatch() {\n    if (this._resumePageIdx !== null) {\n      console.error('There can only be one pending page.');\n    }\n\n    let matches = null;\n    do {\n      const pageIdx = this._offset.pageIdx;\n      matches = this._pageMatches[pageIdx];\n      if (!matches) {\n        // The matches don't exist yet for processing by `_matchesReady`,\n        // so set a resume point for when they do exist.\n        this._resumePageIdx = pageIdx;\n        break;\n      }\n    } while (!this._matchesReady(matches));\n  }\n\n  _advanceOffsetPage(previous) {\n    const offset = this._offset;\n    const numPages = this._linkService.pagesCount;\n    offset.pageIdx = (previous ? offset.pageIdx - 1 : offset.pageIdx + 1);\n    offset.matchIdx = null;\n\n    this._pagesToSearch--;\n\n    if (offset.pageIdx >= numPages || offset.pageIdx < 0) {\n      offset.pageIdx = (previous ? numPages - 1 : 0);\n      offset.wrapped = true;\n    }\n  }\n\n  _updateMatch(found = false) {\n    let state = FindState.NOT_FOUND;\n    const wrapped = this._offset.wrapped;\n    this._offset.wrapped = false;\n\n    if (found) {\n      const previousPage = this._selected.pageIdx;\n      this._selected.pageIdx = this._offset.pageIdx;\n      this._selected.matchIdx = this._offset.matchIdx;\n      state = (wrapped ? FindState.WRAPPED : FindState.FOUND);\n\n      // Update the currently selected page to wipe out any selected matches.\n      if (previousPage !== -1 && previousPage !== this._selected.pageIdx) {\n        this._updatePage(previousPage);\n      }\n    }\n\n    this._updateUIState(state, this._state.findPrevious);\n    if (this._selected.pageIdx !== -1) {\n      // Ensure that the match will be scrolled into view.\n      this._scrollMatches = true;\n\n      this._updatePage(this._selected.pageIdx);\n    }\n  }\n\n  _onFindBarClose(evt) {\n    const pdfDocument = this._pdfDocument;\n    // Since searching is asynchronous, ensure that the removal of highlighted\n    // matches (from the UI) is async too such that the 'updatetextlayermatches'\n    // events will always be dispatched in the expected order.\n    this._firstPageCapability.promise.then(() => {\n      // Only update the UI if the document is open, and is the current one.\n      if (!this._pdfDocument ||\n          (pdfDocument && this._pdfDocument !== pdfDocument)) {\n        return;\n      }\n      // Ensure that a pending, not yet started, search operation is aborted.\n      if (this._findTimeout) {\n        clearTimeout(this._findTimeout);\n        this._findTimeout = null;\n      }\n      // Abort any long running searches, to avoid a match being scrolled into\n      // view *after* the findbar has been closed. In this case `this._offset`\n      // will most likely differ from `this._selected`, hence we also ensure\n      // that any new search operation will always start with a clean slate.\n      if (this._resumePageIdx) {\n        this._resumePageIdx = null;\n        this._dirtyMatch = true;\n      }\n      // Avoid the UI being in a pending state when the findbar is re-opened.\n      this._updateUIState(FindState.FOUND);\n\n      this._highlightMatches = false;\n      this._updateAllPages(); // Wipe out any previously highlighted matches.\n    });\n  }\n\n  _requestMatchesCount() {\n    const { pageIdx, matchIdx, } = this._selected;\n    let current = 0, total = this._matchesCountTotal;\n    if (matchIdx !== -1) {\n      for (let i = 0; i < pageIdx; i++) {\n        current += (this._pageMatches[i] && this._pageMatches[i].length) || 0;\n      }\n      current += matchIdx + 1;\n    }\n    // When searching starts, this method may be called before the `pageMatches`\n    // have been counted (in `_calculateMatch`). Ensure that the UI won't show\n    // temporarily broken state when the active find result doesn't make sense.\n    if (current < 1 || current > total) {\n      current = total = 0;\n    }\n    return { current, total, };\n  }\n\n  _updateUIResultsCount() {\n    this._eventBus.dispatch('updatefindmatchescount', {\n      source: this,\n      matchesCount: this._requestMatchesCount(),\n    });\n  }\n\n  _updateUIState(state, previous) {\n    this._eventBus.dispatch('updatefindcontrolstate', {\n      source: this,\n      state,\n      previous,\n      matchesCount: this._requestMatchesCount(),\n    });\n  }\n}\n\nexport {\n  FindState,\n  PDFFindController,\n};\n","/* Copyright 2018 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst CharacterType = {\n  SPACE: 0,\n  ALPHA_LETTER: 1,\n  PUNCT: 2,\n  HAN_LETTER: 3,\n  KATAKANA_LETTER: 4,\n  HIRAGANA_LETTER: 5,\n  HALFWIDTH_KATAKANA_LETTER: 6,\n  THAI_LETTER: 7,\n};\n\nfunction isAlphabeticalScript(charCode) {\n  return charCode < 0x2E80;\n}\n\nfunction isAscii(charCode) {\n  return (charCode & 0xFF80) === 0;\n}\n\nfunction isAsciiAlpha(charCode) {\n  return (charCode >= /* a = */ 0x61 && charCode <= /* z = */ 0x7A) ||\n         (charCode >= /* A = */ 0x41 && charCode <= /* Z = */ 0x5A);\n}\n\nfunction isAsciiDigit(charCode) {\n  return (charCode >= /* 0 = */ 0x30 && charCode <= /* 9 = */ 0x39);\n}\n\nfunction isAsciiSpace(charCode) {\n  return (charCode === /* SPACE = */ 0x20 || charCode === /* TAB = */ 0x09 ||\n          charCode === /* CR = */ 0x0D || charCode === /* LF = */ 0x0A);\n}\n\nfunction isHan(charCode) {\n  return (charCode >= 0x3400 && charCode <= 0x9FFF) ||\n         (charCode >= 0xF900 && charCode <= 0xFAFF);\n}\n\nfunction isKatakana(charCode) {\n  return (charCode >= 0x30A0 && charCode <= 0x30FF);\n}\n\nfunction isHiragana(charCode) {\n  return (charCode >= 0x3040 && charCode <= 0x309F);\n}\n\nfunction isHalfwidthKatakana(charCode) {\n  return (charCode >= 0xFF60 && charCode <= 0xFF9F);\n}\n\nfunction isThai(charCode) {\n  return (charCode & 0xFF80) === 0x0E00;\n}\n\n/**\n * This function is based on the word-break detection implemented in:\n * https://hg.mozilla.org/mozilla-central/file/tip/intl/lwbrk/WordBreaker.cpp\n */\nfunction getCharacterType(charCode) {\n  if (isAlphabeticalScript(charCode)) {\n    if (isAscii(charCode)) {\n      if (isAsciiSpace(charCode)) {\n        return CharacterType.SPACE;\n      } else if (isAsciiAlpha(charCode) || isAsciiDigit(charCode) ||\n                 charCode === /* UNDERSCORE = */ 0x5F) {\n        return CharacterType.ALPHA_LETTER;\n      }\n      return CharacterType.PUNCT;\n    } else if (isThai(charCode)) {\n      return CharacterType.THAI_LETTER;\n    } else if (charCode === /* NBSP = */ 0xA0) {\n      return CharacterType.SPACE;\n    }\n    return CharacterType.ALPHA_LETTER;\n  }\n\n  if (isHan(charCode)) {\n    return CharacterType.HAN_LETTER;\n  } else if (isKatakana(charCode)) {\n    return CharacterType.KATAKANA_LETTER;\n  } else if (isHiragana(charCode)) {\n    return CharacterType.HIRAGANA_LETTER;\n  } else if (isHalfwidthKatakana(charCode)) {\n    return CharacterType.HALFWIDTH_KATAKANA_LETTER;\n  }\n  return CharacterType.ALPHA_LETTER;\n}\n\nexport {\n  CharacterType,\n  getCharacterType,\n};\n","/* Copyright 2017 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  getGlobalEventBus, isValidRotation, parseQueryString, waitOnEventOrTimeout\n} from './ui_utils';\n\n// Heuristic value used when force-resetting `this._blockHashChange`.\nconst HASH_CHANGE_TIMEOUT = 1000; // milliseconds\n// Heuristic value used when adding the current position to the browser history.\nconst POSITION_UPDATED_THRESHOLD = 50;\n// Heuristic value used when adding a temporary position to the browser history.\nconst UPDATE_VIEWAREA_TIMEOUT = 1000; // milliseconds\n\n/**\n * @typedef {Object} PDFHistoryOptions\n * @property {IPDFLinkService} linkService - The navigation/linking service.\n * @property {EventBus} eventBus - The application event bus.\n */\n\n/**\n * @typedef {Object} InitializeParameters\n * @property {string} fingerprint - The PDF document's unique fingerprint.\n * @property {boolean} resetHistory - (optional) Reset the browsing history.\n * @property {boolean} updateUrl - (optional) Attempt to update the document\n *   URL, with the current hash, when pushing/replacing browser history entries.\n */\n\n/**\n * @typedef {Object} PushParameters\n * @property {string} namedDest - (optional) The named destination. If absent,\n *   a stringified version of `explicitDest` is used.\n * @property {Array} explicitDest - The explicit destination array.\n * @property {number} pageNumber - The page to which the destination points.\n */\n\nfunction getCurrentHash() {\n  return document.location.hash;\n}\n\nfunction parseCurrentHash(linkService) {\n  let hash = unescape(getCurrentHash()).substring(1);\n  let params = parseQueryString(hash);\n\n  let page = params.page | 0;\n  if (!(Number.isInteger(page) && page > 0 && page <= linkService.pagesCount)) {\n    page = null;\n  }\n  return { hash, page, rotation: linkService.rotation, };\n}\n\nclass PDFHistory {\n  /**\n   * @param {PDFHistoryOptions} options\n   */\n  constructor({ linkService, eventBus, }) {\n    this.linkService = linkService;\n    this.eventBus = eventBus || getGlobalEventBus();\n\n    this.initialized = false;\n    this.initialBookmark = null;\n    this.initialRotation = null;\n\n    this._boundEvents = Object.create(null);\n    this._isViewerInPresentationMode = false;\n    this._isPagesLoaded = false;\n\n    // Ensure that we don't miss either a 'presentationmodechanged' or a\n    // 'pagesloaded' event, by registering the listeners immediately.\n    this.eventBus.on('presentationmodechanged', (evt) => {\n      this._isViewerInPresentationMode = evt.active || evt.switchInProgress;\n    });\n    this.eventBus.on('pagesloaded', (evt) => {\n      this._isPagesLoaded = !!evt.pagesCount;\n    });\n  }\n\n  /**\n   * Initialize the history for the PDF document, using either the current\n   * browser history entry or the document hash, whichever is present.\n   * @param {InitializeParameters} params\n   */\n  initialize({ fingerprint, resetHistory = false, updateUrl = false, }) {\n    if (!fingerprint || typeof fingerprint !== 'string') {\n      console.error(\n        'PDFHistory.initialize: The \"fingerprint\" must be a non-empty string.');\n      return;\n    }\n    let reInitialized = this.initialized && this.fingerprint !== fingerprint;\n    this.fingerprint = fingerprint;\n    this._updateUrl = (updateUrl === true);\n\n    if (!this.initialized) {\n      this._bindEvents();\n    }\n    let state = window.history.state;\n\n    this.initialized = true;\n    this.initialBookmark = null;\n    this.initialRotation = null;\n\n    this._popStateInProgress = false;\n    this._blockHashChange = 0;\n    this._currentHash = getCurrentHash();\n    this._numPositionUpdates = 0;\n\n    this._uid = this._maxUid = 0;\n    this._destination = null;\n    this._position = null;\n\n    if (!this._isValidState(state, /* checkReload = */ true) || resetHistory) {\n      let { hash, page, rotation, } = parseCurrentHash(this.linkService);\n\n      if (!hash || reInitialized || resetHistory) {\n        // Ensure that the browser history is reset on PDF document load.\n        this._pushOrReplaceState(null, /* forceReplace = */ true);\n        return;\n      }\n      // Ensure that the browser history is initialized correctly when\n      // the document hash is present on PDF document load.\n      this._pushOrReplaceState({ hash, page, rotation, },\n                               /* forceReplace = */ true);\n      return;\n    }\n\n    // The browser history contains a valid entry, ensure that the history is\n    // initialized correctly on PDF document load.\n    let destination = state.destination;\n    this._updateInternalState(destination, state.uid,\n                              /* removeTemporary = */ true);\n    if (this._uid > this._maxUid) {\n      this._maxUid = this._uid;\n    }\n\n    if (destination.rotation !== undefined) {\n      this.initialRotation = destination.rotation;\n    }\n    if (destination.dest) {\n      this.initialBookmark = JSON.stringify(destination.dest);\n\n      // If the history is updated, e.g. through the user changing the hash,\n      // before the initial destination has become visible, then we do *not*\n      // want to potentially add `this._position` to the browser history.\n      this._destination.page = null;\n    } else if (destination.hash) {\n      this.initialBookmark = destination.hash;\n    } else if (destination.page) {\n      // Fallback case; shouldn't be necessary, but better safe than sorry.\n      this.initialBookmark = `page=${destination.page}`;\n    }\n  }\n\n  /**\n   * Push an internal destination to the browser history.\n   * @param {PushParameters}\n   */\n  push({ namedDest = null, explicitDest, pageNumber, }) {\n    if (!this.initialized) {\n      return;\n    }\n    if (namedDest && typeof namedDest !== 'string') {\n      console.error('PDFHistory.push: ' +\n                    `\"${namedDest}\" is not a valid namedDest parameter.`);\n      return;\n    } else if (!Array.isArray(explicitDest)) {\n      console.error('PDFHistory.push: ' +\n                    `\"${explicitDest}\" is not a valid explicitDest parameter.`);\n      return;\n    } else if (!(Number.isInteger(pageNumber) &&\n                 pageNumber > 0 && pageNumber <= this.linkService.pagesCount)) {\n      // Allow an unset `pageNumber` if and only if the history is still empty;\n      // please refer to the `this._destination.page = null;` comment above.\n      if (pageNumber !== null || this._destination) {\n        console.error('PDFHistory.push: ' +\n                      `\"${pageNumber}\" is not a valid pageNumber parameter.`);\n        return;\n      }\n    }\n\n    let hash = namedDest || JSON.stringify(explicitDest);\n    if (!hash) {\n      // The hash *should* never be undefined, but if that were to occur,\n      // avoid any possible issues by not updating the browser history.\n      return;\n    }\n\n    let forceReplace = false;\n    if (this._destination &&\n        (isDestHashesEqual(this._destination.hash, hash) ||\n         isDestArraysEqual(this._destination.dest, explicitDest))) {\n      // When the new destination is identical to `this._destination`, and\n      // its `page` is undefined, replace the current browser history entry.\n      // NOTE: This can only occur if `this._destination` was set either:\n      //  - through the document hash being specified on load.\n      //  - through the user changing the hash of the document.\n      if (this._destination.page) {\n        return;\n      }\n      forceReplace = true;\n    }\n    if (this._popStateInProgress && !forceReplace) {\n      return;\n    }\n\n    this._pushOrReplaceState({\n      dest: explicitDest,\n      hash,\n      page: pageNumber,\n      rotation: this.linkService.rotation,\n    }, forceReplace);\n\n    if (!this._popStateInProgress) {\n      // Prevent the browser history from updating while the new destination is\n      // being scrolled into view, to avoid potentially inconsistent state.\n      this._popStateInProgress = true;\n      // We defer the resetting of `this._popStateInProgress`, to account for\n      // e.g. zooming occuring when the new destination is being navigated to.\n      Promise.resolve().then(() => {\n        this._popStateInProgress = false;\n      });\n    }\n  }\n\n  /**\n   * Push the current position to the browser history.\n   */\n  pushCurrentPosition() {\n    if (!this.initialized || this._popStateInProgress) {\n      return;\n    }\n    this._tryPushCurrentPosition();\n  }\n\n  /**\n   * Go back one step in the browser history.\n   * NOTE: Avoids navigating away from the document, useful for \"named actions\".\n   */\n  back() {\n    if (!this.initialized || this._popStateInProgress) {\n      return;\n    }\n    let state = window.history.state;\n    if (this._isValidState(state) && state.uid > 0) {\n      window.history.back();\n    }\n  }\n\n  /**\n   * Go forward one step in the browser history.\n   * NOTE: Avoids navigating away from the document, useful for \"named actions\".\n   */\n  forward() {\n    if (!this.initialized || this._popStateInProgress) {\n      return;\n    }\n    let state = window.history.state;\n    if (this._isValidState(state) && state.uid < this._maxUid) {\n      window.history.forward();\n    }\n  }\n\n  /**\n   * @returns {boolean} Indicating if the user is currently moving through the\n   *   browser history, useful e.g. for skipping the next 'hashchange' event.\n   */\n  get popStateInProgress() {\n    return this.initialized &&\n           (this._popStateInProgress || this._blockHashChange > 0);\n  }\n\n  /**\n   * @private\n   */\n  _pushOrReplaceState(destination, forceReplace = false) {\n    let shouldReplace = forceReplace || !this._destination;\n    let newState = {\n      fingerprint: this.fingerprint,\n      uid: shouldReplace ? this._uid : (this._uid + 1),\n      destination,\n    };\n\n    if (typeof PDFJSDev !== 'undefined' && PDFJSDev.test('CHROME') &&\n        window.history.state && window.history.state.chromecomState) {\n      // history.state.chromecomState is managed by chromecom.js.\n      newState.chromecomState = window.history.state.chromecomState;\n    }\n    this._updateInternalState(destination, newState.uid);\n\n    let newUrl;\n    if (this._updateUrl && destination && destination.hash) {\n      const baseUrl = document.location.href.split('#')[0];\n      if (!baseUrl.startsWith('file://')) { // Prevent errors in Firefox.\n        newUrl = `${baseUrl}#${destination.hash}`;\n      }\n    }\n    if (shouldReplace) {\n      if (newUrl) {\n        window.history.replaceState(newState, '', newUrl);\n      } else {\n        window.history.replaceState(newState, '');\n      }\n    } else {\n      this._maxUid = this._uid;\n      if (newUrl) {\n        window.history.pushState(newState, '', newUrl);\n      } else {\n        window.history.pushState(newState, '');\n      }\n    }\n\n    if (typeof PDFJSDev !== 'undefined' && PDFJSDev.test('CHROME') &&\n        top === window) {\n      // eslint-disable-next-line no-undef\n      chrome.runtime.sendMessage('showPageAction');\n    }\n  }\n\n  /**\n   * @private\n   */\n  _tryPushCurrentPosition(temporary = false) {\n    if (!this._position) {\n      return;\n    }\n    let position = this._position;\n    if (temporary) {\n      position = Object.assign(Object.create(null), this._position);\n      position.temporary = true;\n    }\n\n    if (!this._destination) {\n      this._pushOrReplaceState(position);\n      return;\n    }\n    if (this._destination.temporary) {\n      // Always replace a previous *temporary* position.\n      this._pushOrReplaceState(position, /* forceReplace = */ true);\n      return;\n    }\n    if (this._destination.hash === position.hash) {\n      return; // The current document position has not changed.\n    }\n    if (!this._destination.page &&\n        (POSITION_UPDATED_THRESHOLD <= 0 ||\n         this._numPositionUpdates <= POSITION_UPDATED_THRESHOLD)) {\n      // `this._destination` was set through the user changing the hash of\n      // the document. Do not add `this._position` to the browser history,\n      // to avoid \"flooding\" it with lots of (nearly) identical entries,\n      // since we cannot ensure that the document position has changed.\n      return;\n    }\n\n    let forceReplace = false;\n    if (this._destination.page >= position.first &&\n        this._destination.page <= position.page) {\n      // When the `page` of `this._destination` is still visible, do not\n      // update the browsing history when `this._destination` either:\n      //  - contains an internal destination, since in this case we\n      //    cannot ensure that the document position has actually changed.\n      //  - was set through the user changing the hash of the document.\n      if (this._destination.dest || !this._destination.first) {\n        return;\n      }\n      // To avoid \"flooding\" the browser history, replace the current entry.\n      forceReplace = true;\n    }\n    this._pushOrReplaceState(position, forceReplace);\n  }\n\n  /**\n   * @private\n   */\n  _isValidState(state, checkReload = false) {\n    if (!state) {\n      return false;\n    }\n    if (state.fingerprint !== this.fingerprint) {\n      if (checkReload) {\n        // Potentially accept the history entry, even if the fingerprints don't\n        // match, when the viewer was reloaded (see issue 6847).\n        if (typeof state.fingerprint !== 'string' ||\n            state.fingerprint.length !== this.fingerprint.length) {\n          return false;\n        }\n        const [perfEntry] = performance.getEntriesByType('navigation');\n        if (!perfEntry || perfEntry.type !== 'reload') {\n          return false;\n        }\n      } else {\n        // This should only occur in viewers with support for opening more than\n        // one PDF document, e.g. the GENERIC viewer.\n        return false;\n      }\n    }\n    if (!Number.isInteger(state.uid) || state.uid < 0) {\n      return false;\n    }\n    if (state.destination === null || typeof state.destination !== 'object') {\n      return false;\n    }\n    return true;\n  }\n\n  /**\n   * @private\n   */\n  _updateInternalState(destination, uid, removeTemporary = false) {\n    if (this._updateViewareaTimeout) {\n      // When updating `this._destination`, make sure that we always wait for\n      // the next 'updateviewarea' event before (potentially) attempting to\n      // push the current position to the browser history.\n      clearTimeout(this._updateViewareaTimeout);\n      this._updateViewareaTimeout = null;\n    }\n    if (removeTemporary && destination && destination.temporary) {\n      // When the `destination` comes from the browser history,\n      // we no longer treat it as a *temporary* position.\n      delete destination.temporary;\n    }\n    this._destination = destination;\n    this._uid = uid;\n    // This should always be reset when `this._destination` is updated.\n    this._numPositionUpdates = 0;\n  }\n\n  /**\n   * @private\n   */\n  _updateViewarea({ location, }) {\n    if (this._updateViewareaTimeout) {\n      clearTimeout(this._updateViewareaTimeout);\n      this._updateViewareaTimeout = null;\n    }\n\n    this._position = {\n      hash: this._isViewerInPresentationMode ?\n        `page=${location.pageNumber}` : location.pdfOpenParams.substring(1),\n      page: this.linkService.page,\n      first: location.pageNumber,\n      rotation: location.rotation,\n    };\n\n    if (this._popStateInProgress) {\n      return;\n    }\n\n    if (POSITION_UPDATED_THRESHOLD > 0 && this._isPagesLoaded &&\n        this._destination && !this._destination.page) {\n      // If the current destination was set through the user changing the hash\n      // of the document, we will usually not try to push the current position\n      // to the browser history; see `this._tryPushCurrentPosition()`.\n      //\n      // To prevent `this._tryPushCurrentPosition()` from effectively being\n      // reduced to a no-op in this case, we will assume that the position\n      // *did* in fact change if the 'updateviewarea' event was dispatched\n      // more than `POSITION_UPDATED_THRESHOLD` times.\n      this._numPositionUpdates++;\n    }\n\n    if (UPDATE_VIEWAREA_TIMEOUT > 0) {\n      // When closing the browser, a 'pagehide' event will be dispatched which\n      // *should* allow us to push the current position to the browser history.\n      // In practice, it seems that the event is arriving too late in order for\n      // the session history to be successfully updated.\n      // (For additional details, please refer to the discussion in\n      //  https://bugzilla.mozilla.org/show_bug.cgi?id=1153393.)\n      //\n      // To workaround this we attempt to *temporarily* add the current position\n      // to the browser history only when the viewer is *idle*,\n      // i.e. when scrolling and/or zooming does not occur.\n      //\n      // PLEASE NOTE: It's absolutely imperative that the browser history is\n      // *not* updated too often, since that would render the viewer more or\n      // less unusable. Hence the use of a timeout to delay the update until\n      // the viewer has been idle for `UPDATE_VIEWAREA_TIMEOUT` milliseconds.\n      this._updateViewareaTimeout = setTimeout(() => {\n        if (!this._popStateInProgress) {\n          this._tryPushCurrentPosition(/* temporary = */ true);\n        }\n        this._updateViewareaTimeout = null;\n      }, UPDATE_VIEWAREA_TIMEOUT);\n    }\n  }\n\n  /**\n   * @private\n   */\n  _popState({ state, }) {\n    let newHash = getCurrentHash(), hashChanged = this._currentHash !== newHash;\n    this._currentHash = newHash;\n\n    if (!state ||\n        (typeof PDFJSDev !== 'undefined' && PDFJSDev.test('CHROME') &&\n         state.chromecomState && !this._isValidState(state))) {\n      // This case corresponds to the user changing the hash of the document.\n      this._uid++;\n\n      let { hash, page, rotation, } = parseCurrentHash(this.linkService);\n      this._pushOrReplaceState({ hash, page, rotation, },\n                               /* forceReplace = */ true);\n      return;\n    }\n    if (!this._isValidState(state)) {\n      // This should only occur in viewers with support for opening more than\n      // one PDF document, e.g. the GENERIC viewer.\n      return;\n    }\n\n    // Prevent the browser history from updating until the new destination,\n    // as stored in the browser history, has been scrolled into view.\n    this._popStateInProgress = true;\n\n    if (hashChanged) {\n      // When the hash changed, implying that the 'popstate' event will be\n      // followed by a 'hashchange' event, then we do *not* want to update the\n      // browser history when handling the 'hashchange' event (in web/app.js)\n      // since that would *overwrite* the new destination navigated to below.\n      //\n      // To avoid accidentally disabling all future user-initiated hash changes,\n      // if there's e.g. another 'hashchange' listener that stops the event\n      // propagation, we make sure to always force-reset `this._blockHashChange`\n      // after `HASH_CHANGE_TIMEOUT` milliseconds have passed.\n      this._blockHashChange++;\n      waitOnEventOrTimeout({\n        target: window,\n        name: 'hashchange',\n        delay: HASH_CHANGE_TIMEOUT,\n      }).then(() => {\n        this._blockHashChange--;\n      });\n    }\n\n    // Navigate to the new destination.\n    let destination = state.destination;\n    this._updateInternalState(destination, state.uid,\n                              /* removeTemporary = */ true);\n    if (this._uid > this._maxUid) {\n      this._maxUid = this._uid;\n    }\n\n    if (isValidRotation(destination.rotation)) {\n      this.linkService.rotation = destination.rotation;\n    }\n    if (destination.dest) {\n      this.linkService.navigateTo(destination.dest);\n    } else if (destination.hash) {\n      this.linkService.setHash(destination.hash);\n    } else if (destination.page) {\n      // Fallback case; shouldn't be necessary, but better safe than sorry.\n      this.linkService.page = destination.page;\n    }\n\n    // Since `PDFLinkService.navigateTo` is asynchronous, we thus defer the\n    // resetting of `this._popStateInProgress` slightly.\n    Promise.resolve().then(() => {\n      this._popStateInProgress = false;\n    });\n  }\n\n  /**\n   * @private\n   */\n  _bindEvents() {\n    let { _boundEvents, eventBus, } = this;\n\n    _boundEvents.updateViewarea = this._updateViewarea.bind(this);\n    _boundEvents.popState = this._popState.bind(this);\n    _boundEvents.pageHide = (evt) => {\n      // Attempt to push the `this._position` into the browser history when\n      // navigating away from the document. This is *only* done if the history\n      // is empty/temporary, since otherwise an existing browser history entry\n      // will end up being overwritten (given that new entries cannot be pushed\n      // into the browser history when the 'unload' event has already fired).\n      if (!this._destination || this._destination.temporary) {\n        this._tryPushCurrentPosition();\n      }\n    };\n\n    eventBus.on('updateviewarea', _boundEvents.updateViewarea);\n    window.addEventListener('popstate', _boundEvents.popState);\n    window.addEventListener('pagehide', _boundEvents.pageHide);\n  }\n}\n\nfunction isDestHashesEqual(destHash, pushHash) {\n  if (typeof destHash !== 'string' || typeof pushHash !== 'string') {\n    return false;\n  }\n  if (destHash === pushHash) {\n    return true;\n  }\n  let { nameddest, } = parseQueryString(destHash);\n  if (nameddest === pushHash) {\n    return true;\n  }\n  return false;\n}\n\nfunction isDestArraysEqual(firstDest, secondDest) {\n  function isEntryEqual(first, second) {\n    if (typeof first !== typeof second) {\n      return false;\n    }\n    if (Array.isArray(first) || Array.isArray(second)) {\n      return false;\n    }\n    if (first !== null && typeof first === 'object' && second !== null) {\n      if (Object.keys(first).length !== Object.keys(second).length) {\n        return false;\n      }\n      for (let key in first) {\n        if (!isEntryEqual(first[key], second[key])) {\n          return false;\n        }\n      }\n      return true;\n    }\n    return first === second || (Number.isNaN(first) && Number.isNaN(second));\n  }\n\n  if (!(Array.isArray(firstDest) && Array.isArray(secondDest))) {\n    return false;\n  }\n  if (firstDest.length !== secondDest.length) {\n    return false;\n  }\n  for (let i = 0, ii = firstDest.length; i < ii; i++) {\n    if (!isEntryEqual(firstDest[i], secondDest[i])) {\n      return false;\n    }\n  }\n  return true;\n}\n\nexport {\n  PDFHistory,\n  isDestHashesEqual,\n  isDestArraysEqual,\n};\n","/* Copyright 2015 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { getGlobalEventBus, parseQueryString } from './ui_utils';\n\n/**\n * @typedef {Object} PDFLinkServiceOptions\n * @property {EventBus} eventBus - The application event bus.\n * @property {number} externalLinkTarget - (optional) Specifies the `target`\n *   attribute for external links. Must use one of the values from {LinkTarget}.\n *   Defaults to using no target.\n * @property {string} externalLinkRel - (optional) Specifies the `rel` attribute\n *   for external links. Defaults to stripping the referrer.\n */\n\n/**\n * Performs navigation functions inside PDF, such as opening specified page,\n * or destination.\n * @implements {IPDFLinkService}\n */\nclass PDFLinkService {\n  /**\n   * @param {PDFLinkServiceOptions} options\n   */\n  constructor({ eventBus, externalLinkTarget = null,\n                externalLinkRel = null, externalLinkEnabled = true, } = {}) {\n    this.eventBus = eventBus || getGlobalEventBus();\n    this.externalLinkTarget = externalLinkTarget;\n    this.externalLinkRel = externalLinkRel;\n    this.externalLinkEnabled = externalLinkEnabled;\n\n    this.baseUrl = null;\n    this.pdfDocument = null;\n    this.pdfViewer = null;\n    this.pdfHistory = null;\n\n    this._pagesRefCache = null;\n  }\n\n  setDocument(pdfDocument, baseUrl = null) {\n    this.baseUrl = baseUrl;\n    this.pdfDocument = pdfDocument;\n    this._pagesRefCache = Object.create(null);\n  }\n\n  setViewer(pdfViewer) {\n    this.pdfViewer = pdfViewer;\n  }\n\n  setHistory(pdfHistory) {\n    this.pdfHistory = pdfHistory;\n  }\n\n  /**\n   * @returns {number}\n   */\n  get pagesCount() {\n    return this.pdfDocument ? this.pdfDocument.numPages : 0;\n  }\n\n  /**\n   * @returns {number}\n   */\n  get page() {\n    return this.pdfViewer.currentPageNumber;\n  }\n\n  /**\n   * @param {number} value\n   */\n  set page(value) {\n    this.pdfViewer.currentPageNumber = value;\n  }\n\n  /**\n   * @returns {number}\n   */\n  get rotation() {\n    return this.pdfViewer.pagesRotation;\n  }\n\n  /**\n   * @param {number} value\n   */\n  set rotation(value) {\n    this.pdfViewer.pagesRotation = value;\n  }\n\n  /**\n   * @param {string|Array} dest - The named, or explicit, PDF destination.\n   */\n  navigateTo(dest) {\n    let goToDestination = ({ namedDest, explicitDest, }) => {\n      // Dest array looks like that: <page-ref> </XYZ|/FitXXX> <args..>\n      let destRef = explicitDest[0], pageNumber;\n\n      if (destRef instanceof Object) {\n        pageNumber = this._cachedPageNumber(destRef);\n\n        if (pageNumber === null) {\n          // Fetch the page reference if it's not yet available. This could\n          // only occur during loading, before all pages have been resolved.\n          this.pdfDocument.getPageIndex(destRef).then((pageIndex) => {\n            this.cachePageRef(pageIndex + 1, destRef);\n            goToDestination({ namedDest, explicitDest, });\n          }).catch(() => {\n            console.error(`PDFLinkService.navigateTo: \"${destRef}\" is not ` +\n                          `a valid page reference, for dest=\"${dest}\".`);\n          });\n          return;\n        }\n      } else if (Number.isInteger(destRef)) {\n        pageNumber = destRef + 1;\n      } else {\n        console.error(`PDFLinkService.navigateTo: \"${destRef}\" is not ` +\n                      `a valid destination reference, for dest=\"${dest}\".`);\n        return;\n      }\n      if (!pageNumber || pageNumber < 1 || pageNumber > this.pagesCount) {\n        console.error(`PDFLinkService.navigateTo: \"${pageNumber}\" is not ` +\n                      `a valid page number, for dest=\"${dest}\".`);\n        return;\n      }\n\n      if (this.pdfHistory) {\n        // Update the browser history before scrolling the new destination into\n        // view, to be able to accurately capture the current document position.\n        this.pdfHistory.pushCurrentPosition();\n        this.pdfHistory.push({ namedDest, explicitDest, pageNumber, });\n      }\n\n      this.pdfViewer.scrollPageIntoView({\n        pageNumber,\n        destArray: explicitDest,\n      });\n    };\n\n    new Promise((resolve, reject) => {\n      if (typeof dest === 'string') {\n        this.pdfDocument.getDestination(dest).then((destArray) => {\n          resolve({\n            namedDest: dest,\n            explicitDest: destArray,\n          });\n        });\n        return;\n      }\n      resolve({\n        namedDest: '',\n        explicitDest: dest,\n      });\n    }).then((data) => {\n      if (!Array.isArray(data.explicitDest)) {\n        console.error(`PDFLinkService.navigateTo: \"${data.explicitDest}\" is` +\n                      ` not a valid destination array, for dest=\"${dest}\".`);\n        return;\n      }\n      goToDestination(data);\n    });\n  }\n\n  /**\n   * @param {string|Array} dest - The PDF destination object.\n   * @returns {string} The hyperlink to the PDF object.\n   */\n  getDestinationHash(dest) {\n    if (typeof dest === 'string') {\n      return this.getAnchorUrl('#' + escape(dest));\n    }\n    if (Array.isArray(dest)) {\n      let str = JSON.stringify(dest);\n      return this.getAnchorUrl('#' + escape(str));\n    }\n    return this.getAnchorUrl('');\n  }\n\n  /**\n   * Prefix the full url on anchor links to make sure that links are resolved\n   * relative to the current URL instead of the one defined in <base href>.\n   * @param {String} anchor The anchor hash, including the #.\n   * @returns {string} The hyperlink to the PDF object.\n   */\n  getAnchorUrl(anchor) {\n    return (this.baseUrl || '') + anchor;\n  }\n\n  /**\n   * @param {string} hash\n   */\n  setHash(hash) {\n    let pageNumber, dest;\n    if (hash.includes('=')) {\n      let params = parseQueryString(hash);\n      if ('search' in params) {\n        this.eventBus.dispatch('findfromurlhash', {\n          source: this,\n          query: params['search'].replace(/\"/g, ''),\n          phraseSearch: (params['phrase'] === 'true'),\n        });\n      }\n      // borrowing syntax from \"Parameters for Opening PDF Files\"\n      if ('nameddest' in params) {\n        this.navigateTo(params.nameddest);\n        return;\n      }\n      if ('page' in params) {\n        pageNumber = (params.page | 0) || 1;\n      }\n      if ('zoom' in params) {\n        // Build the destination array.\n        let zoomArgs = params.zoom.split(','); // scale,left,top\n        let zoomArg = zoomArgs[0];\n        let zoomArgNumber = parseFloat(zoomArg);\n\n        if (!zoomArg.includes('Fit')) {\n          // If the zoomArg is a number, it has to get divided by 100. If it's\n          // a string, it should stay as it is.\n          dest = [null, { name: 'XYZ', },\n                  zoomArgs.length > 1 ? (zoomArgs[1] | 0) : null,\n                  zoomArgs.length > 2 ? (zoomArgs[2] | 0) : null,\n                  (zoomArgNumber ? zoomArgNumber / 100 : zoomArg)];\n        } else {\n          if (zoomArg === 'Fit' || zoomArg === 'FitB') {\n            dest = [null, { name: zoomArg, }];\n          } else if ((zoomArg === 'FitH' || zoomArg === 'FitBH') ||\n                     (zoomArg === 'FitV' || zoomArg === 'FitBV')) {\n            dest = [null, { name: zoomArg, },\n                    zoomArgs.length > 1 ? (zoomArgs[1] | 0) : null];\n          } else if (zoomArg === 'FitR') {\n            if (zoomArgs.length !== 5) {\n              console.error(\n                'PDFLinkService.setHash: Not enough parameters for \"FitR\".');\n            } else {\n              dest = [null, { name: zoomArg, },\n                      (zoomArgs[1] | 0), (zoomArgs[2] | 0),\n                      (zoomArgs[3] | 0), (zoomArgs[4] | 0)];\n            }\n          } else {\n            console.error(`PDFLinkService.setHash: \"${zoomArg}\" is not ` +\n                          'a valid zoom value.');\n          }\n        }\n      }\n      if (dest) {\n        this.pdfViewer.scrollPageIntoView({\n          pageNumber: pageNumber || this.page,\n          destArray: dest,\n          allowNegativeOffset: true,\n        });\n      } else if (pageNumber) {\n        this.page = pageNumber; // simple page\n      }\n      if ('pagemode' in params) {\n        this.eventBus.dispatch('pagemode', {\n          source: this,\n          mode: params.pagemode,\n        });\n      }\n    } else { // Named (or explicit) destination.\n      dest = unescape(hash);\n      try {\n        dest = JSON.parse(dest);\n\n        if (!Array.isArray(dest)) {\n          // Avoid incorrectly rejecting a valid named destination, such as\n          // e.g. \"4.3\" or \"true\", because `JSON.parse` converted its type.\n          dest = dest.toString();\n        }\n      } catch (ex) {}\n\n      if (typeof dest === 'string' || isValidExplicitDestination(dest)) {\n        this.navigateTo(dest);\n        return;\n      }\n      console.error(`PDFLinkService.setHash: \"${unescape(hash)}\" is not ` +\n                    'a valid destination.');\n    }\n  }\n\n  /**\n   * @param {string} action\n   */\n  executeNamedAction(action) {\n    // See PDF reference, table 8.45 - Named action\n    switch (action) {\n      case 'GoBack':\n        if (this.pdfHistory) {\n          this.pdfHistory.back();\n        }\n        break;\n\n      case 'GoForward':\n        if (this.pdfHistory) {\n          this.pdfHistory.forward();\n        }\n        break;\n\n      case 'NextPage':\n        if (this.page < this.pagesCount) {\n          this.page++;\n        }\n        break;\n\n      case 'PrevPage':\n        if (this.page > 1) {\n          this.page--;\n        }\n        break;\n\n      case 'LastPage':\n        this.page = this.pagesCount;\n        break;\n\n      case 'FirstPage':\n        this.page = 1;\n        break;\n\n      default:\n        break; // No action according to spec\n    }\n\n    this.eventBus.dispatch('namedaction', {\n      source: this,\n      action,\n    });\n  }\n\n  /**\n   * @param {number} pageNum - page number.\n   * @param {Object} pageRef - reference to the page.\n   */\n  cachePageRef(pageNum, pageRef) {\n    if (!pageRef) {\n      return;\n    }\n    const refStr = pageRef.gen === 0 ? `${pageRef.num}R` :\n                                       `${pageRef.num}R${pageRef.gen}`;\n    this._pagesRefCache[refStr] = pageNum;\n  }\n\n  _cachedPageNumber(pageRef) {\n    const refStr = pageRef.gen === 0 ? `${pageRef.num}R` :\n                                       `${pageRef.num}R${pageRef.gen}`;\n    return (this._pagesRefCache && this._pagesRefCache[refStr]) || null;\n  }\n\n  /**\n   * @param {number} pageNumber\n   */\n  isPageVisible(pageNumber) {\n    return this.pdfViewer.isPageVisible(pageNumber);\n  }\n}\n\nfunction isValidExplicitDestination(dest) {\n  if (!Array.isArray(dest)) {\n    return false;\n  }\n  let destLength = dest.length, allowNull = true;\n  if (destLength < 2) {\n    return false;\n  }\n  let page = dest[0];\n  if (!(typeof page === 'object' &&\n        Number.isInteger(page.num) && Number.isInteger(page.gen)) &&\n      !(Number.isInteger(page) && page >= 0)) {\n    return false;\n  }\n  let zoom = dest[1];\n  if (!(typeof zoom === 'object' && typeof zoom.name === 'string')) {\n    return false;\n  }\n  switch (zoom.name) {\n    case 'XYZ':\n      if (destLength !== 5) {\n        return false;\n      }\n      break;\n    case 'Fit':\n    case 'FitB':\n      return destLength === 2;\n    case 'FitH':\n    case 'FitBH':\n    case 'FitV':\n    case 'FitBV':\n      if (destLength !== 3) {\n        return false;\n      }\n      break;\n    case 'FitR':\n      if (destLength !== 6) {\n        return false;\n      }\n      allowNull = false;\n      break;\n    default:\n      return false;\n  }\n  for (let i = 2; i < destLength; i++) {\n    let param = dest[i];\n    if (!(typeof param === 'number' || (allowNull && param === null))) {\n      return false;\n    }\n  }\n  return true;\n}\n\n/**\n * @implements {IPDFLinkService}\n */\nclass SimpleLinkService {\n  constructor() {\n    this.externalLinkTarget = null;\n    this.externalLinkRel = null;\n    this.externalLinkEnabled = true;\n  }\n\n  /**\n   * @returns {number}\n   */\n  get pagesCount() {\n    return 0;\n  }\n\n  /**\n   * @returns {number}\n   */\n  get page() {\n    return 0;\n  }\n\n  /**\n   * @param {number} value\n   */\n  set page(value) {}\n\n  /**\n   * @returns {number}\n   */\n  get rotation() {\n    return 0;\n  }\n\n  /**\n   * @param {number} value\n   */\n  set rotation(value) {}\n\n  /**\n   * @param dest - The PDF destination object.\n   */\n  navigateTo(dest) {}\n\n  /**\n   * @param dest - The PDF destination object.\n   * @returns {string} The hyperlink to the PDF object.\n   */\n  getDestinationHash(dest) {\n    return '#';\n  }\n\n  /**\n   * @param hash - The PDF parameters/hash.\n   * @returns {string} The hyperlink to the PDF object.\n   */\n  getAnchorUrl(hash) {\n    return '#';\n  }\n\n  /**\n   * @param {string} hash\n   */\n  setHash(hash) {}\n\n  /**\n   * @param {string} action\n   */\n  executeNamedAction(action) {}\n\n  /**\n   * @param {number} pageNum - page number.\n   * @param {Object} pageRef - reference to the page.\n   */\n  cachePageRef(pageNum, pageRef) {}\n\n  /**\n   * @param {number} pageNumber\n   */\n  isPageVisible(pageNumber) {\n    return true;\n  }\n}\n\nexport {\n  PDFLinkService,\n  SimpleLinkService,\n};\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { addLinkAttributes, LinkTarget, removeNullCharacters } from 'pdfjs-lib';\n\nconst DEFAULT_TITLE = '\\u2013';\n\n/**\n * @typedef {Object} PDFOutlineViewerOptions\n * @property {HTMLDivElement} container - The viewer element.\n * @property {IPDFLinkService} linkService - The navigation/linking service.\n * @property {EventBus} eventBus - The application event bus.\n */\n\n/**\n * @typedef {Object} PDFOutlineViewerRenderParameters\n * @property {Array|null} outline - An array of outline objects.\n */\n\nclass PDFOutlineViewer {\n  /**\n   * @param {PDFOutlineViewerOptions} options\n   */\n  constructor({ container, linkService, eventBus, }) {\n    this.container = container;\n    this.linkService = linkService;\n    this.eventBus = eventBus;\n\n    this.reset();\n\n    eventBus.on('toggleoutlinetree', this.toggleOutlineTree.bind(this));\n  }\n\n  reset() {\n    this.outline = null;\n    this.lastToggleIsShow = true;\n\n    // Remove the outline from the DOM.\n    this.container.textContent = '';\n\n    // Ensure that the left (right in RTL locales) margin is always reset,\n    // to prevent incorrect outline alignment if a new document is opened.\n    this.container.classList.remove('outlineWithDeepNesting');\n  }\n\n  /**\n   * @private\n   */\n  _dispatchEvent(outlineCount) {\n    this.eventBus.dispatch('outlineloaded', {\n      source: this,\n      outlineCount,\n    });\n  }\n\n  /**\n   * @private\n   */\n  _bindLink(element, { url, newWindow, dest, }) {\n    let { linkService, } = this;\n\n    if (url) {\n      addLinkAttributes(element, {\n        url,\n        target: (newWindow ? LinkTarget.BLANK : linkService.externalLinkTarget),\n        rel: linkService.externalLinkRel,\n        enabled: linkService.externalLinkEnabled,\n      });\n      return;\n    }\n\n    element.href = linkService.getDestinationHash(dest);\n    element.onclick = () => {\n      if (dest) {\n        linkService.navigateTo(dest);\n      }\n      return false;\n    };\n  }\n\n  /**\n   * @private\n   */\n  _setStyles(element, { bold, italic, }) {\n    let styleStr = '';\n    if (bold) {\n      styleStr += 'font-weight: bold;';\n    }\n    if (italic) {\n      styleStr += 'font-style: italic;';\n    }\n\n    if (styleStr) {\n      element.setAttribute('style', styleStr);\n    }\n  }\n\n  /**\n   * Prepend a button before an outline item which allows the user to toggle\n   * the visibility of all outline items at that level.\n   *\n   * @private\n   */\n  _addToggleButton(div, { count, items, }) {\n    let toggler = document.createElement('div');\n    toggler.className = 'outlineItemToggler';\n    if (count < 0 && Math.abs(count) === items.length) {\n      toggler.classList.add('outlineItemsHidden');\n    }\n    toggler.onclick = (evt) => {\n      evt.stopPropagation();\n      toggler.classList.toggle('outlineItemsHidden');\n\n      if (evt.shiftKey) {\n        let shouldShowAll = !toggler.classList.contains('outlineItemsHidden');\n        this._toggleOutlineItem(div, shouldShowAll);\n      }\n    };\n    div.insertBefore(toggler, div.firstChild);\n  }\n\n  /**\n   * Toggle the visibility of the subtree of an outline item.\n   *\n   * @param {Element} root - the root of the outline (sub)tree.\n   * @param {boolean} show - whether to show the outline (sub)tree. If false,\n   *   the outline subtree rooted at |root| will be collapsed.\n   *\n   * @private\n   */\n  _toggleOutlineItem(root, show = false) {\n    this.lastToggleIsShow = show;\n    for (const toggler of root.querySelectorAll('.outlineItemToggler')) {\n      toggler.classList.toggle('outlineItemsHidden', !show);\n    }\n  }\n\n  /**\n   * Collapse or expand all subtrees of the outline.\n   */\n  toggleOutlineTree() {\n    if (!this.outline) {\n      return;\n    }\n    this._toggleOutlineItem(this.container, !this.lastToggleIsShow);\n  }\n\n  /**\n   * @param {PDFOutlineViewerRenderParameters} params\n   */\n  render({ outline, }) {\n    let outlineCount = 0;\n\n    if (this.outline) {\n      this.reset();\n    }\n    this.outline = outline || null;\n\n    if (!outline) {\n      this._dispatchEvent(outlineCount);\n      return;\n    }\n\n    let fragment = document.createDocumentFragment();\n    let queue = [{ parent: fragment, items: this.outline, }];\n    let hasAnyNesting = false;\n    while (queue.length > 0) {\n      const levelData = queue.shift();\n      for (const item of levelData.items) {\n        let div = document.createElement('div');\n        div.className = 'outlineItem';\n\n        let element = document.createElement('a');\n        this._bindLink(element, item);\n        this._setStyles(element, item);\n        element.textContent =\n          removeNullCharacters(item.title) || DEFAULT_TITLE;\n\n        div.appendChild(element);\n\n        if (item.items.length > 0) {\n          hasAnyNesting = true;\n          this._addToggleButton(div, item);\n\n          let itemsDiv = document.createElement('div');\n          itemsDiv.className = 'outlineItems';\n          div.appendChild(itemsDiv);\n          queue.push({ parent: itemsDiv, items: item.items, });\n        }\n\n        levelData.parent.appendChild(div);\n        outlineCount++;\n      }\n    }\n    if (hasAnyNesting) {\n      this.container.classList.add('outlineWithDeepNesting');\n\n      this.lastToggleIsShow =\n        (fragment.querySelectorAll('.outlineItemsHidden').length === 0);\n    }\n\n    this.container.appendChild(fragment);\n\n    this._dispatchEvent(outlineCount);\n  }\n}\n\nexport {\n  PDFOutlineViewer,\n};\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { normalizeWheelEventDelta } from './ui_utils';\n\nconst DELAY_BEFORE_RESETTING_SWITCH_IN_PROGRESS = 1500; // in ms\nconst DELAY_BEFORE_HIDING_CONTROLS = 3000; // in ms\nconst ACTIVE_SELECTOR = 'pdfPresentationMode';\nconst CONTROLS_SELECTOR = 'pdfPresentationModeControls';\nconst MOUSE_SCROLL_COOLDOWN_TIME = 50; // in ms\nconst PAGE_SWITCH_THRESHOLD = 0.1;\n\n// Number of CSS pixels for a movement to count as a swipe.\nconst SWIPE_MIN_DISTANCE_THRESHOLD = 50;\n\n// Swipe angle deviation from the x or y axis before it is not\n// considered a swipe in that direction any more.\nconst SWIPE_ANGLE_THRESHOLD = Math.PI / 6;\n\n/**\n * @typedef {Object} PDFPresentationModeOptions\n * @property {HTMLDivElement} container - The container for the viewer element.\n * @property {HTMLDivElement} viewer - (optional) The viewer element.\n * @property {PDFViewer} pdfViewer - The document viewer.\n * @property {EventBus} eventBus - The application event bus.\n * @property {Array} contextMenuItems - (optional) The menu items that are added\n *   to the context menu in Presentation Mode.\n */\n\nclass PDFPresentationMode {\n  /**\n   * @param {PDFPresentationModeOptions} options\n   */\n  constructor({ container, viewer = null, pdfViewer, eventBus,\n                contextMenuItems = null, }) {\n    this.container = container;\n    this.viewer = viewer || container.firstElementChild;\n    this.pdfViewer = pdfViewer;\n    this.eventBus = eventBus;\n\n    this.active = false;\n    this.args = null;\n    this.contextMenuOpen = false;\n    this.mouseScrollTimeStamp = 0;\n    this.mouseScrollDelta = 0;\n    this.touchSwipeState = null;\n\n    if (contextMenuItems) {\n      contextMenuItems.contextFirstPage.addEventListener('click', () => {\n        this.contextMenuOpen = false;\n        this.eventBus.dispatch('firstpage', { source: this, });\n      });\n      contextMenuItems.contextLastPage.addEventListener('click', () => {\n        this.contextMenuOpen = false;\n        this.eventBus.dispatch('lastpage', { source: this, });\n      });\n      contextMenuItems.contextPageRotateCw.addEventListener('click', () => {\n        this.contextMenuOpen = false;\n        this.eventBus.dispatch('rotatecw', { source: this, });\n      });\n      contextMenuItems.contextPageRotateCcw.addEventListener('click', () => {\n        this.contextMenuOpen = false;\n        this.eventBus.dispatch('rotateccw', { source: this, });\n      });\n    }\n  }\n\n  /**\n   * Request the browser to enter fullscreen mode.\n   * @returns {boolean} Indicating if the request was successful.\n   */\n  request() {\n    if (this.switchInProgress || this.active || !this.viewer.hasChildNodes()) {\n      return false;\n    }\n    this._addFullscreenChangeListeners();\n    this._setSwitchInProgress();\n    this._notifyStateChange();\n\n    if (this.container.requestFullscreen) {\n      this.container.requestFullscreen();\n    } else if (this.container.mozRequestFullScreen) {\n      this.container.mozRequestFullScreen();\n    } else if (this.container.webkitRequestFullscreen) {\n      this.container.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);\n    } else if (this.container.msRequestFullscreen) {\n      this.container.msRequestFullscreen();\n    } else {\n      return false;\n    }\n\n    this.args = {\n      page: this.pdfViewer.currentPageNumber,\n      previousScale: this.pdfViewer.currentScaleValue,\n    };\n\n    return true;\n  }\n\n  /**\n   * @private\n   */\n  _mouseWheel(evt) {\n    if (!this.active) {\n      return;\n    }\n\n    evt.preventDefault();\n\n    let delta = normalizeWheelEventDelta(evt);\n    let currentTime = (new Date()).getTime();\n    let storedTime = this.mouseScrollTimeStamp;\n\n    // If we've already switched page, avoid accidentally switching again.\n    if (currentTime > storedTime &&\n        currentTime - storedTime < MOUSE_SCROLL_COOLDOWN_TIME) {\n      return;\n    }\n    // If the scroll direction changed, reset the accumulated scroll delta.\n    if ((this.mouseScrollDelta > 0 && delta < 0) ||\n        (this.mouseScrollDelta < 0 && delta > 0)) {\n      this._resetMouseScrollState();\n    }\n    this.mouseScrollDelta += delta;\n\n    if (Math.abs(this.mouseScrollDelta) >= PAGE_SWITCH_THRESHOLD) {\n      let totalDelta = this.mouseScrollDelta;\n      this._resetMouseScrollState();\n      let success = totalDelta > 0 ? this._goToPreviousPage()\n                                   : this._goToNextPage();\n      if (success) {\n        this.mouseScrollTimeStamp = currentTime;\n      }\n    }\n  }\n\n  get isFullscreen() {\n    return !!(document.fullscreenElement || document.mozFullScreen ||\n              document.webkitIsFullScreen || document.msFullscreenElement);\n  }\n\n  /**\n   * @private\n   */\n  _goToPreviousPage() {\n    let page = this.pdfViewer.currentPageNumber;\n    // If we're at the first page, we don't need to do anything.\n    if (page <= 1) {\n      return false;\n    }\n    this.pdfViewer.currentPageNumber = (page - 1);\n    return true;\n  }\n\n  /**\n   * @private\n   */\n  _goToNextPage() {\n    let page = this.pdfViewer.currentPageNumber;\n    // If we're at the last page, we don't need to do anything.\n    if (page >= this.pdfViewer.pagesCount) {\n      return false;\n    }\n    this.pdfViewer.currentPageNumber = (page + 1);\n    return true;\n  }\n\n  /**\n   * @private\n   */\n  _notifyStateChange() {\n    this.eventBus.dispatch('presentationmodechanged', {\n      source: this,\n      active: this.active,\n      switchInProgress: !!this.switchInProgress,\n    });\n  }\n\n  /**\n   * Used to initialize a timeout when requesting Presentation Mode,\n   * i.e. when the browser is requested to enter fullscreen mode.\n   * This timeout is used to prevent the current page from being scrolled\n   * partially, or completely, out of view when entering Presentation Mode.\n   * NOTE: This issue seems limited to certain zoom levels (e.g. page-width).\n   *\n   * @private\n   */\n  _setSwitchInProgress() {\n    if (this.switchInProgress) {\n      clearTimeout(this.switchInProgress);\n    }\n    this.switchInProgress = setTimeout(() => {\n      this._removeFullscreenChangeListeners();\n      delete this.switchInProgress;\n      this._notifyStateChange();\n    }, DELAY_BEFORE_RESETTING_SWITCH_IN_PROGRESS);\n  }\n\n  /**\n   * @private\n   */\n  _resetSwitchInProgress() {\n    if (this.switchInProgress) {\n      clearTimeout(this.switchInProgress);\n      delete this.switchInProgress;\n    }\n  }\n\n  /**\n   * @private\n   */\n  _enter() {\n    this.active = true;\n    this._resetSwitchInProgress();\n    this._notifyStateChange();\n    this.container.classList.add(ACTIVE_SELECTOR);\n\n    // Ensure that the correct page is scrolled into view when entering\n    // Presentation Mode, by waiting until fullscreen mode in enabled.\n    setTimeout(() => {\n      this.pdfViewer.currentPageNumber = this.args.page;\n      this.pdfViewer.currentScaleValue = 'page-fit';\n    }, 0);\n\n    this._addWindowListeners();\n    this._showControls();\n    this.contextMenuOpen = false;\n    this.container.setAttribute('contextmenu', 'viewerContextMenu');\n\n    // Text selection is disabled in Presentation Mode, thus it's not possible\n    // for the user to deselect text that is selected (e.g. with \"Select all\")\n    // when entering Presentation Mode, hence we remove any active selection.\n    window.getSelection().removeAllRanges();\n  }\n\n  /**\n   * @private\n   */\n  _exit() {\n    let page = this.pdfViewer.currentPageNumber;\n    this.container.classList.remove(ACTIVE_SELECTOR);\n\n    // Ensure that the correct page is scrolled into view when exiting\n    // Presentation Mode, by waiting until fullscreen mode is disabled.\n    setTimeout(() => {\n      this.active = false;\n      this._removeFullscreenChangeListeners();\n      this._notifyStateChange();\n\n      this.pdfViewer.currentScaleValue = this.args.previousScale;\n      this.pdfViewer.currentPageNumber = page;\n      this.args = null;\n    }, 0);\n\n    this._removeWindowListeners();\n    this._hideControls();\n    this._resetMouseScrollState();\n    this.container.removeAttribute('contextmenu');\n    this.contextMenuOpen = false;\n  }\n\n  /**\n   * @private\n   */\n  _mouseDown(evt) {\n    if (this.contextMenuOpen) {\n      this.contextMenuOpen = false;\n      evt.preventDefault();\n      return;\n    }\n    if (evt.button === 0) {\n      // Enable clicking of links in presentation mode. Note: only links\n      // pointing to destinations in the current PDF document work.\n      let isInternalLink = (evt.target.href &&\n                            evt.target.classList.contains('internalLink'));\n      if (!isInternalLink) {\n        // Unless an internal link was clicked, advance one page.\n        evt.preventDefault();\n\n        if (evt.shiftKey) {\n          this._goToPreviousPage();\n        } else {\n          this._goToNextPage();\n        }\n      }\n    }\n  }\n\n  /**\n   * @private\n   */\n  _contextMenu() {\n    this.contextMenuOpen = true;\n  }\n\n  /**\n   * @private\n   */\n  _showControls() {\n    if (this.controlsTimeout) {\n      clearTimeout(this.controlsTimeout);\n    } else {\n      this.container.classList.add(CONTROLS_SELECTOR);\n    }\n    this.controlsTimeout = setTimeout(() => {\n      this.container.classList.remove(CONTROLS_SELECTOR);\n      delete this.controlsTimeout;\n    }, DELAY_BEFORE_HIDING_CONTROLS);\n  }\n\n  /**\n   * @private\n   */\n  _hideControls() {\n    if (!this.controlsTimeout) {\n      return;\n    }\n    clearTimeout(this.controlsTimeout);\n    this.container.classList.remove(CONTROLS_SELECTOR);\n    delete this.controlsTimeout;\n  }\n\n  /**\n   * Resets the properties used for tracking mouse scrolling events.\n   *\n   * @private\n   */\n  _resetMouseScrollState() {\n    this.mouseScrollTimeStamp = 0;\n    this.mouseScrollDelta = 0;\n  }\n\n  /**\n   * @private\n   */\n  _touchSwipe(evt) {\n    if (!this.active) {\n      return;\n    }\n    if (evt.touches.length > 1) {\n      // Multiple touch points detected; cancel the swipe.\n      this.touchSwipeState = null;\n      return;\n    }\n\n    switch (evt.type) {\n      case 'touchstart':\n        this.touchSwipeState = {\n          startX: evt.touches[0].pageX,\n          startY: evt.touches[0].pageY,\n          endX: evt.touches[0].pageX,\n          endY: evt.touches[0].pageY,\n        };\n        break;\n      case 'touchmove':\n        if (this.touchSwipeState === null) {\n          return;\n        }\n        this.touchSwipeState.endX = evt.touches[0].pageX;\n        this.touchSwipeState.endY = evt.touches[0].pageY;\n        // Avoid the swipe from triggering browser gestures (Chrome in\n        // particular has some sort of swipe gesture in fullscreen mode).\n        evt.preventDefault();\n        break;\n      case 'touchend':\n        if (this.touchSwipeState === null) {\n          return;\n        }\n        let delta = 0;\n        let dx = this.touchSwipeState.endX - this.touchSwipeState.startX;\n        let dy = this.touchSwipeState.endY - this.touchSwipeState.startY;\n        let absAngle = Math.abs(Math.atan2(dy, dx));\n        if (Math.abs(dx) > SWIPE_MIN_DISTANCE_THRESHOLD &&\n            (absAngle <= SWIPE_ANGLE_THRESHOLD ||\n             absAngle >= (Math.PI - SWIPE_ANGLE_THRESHOLD))) {\n          // Horizontal swipe.\n          delta = dx;\n        } else if (Math.abs(dy) > SWIPE_MIN_DISTANCE_THRESHOLD &&\n            Math.abs(absAngle - (Math.PI / 2)) <= SWIPE_ANGLE_THRESHOLD) {\n          // Vertical swipe.\n          delta = dy;\n        }\n        if (delta > 0) {\n          this._goToPreviousPage();\n        } else if (delta < 0) {\n          this._goToNextPage();\n        }\n        break;\n    }\n  }\n\n  /**\n   * @private\n   */\n  _addWindowListeners() {\n    this.showControlsBind = this._showControls.bind(this);\n    this.mouseDownBind = this._mouseDown.bind(this);\n    this.mouseWheelBind = this._mouseWheel.bind(this);\n    this.resetMouseScrollStateBind = this._resetMouseScrollState.bind(this);\n    this.contextMenuBind = this._contextMenu.bind(this);\n    this.touchSwipeBind = this._touchSwipe.bind(this);\n\n    window.addEventListener('mousemove', this.showControlsBind);\n    window.addEventListener('mousedown', this.mouseDownBind);\n    window.addEventListener('wheel', this.mouseWheelBind);\n    window.addEventListener('keydown', this.resetMouseScrollStateBind);\n    window.addEventListener('contextmenu', this.contextMenuBind);\n    window.addEventListener('touchstart', this.touchSwipeBind);\n    window.addEventListener('touchmove', this.touchSwipeBind);\n    window.addEventListener('touchend', this.touchSwipeBind);\n  }\n\n  /**\n   * @private\n   */\n  _removeWindowListeners() {\n    window.removeEventListener('mousemove', this.showControlsBind);\n    window.removeEventListener('mousedown', this.mouseDownBind);\n    window.removeEventListener('wheel', this.mouseWheelBind);\n    window.removeEventListener('keydown', this.resetMouseScrollStateBind);\n    window.removeEventListener('contextmenu', this.contextMenuBind);\n    window.removeEventListener('touchstart', this.touchSwipeBind);\n    window.removeEventListener('touchmove', this.touchSwipeBind);\n    window.removeEventListener('touchend', this.touchSwipeBind);\n\n    delete this.showControlsBind;\n    delete this.mouseDownBind;\n    delete this.mouseWheelBind;\n    delete this.resetMouseScrollStateBind;\n    delete this.contextMenuBind;\n    delete this.touchSwipeBind;\n  }\n\n  /**\n   * @private\n   */\n  _fullscreenChange() {\n    if (this.isFullscreen) {\n      this._enter();\n    } else {\n      this._exit();\n    }\n  }\n\n  /**\n   * @private\n   */\n  _addFullscreenChangeListeners() {\n    this.fullscreenChangeBind = this._fullscreenChange.bind(this);\n\n    window.addEventListener('fullscreenchange', this.fullscreenChangeBind);\n    window.addEventListener('mozfullscreenchange', this.fullscreenChangeBind);\n    if (typeof PDFJSDev === 'undefined' ||\n        !PDFJSDev.test('FIREFOX || MOZCENTRAL')) {\n      window.addEventListener('webkitfullscreenchange',\n                              this.fullscreenChangeBind);\n      window.addEventListener('MSFullscreenChange',\n                              this.fullscreenChangeBind);\n    }\n  }\n\n  /**\n   * @private\n   */\n  _removeFullscreenChangeListeners() {\n    window.removeEventListener('fullscreenchange', this.fullscreenChangeBind);\n    window.removeEventListener('mozfullscreenchange',\n                               this.fullscreenChangeBind);\n    if (typeof PDFJSDev === 'undefined' ||\n        !PDFJSDev.test('FIREFOX || MOZCENTRAL')) {\n      window.removeEventListener('webkitfullscreenchange',\n                                 this.fullscreenChangeBind);\n      window.removeEventListener('MSFullscreenChange',\n                                 this.fullscreenChangeBind);\n    }\n\n    delete this.fullscreenChangeBind;\n  }\n}\n\nexport {\n  PDFPresentationMode,\n};\n","/* Copyright 2017 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { NullL10n } from './ui_utils';\n\nconst SIDEBAR_WIDTH_VAR = '--sidebar-width';\nconst SIDEBAR_MIN_WIDTH = 200; // pixels\nconst SIDEBAR_RESIZING_CLASS = 'sidebarResizing';\n\n/**\n * @typedef {Object} PDFSidebarResizerOptions\n * @property {HTMLDivElement} outerContainer - The outer container\n *   (encasing both the viewer and sidebar elements).\n * @property {HTMLDivElement} resizer - The DOM element that can be dragged in\n *   order to adjust the width of the sidebar.\n */\n\nclass PDFSidebarResizer {\n  /**\n   * @param {PDFSidebarResizerOptions} options\n   * @param {EventBus} eventBus - The application event bus.\n   * @param {IL10n} l10n - Localization service.\n   */\n  constructor(options, eventBus, l10n = NullL10n) {\n    this.enabled = false;\n    this.isRTL = false;\n    this.sidebarOpen = false;\n    this.doc = document.documentElement;\n    this._width = null;\n    this._outerContainerWidth = null;\n    this._boundEvents = Object.create(null);\n\n    this.outerContainer = options.outerContainer;\n    this.resizer = options.resizer;\n    this.eventBus = eventBus;\n    this.l10n = l10n;\n\n    if (typeof CSS === 'undefined' || typeof CSS.supports !== 'function' ||\n        !CSS.supports(SIDEBAR_WIDTH_VAR, `calc(-1 * ${SIDEBAR_MIN_WIDTH}px)`)) {\n      console.warn('PDFSidebarResizer: ' +\n                   'The browser does not support resizing of the sidebar.');\n      return;\n    }\n    this.enabled = true;\n    this.resizer.classList.remove('hidden'); // Show the resizer DOM element.\n\n    this.l10n.getDirection().then((dir) => {\n      this.isRTL = (dir === 'rtl');\n    });\n    this._addEventListeners();\n  }\n\n  /**\n   * returns {number}\n   */\n  get outerContainerWidth() {\n    if (!this._outerContainerWidth) {\n      this._outerContainerWidth = this.outerContainer.clientWidth;\n    }\n    return this._outerContainerWidth;\n  }\n\n  /**\n   * @private\n   * returns {boolean} Indicating if the sidebar width was updated.\n   */\n  _updateWidth(width = 0) {\n    if (!this.enabled) {\n      return false;\n    }\n    // Prevent the sidebar from becoming too narrow, or from occupying more\n    // than half of the available viewer width.\n    const maxWidth = Math.floor(this.outerContainerWidth / 2);\n    if (width > maxWidth) {\n      width = maxWidth;\n    }\n    if (width < SIDEBAR_MIN_WIDTH) {\n      width = SIDEBAR_MIN_WIDTH;\n    }\n    // Only update the UI when the sidebar width did in fact change.\n    if (width === this._width) {\n      return false;\n    }\n    this._width = width;\n    this.doc.style.setProperty(SIDEBAR_WIDTH_VAR, `${width}px`);\n    return true;\n  }\n\n  /**\n   * @private\n   */\n  _mouseMove(evt) {\n    let width = evt.clientX;\n    // For sidebar resizing to work correctly in RTL mode, invert the width.\n    if (this.isRTL) {\n      width = this.outerContainerWidth - width;\n    }\n    this._updateWidth(width);\n  }\n\n  /**\n   * @private\n   */\n  _mouseUp(evt) {\n    // Re-enable the `transition-duration` rules when sidebar resizing ends...\n    this.outerContainer.classList.remove(SIDEBAR_RESIZING_CLASS);\n    // ... and ensure that rendering will always be triggered.\n    this.eventBus.dispatch('resize', { source: this, });\n\n    let _boundEvents = this._boundEvents;\n    window.removeEventListener('mousemove', _boundEvents.mouseMove);\n    window.removeEventListener('mouseup', _boundEvents.mouseUp);\n  }\n\n  /**\n   * @private\n   */\n  _addEventListeners() {\n    if (!this.enabled) {\n      return;\n    }\n    let _boundEvents = this._boundEvents;\n    _boundEvents.mouseMove = this._mouseMove.bind(this);\n    _boundEvents.mouseUp = this._mouseUp.bind(this);\n\n    this.resizer.addEventListener('mousedown', (evt) => {\n      if (evt.button !== 0) {\n        return;\n      }\n      // Disable the `transition-duration` rules when sidebar resizing begins,\n      // in order to improve responsiveness and to avoid visual glitches.\n      this.outerContainer.classList.add(SIDEBAR_RESIZING_CLASS);\n\n      window.addEventListener('mousemove', _boundEvents.mouseMove);\n      window.addEventListener('mouseup', _boundEvents.mouseUp);\n    });\n\n    this.eventBus.on('sidebarviewchanged', (evt) => {\n      this.sidebarOpen = !!(evt && evt.view);\n    });\n\n    this.eventBus.on('resize', (evt) => {\n      // When the *entire* viewer is resized, such that it becomes narrower,\n      // ensure that the sidebar doesn't end up being too wide.\n      if (evt && evt.source === window) {\n        // Always reset the cached width when the viewer is resized.\n        this._outerContainerWidth = null;\n\n        if (this._width) {\n          // NOTE: If the sidebar is closed, we don't need to worry about\n          //       visual glitches nor ensure that rendering is triggered.\n          if (this.sidebarOpen) {\n            this.outerContainer.classList.add(SIDEBAR_RESIZING_CLASS);\n            let updated = this._updateWidth(this._width);\n\n            Promise.resolve().then(() => {\n              this.outerContainer.classList.remove(SIDEBAR_RESIZING_CLASS);\n              // Trigger rendering if the sidebar width changed, to avoid\n              // depending on the order in which 'resize' events are handled.\n              if (updated) {\n                this.eventBus.dispatch('resize', { source: this, });\n              }\n            });\n          } else {\n            this._updateWidth(this._width);\n          }\n        }\n      }\n    });\n  }\n}\n\nexport {\n  PDFSidebarResizer,\n};\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  getVisibleElements, isValidRotation, NullL10n, scrollIntoView, watchScroll\n} from './ui_utils';\nimport { PDFThumbnailView } from './pdf_thumbnail_view';\n\nconst THUMBNAIL_SCROLL_MARGIN = -19;\nconst THUMBNAIL_SELECTED_CLASS = 'selected';\n\n/**\n * @typedef {Object} PDFThumbnailViewerOptions\n * @property {HTMLDivElement} container - The container for the thumbnail\n *   elements.\n * @property {IPDFLinkService} linkService - The navigation/linking service.\n * @property {PDFRenderingQueue} renderingQueue - The rendering queue object.\n * @property {IL10n} l10n - Localization service.\n */\n\n/**\n * Viewer control to display thumbnails for pages in a PDF document.\n *\n * @implements {IRenderableView}\n */\nclass PDFThumbnailViewer {\n  /**\n   * @param {PDFThumbnailViewerOptions} options\n   */\n  constructor({ container, linkService, renderingQueue, l10n = NullL10n, }) {\n    this.container = container;\n    this.linkService = linkService;\n    this.renderingQueue = renderingQueue;\n    this.l10n = l10n;\n\n    this.scroll = watchScroll(this.container, this._scrollUpdated.bind(this));\n    this._resetView();\n  }\n\n  /**\n   * @private\n   */\n  _scrollUpdated() {\n    this.renderingQueue.renderHighestPriority();\n  }\n\n  getThumbnail(index) {\n    return this._thumbnails[index];\n  }\n\n  /**\n   * @private\n   */\n  _getVisibleThumbs() {\n    return getVisibleElements(this.container, this._thumbnails);\n  }\n\n  scrollThumbnailIntoView(pageNumber) {\n    if (!this.pdfDocument) {\n      return;\n    }\n    const thumbnailView = this._thumbnails[pageNumber - 1];\n\n    if (!thumbnailView) {\n      console.error('scrollThumbnailIntoView: Invalid \"pageNumber\" parameter.');\n      return;\n    }\n\n    if (pageNumber !== this._currentPageNumber) {\n      const prevThumbnailView = this._thumbnails[this._currentPageNumber - 1];\n      // Remove the highlight from the previous thumbnail...\n      prevThumbnailView.div.classList.remove(THUMBNAIL_SELECTED_CLASS);\n      // ... and add the highlight to the new thumbnail.\n      thumbnailView.div.classList.add(THUMBNAIL_SELECTED_CLASS);\n    }\n    let visibleThumbs = this._getVisibleThumbs();\n    let numVisibleThumbs = visibleThumbs.views.length;\n\n    // If the thumbnail isn't currently visible, scroll it into view.\n    if (numVisibleThumbs > 0) {\n      let first = visibleThumbs.first.id;\n      // Account for only one thumbnail being visible.\n      let last = (numVisibleThumbs > 1 ? visibleThumbs.last.id : first);\n\n      let shouldScroll = false;\n      if (pageNumber <= first || pageNumber >= last) {\n        shouldScroll = true;\n      } else {\n        visibleThumbs.views.some(function(view) {\n          if (view.id !== pageNumber) {\n            return false;\n          }\n          shouldScroll = view.percent < 100;\n          return true;\n        });\n      }\n      if (shouldScroll) {\n        scrollIntoView(thumbnailView.div, { top: THUMBNAIL_SCROLL_MARGIN, });\n      }\n    }\n\n    this._currentPageNumber = pageNumber;\n  }\n\n  get pagesRotation() {\n    return this._pagesRotation;\n  }\n\n  set pagesRotation(rotation) {\n    if (!isValidRotation(rotation)) {\n      throw new Error('Invalid thumbnails rotation angle.');\n    }\n    if (!this.pdfDocument) {\n      return;\n    }\n    if (this._pagesRotation === rotation) {\n      return; // The rotation didn't change.\n    }\n    this._pagesRotation = rotation;\n\n    for (let i = 0, ii = this._thumbnails.length; i < ii; i++) {\n      this._thumbnails[i].update(rotation);\n    }\n  }\n\n  cleanup() {\n    PDFThumbnailView.cleanup();\n  }\n\n  /**\n   * @private\n   */\n  _resetView() {\n    this._thumbnails = [];\n    this._currentPageNumber = 1;\n    this._pageLabels = null;\n    this._pagesRotation = 0;\n    this._pagesRequests = [];\n\n    // Remove the thumbnails from the DOM.\n    this.container.textContent = '';\n  }\n\n  setDocument(pdfDocument) {\n    if (this.pdfDocument) {\n      this._cancelRendering();\n      this._resetView();\n    }\n\n    this.pdfDocument = pdfDocument;\n    if (!pdfDocument) {\n      return;\n    }\n\n    pdfDocument.getPage(1).then((firstPage) => {\n      let pagesCount = pdfDocument.numPages;\n      let viewport = firstPage.getViewport({ scale: 1, });\n      for (let pageNum = 1; pageNum <= pagesCount; ++pageNum) {\n        let thumbnail = new PDFThumbnailView({\n          container: this.container,\n          id: pageNum,\n          defaultViewport: viewport.clone(),\n          linkService: this.linkService,\n          renderingQueue: this.renderingQueue,\n          disableCanvasToImageConversion: false,\n          l10n: this.l10n,\n        });\n        this._thumbnails.push(thumbnail);\n      }\n\n      // Ensure that the current thumbnail is always highlighted on load.\n      const thumbnailView = this._thumbnails[this._currentPageNumber - 1];\n      thumbnailView.div.classList.add(THUMBNAIL_SELECTED_CLASS);\n    }).catch((reason) => {\n      console.error('Unable to initialize thumbnail viewer', reason);\n    });\n  }\n\n  /**\n   * @private\n   */\n  _cancelRendering() {\n    for (let i = 0, ii = this._thumbnails.length; i < ii; i++) {\n      if (this._thumbnails[i]) {\n        this._thumbnails[i].cancelRendering();\n      }\n    }\n  }\n\n  /**\n   * @param {Array|null} labels\n   */\n  setPageLabels(labels) {\n    if (!this.pdfDocument) {\n      return;\n    }\n    if (!labels) {\n      this._pageLabels = null;\n    } else if (!(Array.isArray(labels) &&\n                 this.pdfDocument.numPages === labels.length)) {\n      this._pageLabels = null;\n      console.error('PDFThumbnailViewer_setPageLabels: Invalid page labels.');\n    } else {\n      this._pageLabels = labels;\n    }\n    // Update all the `PDFThumbnailView` instances.\n    for (let i = 0, ii = this._thumbnails.length; i < ii; i++) {\n      let label = this._pageLabels && this._pageLabels[i];\n      this._thumbnails[i].setPageLabel(label);\n    }\n  }\n\n  /**\n   * @param {PDFThumbnailView} thumbView\n   * @returns {PDFPage}\n   * @private\n   */\n  _ensurePdfPageLoaded(thumbView) {\n    if (thumbView.pdfPage) {\n      return Promise.resolve(thumbView.pdfPage);\n    }\n    let pageNumber = thumbView.id;\n    if (this._pagesRequests[pageNumber]) {\n      return this._pagesRequests[pageNumber];\n    }\n    let promise = this.pdfDocument.getPage(pageNumber).then((pdfPage) => {\n      thumbView.setPdfPage(pdfPage);\n      this._pagesRequests[pageNumber] = null;\n      return pdfPage;\n    }).catch((reason) => {\n      console.error('Unable to get page for thumb view', reason);\n      // Page error -- there is nothing can be done.\n      this._pagesRequests[pageNumber] = null;\n    });\n    this._pagesRequests[pageNumber] = promise;\n    return promise;\n  }\n\n  forceRendering() {\n    let visibleThumbs = this._getVisibleThumbs();\n    let thumbView = this.renderingQueue.getHighestPriority(visibleThumbs,\n                                                           this._thumbnails,\n                                                           this.scroll.down);\n    if (thumbView) {\n      this._ensurePdfPageLoaded(thumbView).then(() => {\n        this.renderingQueue.renderView(thumbView);\n      });\n      return true;\n    }\n    return false;\n  }\n}\n\nexport {\n  PDFThumbnailViewer,\n};\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  createPromiseCapability, RenderingCancelledException\n} from 'pdfjs-lib';\nimport { getOutputScale, NullL10n } from './ui_utils';\nimport { RenderingStates } from './pdf_rendering_queue';\n\nconst MAX_NUM_SCALING_STEPS = 3;\nconst THUMBNAIL_CANVAS_BORDER_WIDTH = 1; // px\nconst THUMBNAIL_WIDTH = 98; // px\n\n/**\n * @typedef {Object} PDFThumbnailViewOptions\n * @property {HTMLDivElement} container - The viewer element.\n * @property {number} id - The thumbnail's unique ID (normally its number).\n * @property {PageViewport} defaultViewport - The page viewport.\n * @property {IPDFLinkService} linkService - The navigation/linking service.\n * @property {PDFRenderingQueue} renderingQueue - The rendering queue object.\n * @property {boolean} disableCanvasToImageConversion - (optional) Don't convert\n *   the canvas thumbnails to images. This prevents `toDataURL` calls,\n *   but increases the overall memory usage. The default value is `false`.\n * @property {IL10n} l10n - Localization service.\n */\n\nconst TempImageFactory = (function TempImageFactoryClosure() {\n  let tempCanvasCache = null;\n\n  return {\n    getCanvas(width, height) {\n      let tempCanvas = tempCanvasCache;\n      if (!tempCanvas) {\n        tempCanvas = document.createElement('canvas');\n        tempCanvasCache = tempCanvas;\n      }\n      tempCanvas.width = width;\n      tempCanvas.height = height;\n\n      // Since this is a temporary canvas, we need to fill it with a white\n      // background ourselves. `_getPageDrawContext` uses CSS rules for this.\n      if (typeof PDFJSDev === 'undefined' ||\n          PDFJSDev.test('MOZCENTRAL || FIREFOX || GENERIC')) {\n        tempCanvas.mozOpaque = true;\n      }\n\n      let ctx = tempCanvas.getContext('2d', { alpha: false, });\n      ctx.save();\n      ctx.fillStyle = 'rgb(255, 255, 255)';\n      ctx.fillRect(0, 0, width, height);\n      ctx.restore();\n      return tempCanvas;\n    },\n\n    destroyCanvas() {\n      let tempCanvas = tempCanvasCache;\n      if (tempCanvas) {\n        // Zeroing the width and height causes Firefox to release graphics\n        // resources immediately, which can greatly reduce memory consumption.\n        tempCanvas.width = 0;\n        tempCanvas.height = 0;\n      }\n      tempCanvasCache = null;\n    },\n  };\n})();\n\n/**\n * @implements {IRenderableView}\n */\nclass PDFThumbnailView {\n  /**\n   * @param {PDFThumbnailViewOptions} options\n   */\n  constructor({ container, id, defaultViewport, linkService, renderingQueue,\n                disableCanvasToImageConversion = false, l10n = NullL10n, }) {\n    this.id = id;\n    this.renderingId = 'thumbnail' + id;\n    this.pageLabel = null;\n\n    this.pdfPage = null;\n    this.rotation = 0;\n    this.viewport = defaultViewport;\n    this.pdfPageRotate = defaultViewport.rotation;\n\n    this.linkService = linkService;\n    this.renderingQueue = renderingQueue;\n\n    this.renderTask = null;\n    this.renderingState = RenderingStates.INITIAL;\n    this.resume = null;\n    this.disableCanvasToImageConversion = disableCanvasToImageConversion;\n\n    this.pageWidth = this.viewport.width;\n    this.pageHeight = this.viewport.height;\n    this.pageRatio = this.pageWidth / this.pageHeight;\n\n    this.canvasWidth = THUMBNAIL_WIDTH;\n    this.canvasHeight = (this.canvasWidth / this.pageRatio) | 0;\n    this.scale = this.canvasWidth / this.pageWidth;\n\n    this.l10n = l10n;\n\n    let anchor = document.createElement('a');\n    anchor.href = linkService.getAnchorUrl('#page=' + id);\n    this.l10n.get('thumb_page_title', { page: id, }, 'Page {{page}}').\n        then((msg) => {\n      anchor.title = msg;\n    });\n    anchor.onclick = function() {\n      linkService.page = id;\n      return false;\n    };\n    this.anchor = anchor;\n\n    let div = document.createElement('div');\n    div.className = 'thumbnail';\n    div.setAttribute('data-page-number', this.id);\n    this.div = div;\n\n    let ring = document.createElement('div');\n    ring.className = 'thumbnailSelectionRing';\n    let borderAdjustment = 2 * THUMBNAIL_CANVAS_BORDER_WIDTH;\n    ring.style.width = this.canvasWidth + borderAdjustment + 'px';\n    ring.style.height = this.canvasHeight + borderAdjustment + 'px';\n    this.ring = ring;\n\n    div.appendChild(ring);\n    anchor.appendChild(div);\n    container.appendChild(anchor);\n  }\n\n  setPdfPage(pdfPage) {\n    this.pdfPage = pdfPage;\n    this.pdfPageRotate = pdfPage.rotate;\n    let totalRotation = (this.rotation + this.pdfPageRotate) % 360;\n    this.viewport = pdfPage.getViewport({ scale: 1, rotation: totalRotation, });\n    this.reset();\n  }\n\n  reset() {\n    this.cancelRendering();\n    this.renderingState = RenderingStates.INITIAL;\n\n    this.pageWidth = this.viewport.width;\n    this.pageHeight = this.viewport.height;\n    this.pageRatio = this.pageWidth / this.pageHeight;\n\n    this.canvasHeight = (this.canvasWidth / this.pageRatio) | 0;\n    this.scale = (this.canvasWidth / this.pageWidth);\n\n    this.div.removeAttribute('data-loaded');\n    let ring = this.ring;\n    let childNodes = ring.childNodes;\n    for (let i = childNodes.length - 1; i >= 0; i--) {\n      ring.removeChild(childNodes[i]);\n    }\n    let borderAdjustment = 2 * THUMBNAIL_CANVAS_BORDER_WIDTH;\n    ring.style.width = this.canvasWidth + borderAdjustment + 'px';\n    ring.style.height = this.canvasHeight + borderAdjustment + 'px';\n\n    if (this.canvas) {\n      // Zeroing the width and height causes Firefox to release graphics\n      // resources immediately, which can greatly reduce memory consumption.\n      this.canvas.width = 0;\n      this.canvas.height = 0;\n      delete this.canvas;\n    }\n    if (this.image) {\n      this.image.removeAttribute('src');\n      delete this.image;\n    }\n  }\n\n  update(rotation) {\n    if (typeof rotation !== 'undefined') {\n      this.rotation = rotation;\n    }\n    let totalRotation = (this.rotation + this.pdfPageRotate) % 360;\n    this.viewport = this.viewport.clone({\n      scale: 1,\n      rotation: totalRotation,\n    });\n    this.reset();\n  }\n\n  /**\n   * PLEASE NOTE: Most likely you want to use the `this.reset()` method,\n   *              rather than calling this one directly.\n   */\n  cancelRendering() {\n    if (this.renderTask) {\n      this.renderTask.cancel();\n      this.renderTask = null;\n    }\n    this.resume = null;\n  }\n\n  /**\n   * @private\n   */\n  _getPageDrawContext(noCtxScale = false) {\n    let canvas = document.createElement('canvas');\n    // Keep the no-thumbnail outline visible, i.e. `data-loaded === false`,\n    // until rendering/image conversion is complete, to avoid display issues.\n    this.canvas = canvas;\n\n    if (typeof PDFJSDev === 'undefined' ||\n        PDFJSDev.test('MOZCENTRAL || FIREFOX || GENERIC')) {\n      canvas.mozOpaque = true;\n    }\n    let ctx = canvas.getContext('2d', { alpha: false, });\n    let outputScale = getOutputScale(ctx);\n\n    canvas.width = (this.canvasWidth * outputScale.sx) | 0;\n    canvas.height = (this.canvasHeight * outputScale.sy) | 0;\n    canvas.style.width = this.canvasWidth + 'px';\n    canvas.style.height = this.canvasHeight + 'px';\n\n    if (!noCtxScale && outputScale.scaled) {\n      ctx.scale(outputScale.sx, outputScale.sy);\n    }\n    return ctx;\n  }\n\n  /**\n   * @private\n   */\n  _convertCanvasToImage() {\n    if (!this.canvas) {\n      return;\n    }\n    if (this.renderingState !== RenderingStates.FINISHED) {\n      return;\n    }\n    let id = this.renderingId;\n    let className = 'thumbnailImage';\n\n    if (this.disableCanvasToImageConversion) {\n      this.canvas.id = id;\n      this.canvas.className = className;\n      this.l10n.get('thumb_page_canvas', { page: this.pageId, },\n                    'Thumbnail of Page {{page}}').then((msg) => {\n        this.canvas.setAttribute('aria-label', msg);\n      });\n\n      this.div.setAttribute('data-loaded', true);\n      this.ring.appendChild(this.canvas);\n      return;\n    }\n    let image = document.createElement('img');\n    image.id = id;\n    image.className = className;\n    this.l10n.get('thumb_page_canvas', { page: this.pageId, },\n      'Thumbnail of Page {{page}}').\n        then((msg) => {\n      image.setAttribute('aria-label', msg);\n    });\n\n    image.style.width = this.canvasWidth + 'px';\n    image.style.height = this.canvasHeight + 'px';\n\n    image.src = this.canvas.toDataURL();\n    this.image = image;\n\n    this.div.setAttribute('data-loaded', true);\n    this.ring.appendChild(image);\n\n    // Zeroing the width and height causes Firefox to release graphics\n    // resources immediately, which can greatly reduce memory consumption.\n    this.canvas.width = 0;\n    this.canvas.height = 0;\n    delete this.canvas;\n  }\n\n  draw() {\n    if (this.renderingState !== RenderingStates.INITIAL) {\n      console.error('Must be in new state before drawing');\n      return Promise.resolve(undefined);\n    }\n    this.renderingState = RenderingStates.RUNNING;\n\n    let renderCapability = createPromiseCapability();\n    let finishRenderTask = (error) => {\n      // The renderTask may have been replaced by a new one, so only remove\n      // the reference to the renderTask if it matches the one that is\n      // triggering this callback.\n      if (renderTask === this.renderTask) {\n        this.renderTask = null;\n      }\n\n      if (error instanceof RenderingCancelledException) {\n        renderCapability.resolve(undefined);\n        return;\n      }\n\n      this.renderingState = RenderingStates.FINISHED;\n      this._convertCanvasToImage();\n\n      if (!error) {\n        renderCapability.resolve(undefined);\n      } else {\n        renderCapability.reject(error);\n      }\n    };\n\n    let ctx = this._getPageDrawContext();\n    let drawViewport = this.viewport.clone({ scale: this.scale, });\n    let renderContinueCallback = (cont) => {\n      if (!this.renderingQueue.isHighestPriority(this)) {\n        this.renderingState = RenderingStates.PAUSED;\n        this.resume = () => {\n          this.renderingState = RenderingStates.RUNNING;\n          cont();\n        };\n        return;\n      }\n      cont();\n    };\n\n    let renderContext = {\n      canvasContext: ctx,\n      viewport: drawViewport,\n    };\n    let renderTask = this.renderTask = this.pdfPage.render(renderContext);\n    renderTask.onContinue = renderContinueCallback;\n\n    renderTask.promise.then(function() {\n      finishRenderTask(null);\n    }, function(error) {\n      finishRenderTask(error);\n    });\n    return renderCapability.promise;\n  }\n\n  setImage(pageView) {\n    if (this.renderingState !== RenderingStates.INITIAL) {\n      return;\n    }\n    let img = pageView.canvas;\n    if (!img) {\n      return;\n    }\n    if (!this.pdfPage) {\n      this.setPdfPage(pageView.pdfPage);\n    }\n\n    this.renderingState = RenderingStates.FINISHED;\n\n    let ctx = this._getPageDrawContext(true);\n    let canvas = ctx.canvas;\n    if (img.width <= 2 * canvas.width) {\n      ctx.drawImage(img, 0, 0, img.width, img.height,\n                    0, 0, canvas.width, canvas.height);\n      this._convertCanvasToImage();\n      return;\n    }\n\n    // drawImage does an awful job of rescaling the image, doing it gradually.\n    let reducedWidth = canvas.width << MAX_NUM_SCALING_STEPS;\n    let reducedHeight = canvas.height << MAX_NUM_SCALING_STEPS;\n    let reducedImage = TempImageFactory.getCanvas(reducedWidth,\n                                                  reducedHeight);\n    let reducedImageCtx = reducedImage.getContext('2d');\n\n    while (reducedWidth > img.width || reducedHeight > img.height) {\n      reducedWidth >>= 1;\n      reducedHeight >>= 1;\n    }\n    reducedImageCtx.drawImage(img, 0, 0, img.width, img.height,\n                              0, 0, reducedWidth, reducedHeight);\n    while (reducedWidth > 2 * canvas.width) {\n      reducedImageCtx.drawImage(reducedImage,\n                                0, 0, reducedWidth, reducedHeight,\n                                0, 0, reducedWidth >> 1, reducedHeight >> 1);\n      reducedWidth >>= 1;\n      reducedHeight >>= 1;\n    }\n    ctx.drawImage(reducedImage, 0, 0, reducedWidth, reducedHeight,\n                  0, 0, canvas.width, canvas.height);\n    this._convertCanvasToImage();\n  }\n\n  get pageId() {\n    return (this.pageLabel !== null ? this.pageLabel : this.id);\n  }\n\n  /**\n   * @param {string|null} label\n   */\n  setPageLabel(label) {\n    this.pageLabel = (typeof label === 'string' ? label : null);\n\n    this.l10n.get('thumb_page_title', { page: this.pageId, },\n                  'Page {{page}}').then((msg) => {\n      this.anchor.title = msg;\n    });\n\n    if (this.renderingState !== RenderingStates.FINISHED) {\n      return;\n    }\n\n    this.l10n.get('thumb_page_canvas', { page: this.pageId, },\n                  'Thumbnail of Page {{page}}').then((ariaLabel) => {\n      if (this.image) {\n        this.image.setAttribute('aria-label', ariaLabel);\n      } else if (this.disableCanvasToImageConversion && this.canvas) {\n        this.canvas.setAttribute('aria-label', ariaLabel);\n      }\n    });\n  }\n\n  static cleanup() {\n    TempImageFactory.destroyCanvas();\n  }\n}\n\nexport {\n  PDFThumbnailView,\n};\n","/* Copyright 2014 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { BaseViewer } from './base_viewer';\nimport { shadow } from 'pdfjs-lib';\n\nclass PDFViewer extends BaseViewer {\n  get _setDocumentViewerElement() {\n    return shadow(this, '_setDocumentViewerElement', this.viewer);\n  }\n\n  _scrollIntoView({ pageDiv, pageSpot = null, pageNumber = null, }) {\n    if (!pageSpot && !this.isInPresentationMode) {\n      const left = pageDiv.offsetLeft + pageDiv.clientLeft;\n      const right = left + pageDiv.clientWidth;\n      const { scrollLeft, clientWidth, } = this.container;\n      if (this._isScrollModeHorizontal ||\n          left < scrollLeft || right > scrollLeft + clientWidth) {\n        pageSpot = { left: 0, top: 0, };\n      }\n    }\n    super._scrollIntoView({ pageDiv, pageSpot, pageNumber, });\n  }\n\n  _getVisiblePages() {\n    if (this.isInPresentationMode) {\n      // The algorithm in `getVisibleElements` doesn't work in all browsers and\n      // configurations (e.g. Chrome) when Presentation Mode is active.\n      return this._getCurrentVisiblePage();\n    }\n    return super._getVisiblePages();\n  }\n\n  _updateHelper(visiblePages) {\n    if (this.isInPresentationMode) {\n      return;\n    }\n    let currentId = this._currentPageNumber;\n    let stillFullyVisible = false;\n\n    for (const page of visiblePages) {\n      if (page.percent < 100) {\n        break;\n      }\n      if (page.id === currentId) {\n        stillFullyVisible = true;\n        break;\n      }\n    }\n    if (!stillFullyVisible) {\n      currentId = visiblePages[0].id;\n    }\n    this._setCurrentPageNumber(currentId);\n  }\n}\n\nexport {\n  PDFViewer,\n};\n","/* Copyright 2014 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  CSS_UNITS, DEFAULT_SCALE, DEFAULT_SCALE_VALUE, getGlobalEventBus,\n  getVisibleElements, isPortraitOrientation, isValidRotation, isValidScrollMode,\n  isValidSpreadMode, MAX_AUTO_SCALE, moveToEndOfArray, NullL10n,\n  PresentationModeState, RendererType, SCROLLBAR_PADDING, scrollIntoView,\n  ScrollMode, SpreadMode, TextLayerMode, UNKNOWN_SCALE, VERTICAL_PADDING,\n  watchScroll\n} from './ui_utils';\nimport { PDFRenderingQueue, RenderingStates } from './pdf_rendering_queue';\nimport { AnnotationLayerBuilder } from './annotation_layer_builder';\nimport { createPromiseCapability } from 'pdfjs-lib';\nimport { PDFPageView } from './pdf_page_view';\nimport { SimpleLinkService } from './pdf_link_service';\nimport { TextLayerBuilder } from './text_layer_builder';\n\nconst DEFAULT_CACHE_SIZE = 10;\n\n/**\n * @typedef {Object} PDFViewerOptions\n * @property {HTMLDivElement} container - The container for the viewer element.\n * @property {HTMLDivElement} viewer - (optional) The viewer element.\n * @property {EventBus} eventBus - The application event bus.\n * @property {IPDFLinkService} linkService - The navigation/linking service.\n * @property {DownloadManager} downloadManager - (optional) The download\n *   manager component.\n * @property {PDFFindController} findController - (optional) The find\n *   controller component.\n * @property {PDFRenderingQueue} renderingQueue - (optional) The rendering\n *   queue object.\n * @property {boolean} removePageBorders - (optional) Removes the border shadow\n *   around the pages. The default value is `false`.\n * @property {number} textLayerMode - (optional) Controls if the text layer used\n *   for selection and searching is created, and if the improved text selection\n *   behaviour is enabled. The constants from {TextLayerMode} should be used.\n *   The default value is `TextLayerMode.ENABLE`.\n * @property {string} imageResourcesPath - (optional) Path for image resources,\n *   mainly for annotation icons. Include trailing slash.\n * @property {boolean} renderInteractiveForms - (optional) Enables rendering of\n *   interactive form elements. The default is `false`.\n * @property {boolean} enablePrintAutoRotate - (optional) Enables automatic\n *   rotation of pages whose orientation differ from the first page upon\n *   printing. The default is `false`.\n * @property {string} renderer - 'canvas' or 'svg'. The default is 'canvas'.\n * @property {boolean} enableWebGL - (optional) Enables WebGL accelerated\n *   rendering for some operations. The default value is `false`.\n * @property {boolean} useOnlyCssZoom - (optional) Enables CSS only zooming.\n *   The default value is `false`.\n * @property {number} maxCanvasPixels - (optional) The maximum supported canvas\n *   size in total pixels, i.e. width * height. Use -1 for no limit.\n *   The default value is 4096 * 4096 (16 mega-pixels).\n * @property {IL10n} l10n - Localization service.\n */\n\nfunction PDFPageViewBuffer(size) {\n  let data = [];\n  this.push = function(view) {\n    let i = data.indexOf(view);\n    if (i >= 0) {\n      data.splice(i, 1);\n    }\n    data.push(view);\n    if (data.length > size) {\n      data.shift().destroy();\n    }\n  };\n  /**\n   * After calling resize, the size of the buffer will be newSize. The optional\n   * parameter pagesToKeep is, if present, an array of pages to push to the back\n   * of the buffer, delaying their destruction. The size of pagesToKeep has no\n   * impact on the final size of the buffer; if pagesToKeep has length larger\n   * than newSize, some of those pages will be destroyed anyway.\n   */\n  this.resize = function(newSize, pagesToKeep) {\n    size = newSize;\n    if (pagesToKeep) {\n      const pageIdsToKeep = new Set();\n      for (let i = 0, iMax = pagesToKeep.length; i < iMax; ++i) {\n        pageIdsToKeep.add(pagesToKeep[i].id);\n      }\n      moveToEndOfArray(data, function(page) {\n        return pageIdsToKeep.has(page.id);\n      });\n    }\n    while (data.length > size) {\n      data.shift().destroy();\n    }\n  };\n}\n\nfunction isSameScale(oldScale, newScale) {\n  if (newScale === oldScale) {\n    return true;\n  }\n  if (Math.abs(newScale - oldScale) < 1e-15) {\n    // Prevent unnecessary re-rendering of all pages when the scale\n    // changes only because of limited numerical precision.\n    return true;\n  }\n  return false;\n}\n\n/**\n * Simple viewer control to display PDF content/pages.\n * @implements {IRenderableView}\n */\nclass BaseViewer {\n  /**\n   * @param {PDFViewerOptions} options\n   */\n  constructor(options) {\n    if (this.constructor === BaseViewer) {\n      throw new Error('Cannot initialize BaseViewer.');\n    }\n    this._name = this.constructor.name;\n\n    this.container = options.container;\n    this.viewer = options.viewer || options.container.firstElementChild;\n    this.eventBus = options.eventBus || getGlobalEventBus();\n    this.linkService = options.linkService || new SimpleLinkService();\n    this.downloadManager = options.downloadManager || null;\n    this.findController = options.findController || null;\n    this.removePageBorders = options.removePageBorders || false;\n    this.textLayerMode = Number.isInteger(options.textLayerMode) ?\n      options.textLayerMode : TextLayerMode.ENABLE;\n    this.imageResourcesPath = options.imageResourcesPath || '';\n    this.renderInteractiveForms = options.renderInteractiveForms || false;\n    this.enablePrintAutoRotate = options.enablePrintAutoRotate || false;\n    this.renderer = options.renderer || RendererType.CANVAS;\n    this.enableWebGL = options.enableWebGL || false;\n    this.useOnlyCssZoom = options.useOnlyCssZoom || false;\n    this.maxCanvasPixels = options.maxCanvasPixels;\n    this.l10n = options.l10n || NullL10n;\n\n    this.defaultRenderingQueue = !options.renderingQueue;\n    if (this.defaultRenderingQueue) {\n      // Custom rendering queue is not specified, using default one\n      this.renderingQueue = new PDFRenderingQueue();\n      this.renderingQueue.setViewer(this);\n    } else {\n      this.renderingQueue = options.renderingQueue;\n    }\n\n    this.scroll = watchScroll(this.container, this._scrollUpdate.bind(this));\n    this.presentationModeState = PresentationModeState.UNKNOWN;\n    this._onBeforeDraw = this._onAfterDraw = null;\n    this._resetView();\n\n    if (this.removePageBorders) {\n      this.viewer.classList.add('removePageBorders');\n    }\n    // Defer the dispatching of this event, to give other viewer components\n    // time to initialize *and* register 'baseviewerinit' event listeners.\n    Promise.resolve().then(() => {\n      this.eventBus.dispatch('baseviewerinit', { source: this, });\n    });\n  }\n\n  get pagesCount() {\n    return this._pages.length;\n  }\n\n  getPageView(index) {\n    return this._pages[index];\n  }\n\n  /**\n   * @returns {boolean} true if all {PDFPageView} objects are initialized.\n   */\n  get pageViewsReady() {\n    return this._pageViewsReady;\n  }\n\n  /**\n   * @returns {number}\n   */\n  get currentPageNumber() {\n    return this._currentPageNumber;\n  }\n\n  /**\n   * @param {number} val - The page number.\n   */\n  set currentPageNumber(val) {\n    if (!Number.isInteger(val)) {\n      throw new Error('Invalid page number.');\n    }\n    if (!this.pdfDocument) {\n      return;\n    }\n    // The intent can be to just reset a scroll position and/or scale.\n    if (!this._setCurrentPageNumber(val, /* resetCurrentPageView = */ true)) {\n      console.error(\n        `${this._name}.currentPageNumber: \"${val}\" is not a valid page.`);\n    }\n  }\n\n  /**\n   * @return {boolean} Whether the pageNumber is valid (within bounds).\n   * @private\n   */\n  _setCurrentPageNumber(val, resetCurrentPageView = false) {\n    if (this._currentPageNumber === val) {\n      if (resetCurrentPageView) {\n        this._resetCurrentPageView();\n      }\n      return true;\n    }\n\n    if (!(0 < val && val <= this.pagesCount)) {\n      return false;\n    }\n    this._currentPageNumber = val;\n\n    this.eventBus.dispatch('pagechanging', {\n      source: this,\n      pageNumber: val,\n      pageLabel: this._pageLabels && this._pageLabels[val - 1],\n    });\n\n    if (resetCurrentPageView) {\n      this._resetCurrentPageView();\n    }\n    return true;\n  }\n\n  /**\n   * @returns {string|null} Returns the current page label,\n   *                        or `null` if no page labels exist.\n   */\n  get currentPageLabel() {\n    return this._pageLabels && this._pageLabels[this._currentPageNumber - 1];\n  }\n\n  /**\n   * @param {string} val - The page label.\n   */\n  set currentPageLabel(val) {\n    if (!this.pdfDocument) {\n      return;\n    }\n    let page = val | 0; // Fallback page number.\n    if (this._pageLabels) {\n      let i = this._pageLabels.indexOf(val);\n      if (i >= 0) {\n        page = i + 1;\n      }\n    }\n    // The intent can be to just reset a scroll position and/or scale.\n    if (!this._setCurrentPageNumber(page, /* resetCurrentPageView = */ true)) {\n      console.error(\n        `${this._name}.currentPageLabel: \"${val}\" is not a valid page.`);\n    }\n  }\n\n  /**\n   * @returns {number}\n   */\n  get currentScale() {\n    return this._currentScale !== UNKNOWN_SCALE ? this._currentScale :\n                                                  DEFAULT_SCALE;\n  }\n\n  /**\n   * @param {number} val - Scale of the pages in percents.\n   */\n  set currentScale(val) {\n    if (isNaN(val)) {\n      throw new Error('Invalid numeric scale.');\n    }\n    if (!this.pdfDocument) {\n      return;\n    }\n    this._setScale(val, false);\n  }\n\n  /**\n   * @returns {string}\n   */\n  get currentScaleValue() {\n    return this._currentScaleValue;\n  }\n\n  /**\n   * @param val - The scale of the pages (in percent or predefined value).\n   */\n  set currentScaleValue(val) {\n    if (!this.pdfDocument) {\n      return;\n    }\n    this._setScale(val, false);\n  }\n\n  /**\n   * @returns {number}\n   */\n  get pagesRotation() {\n    return this._pagesRotation;\n  }\n\n  /**\n   * @param {number} rotation - The rotation of the pages (0, 90, 180, 270).\n   */\n  set pagesRotation(rotation) {\n    if (!isValidRotation(rotation)) {\n      throw new Error('Invalid pages rotation angle.');\n    }\n    if (!this.pdfDocument) {\n      return;\n    }\n    if (this._pagesRotation === rotation) {\n      return; // The rotation didn't change.\n    }\n    this._pagesRotation = rotation;\n\n    let pageNumber = this._currentPageNumber;\n\n    for (let i = 0, ii = this._pages.length; i < ii; i++) {\n      let pageView = this._pages[i];\n      pageView.update(pageView.scale, rotation);\n    }\n    // Prevent errors in case the rotation changes *before* the scale has been\n    // set to a non-default value.\n    if (this._currentScaleValue) {\n      this._setScale(this._currentScaleValue, true);\n    }\n\n    this.eventBus.dispatch('rotationchanging', {\n      source: this,\n      pagesRotation: rotation,\n      pageNumber,\n    });\n\n    if (this.defaultRenderingQueue) {\n      this.update();\n    }\n  }\n\n  get _setDocumentViewerElement() {\n    // In most viewers, e.g. `PDFViewer`, this should return `this.viewer`.\n    throw new Error('Not implemented: _setDocumentViewerElement');\n  }\n\n  /**\n   * @param pdfDocument {PDFDocument}\n   */\n  setDocument(pdfDocument) {\n    if (this.pdfDocument) {\n      this._cancelRendering();\n      this._resetView();\n\n      if (this.findController) {\n        this.findController.setDocument(null);\n      }\n    }\n\n    this.pdfDocument = pdfDocument;\n    if (!pdfDocument) {\n      return;\n    }\n    let pagesCount = pdfDocument.numPages;\n\n    let pagesCapability = createPromiseCapability();\n    this.pagesPromise = pagesCapability.promise;\n\n    pagesCapability.promise.then(() => {\n      this._pageViewsReady = true;\n      this.eventBus.dispatch('pagesloaded', {\n        source: this,\n        pagesCount,\n      });\n    });\n\n    const onePageRenderedCapability = createPromiseCapability();\n    this.onePageRendered = onePageRenderedCapability.promise;\n\n    const firstPagePromise = pdfDocument.getPage(1);\n    this.firstPagePromise = firstPagePromise;\n\n    this._onBeforeDraw = (evt) => {\n      const pageView = this._pages[evt.pageNumber - 1];\n      if (!pageView) {\n        return;\n      }\n      // Add the page to the buffer at the start of drawing. That way it can be\n      // evicted from the buffer and destroyed even if we pause its rendering.\n      this._buffer.push(pageView);\n    };\n    this.eventBus.on('pagerender', this._onBeforeDraw);\n\n    this._onAfterDraw = (evt) => {\n      if (evt.cssTransform || onePageRenderedCapability.settled) {\n        return;\n      }\n      onePageRenderedCapability.resolve();\n\n      this.eventBus.off('pagerendered', this._onAfterDraw);\n      this._onAfterDraw = null;\n    };\n    this.eventBus.on('pagerendered', this._onAfterDraw);\n\n    // Fetch a single page so we can get a viewport that will be the default\n    // viewport for all pages\n    firstPagePromise.then((pdfPage) => {\n      let scale = this.currentScale;\n      let viewport = pdfPage.getViewport({ scale: scale * CSS_UNITS, });\n      for (let pageNum = 1; pageNum <= pagesCount; ++pageNum) {\n        let textLayerFactory = null;\n        if (this.textLayerMode !== TextLayerMode.DISABLE) {\n          textLayerFactory = this;\n        }\n        let pageView = new PDFPageView({\n          container: this._setDocumentViewerElement,\n          eventBus: this.eventBus,\n          id: pageNum,\n          scale,\n          defaultViewport: viewport.clone(),\n          renderingQueue: this.renderingQueue,\n          textLayerFactory,\n          textLayerMode: this.textLayerMode,\n          annotationLayerFactory: this,\n          imageResourcesPath: this.imageResourcesPath,\n          renderInteractiveForms: this.renderInteractiveForms,\n          renderer: this.renderer,\n          enableWebGL: this.enableWebGL,\n          useOnlyCssZoom: this.useOnlyCssZoom,\n          maxCanvasPixels: this.maxCanvasPixels,\n          l10n: this.l10n,\n        });\n        this._pages.push(pageView);\n      }\n      if (this._spreadMode !== SpreadMode.NONE) {\n        this._updateSpreadMode();\n      }\n\n      // Fetch all the pages since the viewport is needed before printing\n      // starts to create the correct size canvas. Wait until one page is\n      // rendered so we don't tie up too many resources early on.\n      onePageRenderedCapability.promise.then(() => {\n        if (this.findController) {\n          this.findController.setDocument(pdfDocument); // Enable searching.\n        }\n\n        if (pdfDocument.loadingParams['disableAutoFetch']) {\n          // XXX: Printing is semi-broken with auto fetch disabled.\n          pagesCapability.resolve();\n          return;\n        }\n        let getPagesLeft = pagesCount;\n        for (let pageNum = 1; pageNum <= pagesCount; ++pageNum) {\n          pdfDocument.getPage(pageNum).then((pdfPage) => {\n            let pageView = this._pages[pageNum - 1];\n            if (!pageView.pdfPage) {\n              pageView.setPdfPage(pdfPage);\n            }\n            this.linkService.cachePageRef(pageNum, pdfPage.ref);\n            if (--getPagesLeft === 0) {\n              pagesCapability.resolve();\n            }\n          }, (reason) => {\n            console.error(`Unable to get page ${pageNum} to initialize viewer`,\n                          reason);\n            if (--getPagesLeft === 0) {\n              pagesCapability.resolve();\n            }\n          });\n        }\n      });\n\n      this.eventBus.dispatch('pagesinit', { source: this, });\n\n      if (this.defaultRenderingQueue) {\n        this.update();\n      }\n    }).catch((reason) => {\n      console.error('Unable to initialize viewer', reason);\n    });\n  }\n\n  /**\n   * @param {Array|null} labels\n   */\n  setPageLabels(labels) {\n    if (!this.pdfDocument) {\n      return;\n    }\n    if (!labels) {\n      this._pageLabels = null;\n    } else if (!(Array.isArray(labels) &&\n                 this.pdfDocument.numPages === labels.length)) {\n      this._pageLabels = null;\n      console.error(`${this._name}.setPageLabels: Invalid page labels.`);\n    } else {\n      this._pageLabels = labels;\n    }\n    // Update all the `PDFPageView` instances.\n    for (let i = 0, ii = this._pages.length; i < ii; i++) {\n      let pageView = this._pages[i];\n      let label = this._pageLabels && this._pageLabels[i];\n      pageView.setPageLabel(label);\n    }\n  }\n\n  _resetView() {\n    this._pages = [];\n    this._currentPageNumber = 1;\n    this._currentScale = UNKNOWN_SCALE;\n    this._currentScaleValue = null;\n    this._pageLabels = null;\n    this._buffer = new PDFPageViewBuffer(DEFAULT_CACHE_SIZE);\n    this._location = null;\n    this._pagesRotation = 0;\n    this._pagesRequests = [];\n    this._pageViewsReady = false;\n    this._scrollMode = ScrollMode.VERTICAL;\n    this._spreadMode = SpreadMode.NONE;\n\n    if (this._onBeforeDraw) {\n      this.eventBus.off('pagerender', this._onBeforeDraw);\n      this._onBeforeDraw = null;\n    }\n    if (this._onAfterDraw) {\n      this.eventBus.off('pagerendered', this._onAfterDraw);\n      this._onAfterDraw = null;\n    }\n    // Remove the pages from the DOM...\n    this.viewer.textContent = '';\n    // ... and reset the Scroll mode CSS class(es) afterwards.\n    this._updateScrollMode();\n  }\n\n  _scrollUpdate() {\n    if (this.pagesCount === 0) {\n      return;\n    }\n    this.update();\n  }\n\n  _scrollIntoView({ pageDiv, pageSpot = null, pageNumber = null, }) {\n    scrollIntoView(pageDiv, pageSpot);\n  }\n\n  _setScaleUpdatePages(newScale, newValue, noScroll = false, preset = false) {\n    this._currentScaleValue = newValue.toString();\n\n    if (isSameScale(this._currentScale, newScale)) {\n      if (preset) {\n        this.eventBus.dispatch('scalechanging', {\n          source: this,\n          scale: newScale,\n          presetValue: newValue,\n        });\n      }\n      return;\n    }\n\n    for (let i = 0, ii = this._pages.length; i < ii; i++) {\n      this._pages[i].update(newScale);\n    }\n    this._currentScale = newScale;\n\n    if (!noScroll) {\n      let page = this._currentPageNumber, dest;\n      if (this._location &&\n          !(this.isInPresentationMode || this.isChangingPresentationMode)) {\n        page = this._location.pageNumber;\n        dest = [null, { name: 'XYZ', }, this._location.left,\n                this._location.top, null];\n      }\n      this.scrollPageIntoView({\n        pageNumber: page,\n        destArray: dest,\n        allowNegativeOffset: true,\n      });\n    }\n\n    this.eventBus.dispatch('scalechanging', {\n      source: this,\n      scale: newScale,\n      presetValue: preset ? newValue : undefined,\n    });\n\n    if (this.defaultRenderingQueue) {\n      this.update();\n    }\n  }\n\n  _setScale(value, noScroll = false) {\n    let scale = parseFloat(value);\n\n    if (scale > 0) {\n      this._setScaleUpdatePages(scale, value, noScroll, /* preset = */ false);\n    } else {\n      let currentPage = this._pages[this._currentPageNumber - 1];\n      if (!currentPage) {\n        return;\n      }\n      const noPadding = (this.isInPresentationMode || this.removePageBorders);\n      let hPadding = noPadding ? 0 : SCROLLBAR_PADDING;\n      let vPadding = noPadding ? 0 : VERTICAL_PADDING;\n\n      if (!noPadding && this._isScrollModeHorizontal) {\n        [hPadding, vPadding] = [vPadding, hPadding]; // Swap the padding values.\n      }\n      let pageWidthScale = (this.container.clientWidth - hPadding) /\n                           currentPage.width * currentPage.scale;\n      let pageHeightScale = (this.container.clientHeight - vPadding) /\n                            currentPage.height * currentPage.scale;\n      switch (value) {\n        case 'page-actual':\n          scale = 1;\n          break;\n        case 'page-width':\n          scale = pageWidthScale;\n          break;\n        case 'page-height':\n          scale = pageHeightScale;\n          break;\n        case 'page-fit':\n          scale = Math.min(pageWidthScale, pageHeightScale);\n          break;\n        case 'auto':\n          // For pages in landscape mode, fit the page height to the viewer\n          // *unless* the page would thus become too wide to fit horizontally.\n          let horizontalScale = isPortraitOrientation(currentPage) ?\n            pageWidthScale : Math.min(pageHeightScale, pageWidthScale);\n          scale = Math.min(MAX_AUTO_SCALE, horizontalScale);\n          break;\n        default:\n          console.error(\n            `${this._name}._setScale: \"${value}\" is an unknown zoom value.`);\n          return;\n      }\n      this._setScaleUpdatePages(scale, value, noScroll, /* preset = */ true);\n    }\n  }\n\n  /**\n   * Refreshes page view: scrolls to the current page and updates the scale.\n   * @private\n   */\n  _resetCurrentPageView() {\n    if (this.isInPresentationMode) {\n      // Fixes the case when PDF has different page sizes.\n      this._setScale(this._currentScaleValue, true);\n    }\n\n    let pageView = this._pages[this._currentPageNumber - 1];\n    this._scrollIntoView({ pageDiv: pageView.div, });\n  }\n\n  /**\n   * @typedef ScrollPageIntoViewParameters\n   * @property {number} pageNumber - The page number.\n   * @property {Array} destArray - (optional) The original PDF destination\n   *   array, in the format: <page-ref> </XYZ|/FitXXX> <args..>\n   * @property {boolean} allowNegativeOffset - (optional) Allow negative page\n   *   offsets. The default value is `false`.\n   */\n\n  /**\n   * Scrolls page into view.\n   * @param {ScrollPageIntoViewParameters} params\n   */\n  scrollPageIntoView({ pageNumber, destArray = null,\n                       allowNegativeOffset = false, }) {\n    if (!this.pdfDocument) {\n      return;\n    }\n    const pageView = (Number.isInteger(pageNumber) &&\n                      this._pages[pageNumber - 1]);\n    if (!pageView) {\n      console.error(`${this._name}.scrollPageIntoView: ` +\n        `\"${pageNumber}\" is not a valid pageNumber parameter.`);\n      return;\n    }\n\n    if (this.isInPresentationMode || !destArray) {\n      this._setCurrentPageNumber(pageNumber, /* resetCurrentPageView = */ true);\n      return;\n    }\n    let x = 0, y = 0;\n    let width = 0, height = 0, widthScale, heightScale;\n    let changeOrientation = (pageView.rotation % 180 === 0 ? false : true);\n    let pageWidth = (changeOrientation ? pageView.height : pageView.width) /\n      pageView.scale / CSS_UNITS;\n    let pageHeight = (changeOrientation ? pageView.width : pageView.height) /\n      pageView.scale / CSS_UNITS;\n    let scale = 0;\n    switch (destArray[1].name) {\n      case 'XYZ':\n        x = destArray[2];\n        y = destArray[3];\n        scale = destArray[4];\n        // If x and/or y coordinates are not supplied, default to\n        // _top_ left of the page (not the obvious bottom left,\n        // since aligning the bottom of the intended page with the\n        // top of the window is rarely helpful).\n        x = x !== null ? x : 0;\n        y = y !== null ? y : pageHeight;\n        break;\n      case 'Fit':\n      case 'FitB':\n        scale = 'page-fit';\n        break;\n      case 'FitH':\n      case 'FitBH':\n        y = destArray[2];\n        scale = 'page-width';\n        // According to the PDF spec, section 12.3.2.2, a `null` value in the\n        // parameter should maintain the position relative to the new page.\n        if (y === null && this._location) {\n          x = this._location.left;\n          y = this._location.top;\n        }\n        break;\n      case 'FitV':\n      case 'FitBV':\n        x = destArray[2];\n        width = pageWidth;\n        height = pageHeight;\n        scale = 'page-height';\n        break;\n      case 'FitR':\n        x = destArray[2];\n        y = destArray[3];\n        width = destArray[4] - x;\n        height = destArray[5] - y;\n        let hPadding = this.removePageBorders ? 0 : SCROLLBAR_PADDING;\n        let vPadding = this.removePageBorders ? 0 : VERTICAL_PADDING;\n\n        widthScale = (this.container.clientWidth - hPadding) /\n          width / CSS_UNITS;\n        heightScale = (this.container.clientHeight - vPadding) /\n          height / CSS_UNITS;\n        scale = Math.min(Math.abs(widthScale), Math.abs(heightScale));\n        break;\n      default:\n        console.error(`${this._name}.scrollPageIntoView: ` +\n          `\"${destArray[1].name}\" is not a valid destination type.`);\n        return;\n    }\n\n    if (scale && scale !== this._currentScale) {\n      this.currentScaleValue = scale;\n    } else if (this._currentScale === UNKNOWN_SCALE) {\n      this.currentScaleValue = DEFAULT_SCALE_VALUE;\n    }\n\n    if (scale === 'page-fit' && !destArray[4]) {\n      this._scrollIntoView({\n        pageDiv: pageView.div,\n        pageNumber,\n      });\n      return;\n    }\n\n    let boundingRect = [\n      pageView.viewport.convertToViewportPoint(x, y),\n      pageView.viewport.convertToViewportPoint(x + width, y + height)\n    ];\n    let left = Math.min(boundingRect[0][0], boundingRect[1][0]);\n    let top = Math.min(boundingRect[0][1], boundingRect[1][1]);\n\n    if (!allowNegativeOffset) {\n      // Some bad PDF generators will create destinations with e.g. top values\n      // that exceeds the page height. Ensure that offsets are not negative,\n      // to prevent a previous page from becoming visible (fixes bug 874482).\n      left = Math.max(left, 0);\n      top = Math.max(top, 0);\n    }\n    this._scrollIntoView({\n      pageDiv: pageView.div,\n      pageSpot: { left, top, },\n      pageNumber,\n    });\n  }\n\n  _updateLocation(firstPage) {\n    let currentScale = this._currentScale;\n    let currentScaleValue = this._currentScaleValue;\n    let normalizedScaleValue =\n      parseFloat(currentScaleValue) === currentScale ?\n      Math.round(currentScale * 10000) / 100 : currentScaleValue;\n\n    let pageNumber = firstPage.id;\n    let pdfOpenParams = '#page=' + pageNumber;\n    pdfOpenParams += '&zoom=' + normalizedScaleValue;\n    let currentPageView = this._pages[pageNumber - 1];\n    let container = this.container;\n    let topLeft = currentPageView.getPagePoint(\n      (container.scrollLeft - firstPage.x),\n      (container.scrollTop - firstPage.y));\n    let intLeft = Math.round(topLeft[0]);\n    let intTop = Math.round(topLeft[1]);\n    pdfOpenParams += ',' + intLeft + ',' + intTop;\n\n    this._location = {\n      pageNumber,\n      scale: normalizedScaleValue,\n      top: intTop,\n      left: intLeft,\n      rotation: this._pagesRotation,\n      pdfOpenParams,\n    };\n  }\n\n  _updateHelper(visiblePages) {\n    throw new Error('Not implemented: _updateHelper');\n  }\n\n  update() {\n    const visible = this._getVisiblePages();\n    const visiblePages = visible.views, numVisiblePages = visiblePages.length;\n\n    if (numVisiblePages === 0) {\n      return;\n    }\n    const newCacheSize = Math.max(DEFAULT_CACHE_SIZE, 2 * numVisiblePages + 1);\n    this._buffer.resize(newCacheSize, visiblePages);\n\n    this.renderingQueue.renderHighestPriority(visible);\n\n    this._updateHelper(visiblePages); // Run any class-specific update code.\n\n    this._updateLocation(visible.first);\n    this.eventBus.dispatch('updateviewarea', {\n      source: this,\n      location: this._location,\n    });\n  }\n\n  containsElement(element) {\n    return this.container.contains(element);\n  }\n\n  focus() {\n    this.container.focus();\n  }\n\n  get _isScrollModeHorizontal() {\n    // Used to ensure that pre-rendering of the next/previous page works\n    // correctly, since Scroll/Spread modes are ignored in Presentation Mode.\n    return (this.isInPresentationMode ?\n            false : this._scrollMode === ScrollMode.HORIZONTAL);\n  }\n\n  get isInPresentationMode() {\n    return this.presentationModeState === PresentationModeState.FULLSCREEN;\n  }\n\n  get isChangingPresentationMode() {\n    return this.presentationModeState === PresentationModeState.CHANGING;\n  }\n\n  get isHorizontalScrollbarEnabled() {\n    return (this.isInPresentationMode ?\n      false : (this.container.scrollWidth > this.container.clientWidth));\n  }\n\n  get isVerticalScrollbarEnabled() {\n    return (this.isInPresentationMode ?\n      false : (this.container.scrollHeight > this.container.clientHeight));\n  }\n\n  /**\n   * Helper method for `this._getVisiblePages`. Should only ever be used when\n   * the viewer can only display a single page at a time, for example in:\n   *  - `PDFSinglePageViewer`.\n   *  - `PDFViewer` with Presentation Mode active.\n   */\n  _getCurrentVisiblePage() {\n    if (!this.pagesCount) {\n      return { views: [], };\n    }\n    const pageView = this._pages[this._currentPageNumber - 1];\n    // NOTE: Compute the `x` and `y` properties of the current view,\n    // since `this._updateLocation` depends of them being available.\n    const element = pageView.div;\n\n    const view = {\n      id: pageView.id,\n      x: element.offsetLeft + element.clientLeft,\n      y: element.offsetTop + element.clientTop,\n      view: pageView,\n    };\n    return { first: view, last: view, views: [view], };\n  }\n\n  _getVisiblePages() {\n    return getVisibleElements(this.container, this._pages, true,\n                              this._isScrollModeHorizontal);\n  }\n\n  /**\n   * @param {number} pageNumber\n   */\n  isPageVisible(pageNumber) {\n    if (!this.pdfDocument) {\n      return false;\n    }\n    if (this.pageNumber < 1 || pageNumber > this.pagesCount) {\n      console.error(\n        `${this._name}.isPageVisible: \"${pageNumber}\" is out of bounds.`);\n      return false;\n    }\n    return this._getVisiblePages().views.some(function(view) {\n      return (view.id === pageNumber);\n    });\n  }\n\n  cleanup() {\n    for (let i = 0, ii = this._pages.length; i < ii; i++) {\n      if (this._pages[i] &&\n          this._pages[i].renderingState !== RenderingStates.FINISHED) {\n        this._pages[i].reset();\n      }\n    }\n  }\n\n  /**\n   * @private\n   */\n  _cancelRendering() {\n    for (let i = 0, ii = this._pages.length; i < ii; i++) {\n      if (this._pages[i]) {\n        this._pages[i].cancelRendering();\n      }\n    }\n  }\n\n  /**\n   * @param {PDFPageView} pageView\n   * @returns {Promise} Returns a promise containing a {PDFPageProxy} object.\n   * @private\n   */\n  _ensurePdfPageLoaded(pageView) {\n    if (pageView.pdfPage) {\n      return Promise.resolve(pageView.pdfPage);\n    }\n    let pageNumber = pageView.id;\n    if (this._pagesRequests[pageNumber]) {\n      return this._pagesRequests[pageNumber];\n    }\n    let promise = this.pdfDocument.getPage(pageNumber).then((pdfPage) => {\n      if (!pageView.pdfPage) {\n        pageView.setPdfPage(pdfPage);\n      }\n      this._pagesRequests[pageNumber] = null;\n      return pdfPage;\n    }).catch((reason) => {\n      console.error('Unable to get page for page view', reason);\n      // Page error -- there is nothing can be done.\n      this._pagesRequests[pageNumber] = null;\n    });\n    this._pagesRequests[pageNumber] = promise;\n    return promise;\n  }\n\n  forceRendering(currentlyVisiblePages) {\n    let visiblePages = currentlyVisiblePages || this._getVisiblePages();\n    let scrollAhead = (this._isScrollModeHorizontal ?\n                       this.scroll.right : this.scroll.down);\n    let pageView = this.renderingQueue.getHighestPriority(visiblePages,\n                                                          this._pages,\n                                                          scrollAhead);\n    if (pageView) {\n      this._ensurePdfPageLoaded(pageView).then(() => {\n        this.renderingQueue.renderView(pageView);\n      });\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * @param {HTMLDivElement} textLayerDiv\n   * @param {number} pageIndex\n   * @param {PageViewport} viewport\n   * @returns {TextLayerBuilder}\n   */\n  createTextLayerBuilder(textLayerDiv, pageIndex, viewport,\n                         enhanceTextSelection = false) {\n    return new TextLayerBuilder({\n      textLayerDiv,\n      eventBus: this.eventBus,\n      pageIndex,\n      viewport,\n      findController: this.isInPresentationMode ? null : this.findController,\n      enhanceTextSelection: this.isInPresentationMode ? false :\n                                                        enhanceTextSelection,\n    });\n  }\n\n  /**\n   * @param {HTMLDivElement} pageDiv\n   * @param {PDFPage} pdfPage\n   * @param {string} imageResourcesPath - (optional) Path for image resources,\n   *   mainly for annotation icons. Include trailing slash.\n   * @param {boolean} renderInteractiveForms\n   * @param {IL10n} l10n\n   * @returns {AnnotationLayerBuilder}\n   */\n  createAnnotationLayerBuilder(pageDiv, pdfPage, imageResourcesPath = '',\n                               renderInteractiveForms = false,\n                               l10n = NullL10n) {\n    return new AnnotationLayerBuilder({\n      pageDiv,\n      pdfPage,\n      imageResourcesPath,\n      renderInteractiveForms,\n      linkService: this.linkService,\n      downloadManager: this.downloadManager,\n      l10n,\n    });\n  }\n\n  /**\n   * @returns {boolean} Whether all pages of the PDF document have identical\n   *                    widths and heights.\n   */\n  get hasEqualPageSizes() {\n    let firstPageView = this._pages[0];\n    for (let i = 1, ii = this._pages.length; i < ii; ++i) {\n      let pageView = this._pages[i];\n      if (pageView.width !== firstPageView.width ||\n          pageView.height !== firstPageView.height) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  /**\n   * Returns sizes of the pages.\n   * @returns {Array} Array of objects with width/height/rotation fields.\n   */\n  getPagesOverview() {\n    let pagesOverview = this._pages.map(function(pageView) {\n      let viewport = pageView.pdfPage.getViewport({ scale: 1, });\n      return {\n        width: viewport.width,\n        height: viewport.height,\n        rotation: viewport.rotation,\n      };\n    });\n    if (!this.enablePrintAutoRotate) {\n      return pagesOverview;\n    }\n    let isFirstPagePortrait = isPortraitOrientation(pagesOverview[0]);\n    return pagesOverview.map(function (size) {\n      if (isFirstPagePortrait === isPortraitOrientation(size)) {\n        return size;\n      }\n      return {\n        width: size.height,\n        height: size.width,\n        rotation: (size.rotation + 90) % 360,\n      };\n    });\n  }\n\n  /**\n   * @return {number} One of the values in {ScrollMode}.\n   */\n  get scrollMode() {\n    return this._scrollMode;\n  }\n\n  /**\n   * @param {number} mode - The direction in which the document pages should be\n   *   laid out within the scrolling container.\n   *   The constants from {ScrollMode} should be used.\n   */\n  set scrollMode(mode) {\n    if (this._scrollMode === mode) {\n      return; // The Scroll mode didn't change.\n    }\n    if (!isValidScrollMode(mode)) {\n      throw new Error(`Invalid scroll mode: ${mode}`);\n    }\n    this._scrollMode = mode;\n    this.eventBus.dispatch('scrollmodechanged', { source: this, mode, });\n\n    this._updateScrollMode(/* pageNumber = */ this._currentPageNumber);\n  }\n\n  _updateScrollMode(pageNumber = null) {\n    const scrollMode = this._scrollMode, viewer = this.viewer;\n\n    viewer.classList.toggle('scrollHorizontal',\n                            scrollMode === ScrollMode.HORIZONTAL);\n    viewer.classList.toggle('scrollWrapped',\n                            scrollMode === ScrollMode.WRAPPED);\n\n    if (!this.pdfDocument || !pageNumber) {\n      return;\n    }\n    // Non-numeric scale values can be sensitive to the scroll orientation.\n    // Call this before re-scrolling to the current page, to ensure that any\n    // changes in scale don't move the current page.\n    if (this._currentScaleValue && isNaN(this._currentScaleValue)) {\n      this._setScale(this._currentScaleValue, true);\n    }\n    this._setCurrentPageNumber(pageNumber, /* resetCurrentPageView = */ true);\n    this.update();\n  }\n\n  /**\n   * @return {number} One of the values in {SpreadMode}.\n   */\n  get spreadMode() {\n    return this._spreadMode;\n  }\n\n  /**\n   * @param {number} mode - Group the pages in spreads, starting with odd- or\n   *   even-number pages (unless `SpreadMode.NONE` is used).\n   *   The constants from {SpreadMode} should be used.\n   */\n  set spreadMode(mode) {\n    if (this._spreadMode === mode) {\n      return; // The Spread mode didn't change.\n    }\n    if (!isValidSpreadMode(mode)) {\n      throw new Error(`Invalid spread mode: ${mode}`);\n    }\n    this._spreadMode = mode;\n    this.eventBus.dispatch('spreadmodechanged', { source: this, mode, });\n\n    this._updateSpreadMode(/* pageNumber = */ this._currentPageNumber);\n  }\n\n  _updateSpreadMode(pageNumber = null) {\n    if (!this.pdfDocument) {\n      return;\n    }\n    const viewer = this.viewer, pages = this._pages;\n    // Temporarily remove all the pages from the DOM.\n    viewer.textContent = '';\n\n    if (this._spreadMode === SpreadMode.NONE) {\n      for (let i = 0, iMax = pages.length; i < iMax; ++i) {\n        viewer.appendChild(pages[i].div);\n      }\n    } else {\n      const parity = this._spreadMode - 1;\n      let spread = null;\n      for (let i = 0, iMax = pages.length; i < iMax; ++i) {\n        if (spread === null) {\n          spread = document.createElement('div');\n          spread.className = 'spread';\n          viewer.appendChild(spread);\n        } else if (i % 2 === parity) {\n          spread = spread.cloneNode(false);\n          viewer.appendChild(spread);\n        }\n        spread.appendChild(pages[i].div);\n      }\n    }\n\n    if (!pageNumber) {\n      return;\n    }\n    this._setCurrentPageNumber(pageNumber, /* resetCurrentPageView = */ true);\n    this.update();\n  }\n}\n\nexport {\n  BaseViewer,\n};\n","/* Copyright 2014 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { AnnotationLayer } from 'pdfjs-lib';\nimport { NullL10n } from './ui_utils';\nimport { SimpleLinkService } from './pdf_link_service';\n\n/**\n * @typedef {Object} AnnotationLayerBuilderOptions\n * @property {HTMLDivElement} pageDiv\n * @property {PDFPage} pdfPage\n * @property {string} imageResourcesPath - (optional) Path for image resources,\n *   mainly for annotation icons. Include trailing slash.\n * @property {boolean} renderInteractiveForms\n * @property {IPDFLinkService} linkService\n * @property {DownloadManager} downloadManager\n * @property {IL10n} l10n - Localization service.\n */\n\nclass AnnotationLayerBuilder {\n  /**\n   * @param {AnnotationLayerBuilderOptions} options\n   */\n  constructor({ pageDiv, pdfPage, linkService, downloadManager,\n                imageResourcesPath = '', renderInteractiveForms = false,\n                l10n = NullL10n, }) {\n    this.pageDiv = pageDiv;\n    this.pdfPage = pdfPage;\n    this.linkService = linkService;\n    this.downloadManager = downloadManager;\n    this.imageResourcesPath = imageResourcesPath;\n    this.renderInteractiveForms = renderInteractiveForms;\n    this.l10n = l10n;\n\n    this.div = null;\n    this._cancelled = false;\n  }\n\n  /**\n   * @param {PageViewport} viewport\n   * @param {string} intent (default value is 'display')\n   */\n  render(viewport, intent = 'display') {\n    this.pdfPage.getAnnotations({ intent, }).then((annotations) => {\n      if (this._cancelled) {\n        return;\n      }\n\n      let parameters = {\n        viewport: viewport.clone({ dontFlip: true, }),\n        div: this.div,\n        annotations,\n        page: this.pdfPage,\n        imageResourcesPath: this.imageResourcesPath,\n        renderInteractiveForms: this.renderInteractiveForms,\n        linkService: this.linkService,\n        downloadManager: this.downloadManager,\n      };\n\n      if (this.div) {\n        // If an annotationLayer already exists, refresh its children's\n        // transformation matrices.\n        AnnotationLayer.update(parameters);\n      } else {\n        // Create an annotation layer div and render the annotations\n        // if there is at least one annotation.\n        if (annotations.length === 0) {\n          return;\n        }\n        this.div = document.createElement('div');\n        this.div.className = 'annotationLayer';\n        this.pageDiv.appendChild(this.div);\n        parameters.div = this.div;\n\n        AnnotationLayer.render(parameters);\n        this.l10n.translate(this.div);\n      }\n    });\n  }\n\n  cancel() {\n    this._cancelled = true;\n  }\n\n  hide() {\n    if (!this.div) {\n      return;\n    }\n    this.div.setAttribute('hidden', 'true');\n  }\n}\n\n/**\n * @implements IPDFAnnotationLayerFactory\n */\nclass DefaultAnnotationLayerFactory {\n  /**\n   * @param {HTMLDivElement} pageDiv\n   * @param {PDFPage} pdfPage\n   * @param {string} imageResourcesPath - (optional) Path for image resources,\n   *   mainly for annotation icons. Include trailing slash.\n   * @param {boolean} renderInteractiveForms\n   * @param {IL10n} l10n\n   * @returns {AnnotationLayerBuilder}\n   */\n  createAnnotationLayerBuilder(pageDiv, pdfPage, imageResourcesPath = '',\n                               renderInteractiveForms = false,\n                               l10n = NullL10n) {\n    return new AnnotationLayerBuilder({\n      pageDiv,\n      pdfPage,\n      imageResourcesPath,\n      renderInteractiveForms,\n      linkService: new SimpleLinkService(),\n      l10n,\n    });\n  }\n}\n\nexport {\n  AnnotationLayerBuilder,\n  DefaultAnnotationLayerFactory,\n};\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  approximateFraction, CSS_UNITS, DEFAULT_SCALE, getGlobalEventBus,\n  getOutputScale, NullL10n, RendererType, roundToDivide, TextLayerMode\n} from './ui_utils';\nimport {\n  createPromiseCapability, RenderingCancelledException, SVGGraphics\n} from 'pdfjs-lib';\nimport { RenderingStates } from './pdf_rendering_queue';\nimport { viewerCompatibilityParams } from './viewer_compatibility';\n\n/**\n * @typedef {Object} PDFPageViewOptions\n * @property {HTMLDivElement} container - The viewer element.\n * @property {EventBus} eventBus - The application event bus.\n * @property {number} id - The page unique ID (normally its number).\n * @property {number} scale - The page scale display.\n * @property {PageViewport} defaultViewport - The page viewport.\n * @property {PDFRenderingQueue} renderingQueue - The rendering queue object.\n * @property {IPDFTextLayerFactory} textLayerFactory\n * @property {number} textLayerMode - (optional) Controls if the text layer used\n *   for selection and searching is created, and if the improved text selection\n *   behaviour is enabled. The constants from {TextLayerMode} should be used.\n *   The default value is `TextLayerMode.ENABLE`.\n * @property {IPDFAnnotationLayerFactory} annotationLayerFactory\n * @property {string} imageResourcesPath - (optional) Path for image resources,\n *   mainly for annotation icons. Include trailing slash.\n * @property {boolean} renderInteractiveForms - Turns on rendering of\n *   interactive form elements. The default is `false`.\n * @property {string} renderer - 'canvas' or 'svg'. The default is 'canvas'.\n * @property {boolean} enableWebGL - (optional) Enables WebGL accelerated\n *   rendering for some operations. The default value is `false`.\n * @property {boolean} useOnlyCssZoom - (optional) Enables CSS only zooming.\n *   The default value is `false`.\n * @property {number} maxCanvasPixels - (optional) The maximum supported canvas\n *   size in total pixels, i.e. width * height. Use -1 for no limit.\n *   The default value is 4096 * 4096 (16 mega-pixels).\n * @property {IL10n} l10n - Localization service.\n */\n\nconst MAX_CANVAS_PIXELS = viewerCompatibilityParams.maxCanvasPixels || 16777216;\n\n/**\n * @implements {IRenderableView}\n */\nclass PDFPageView {\n  /**\n   * @param {PDFPageViewOptions} options\n   */\n  constructor(options) {\n    let container = options.container;\n    let defaultViewport = options.defaultViewport;\n\n    this.id = options.id;\n    this.renderingId = 'page' + this.id;\n\n    this.pdfPage = null;\n    this.pageLabel = null;\n    this.rotation = 0;\n    this.scale = options.scale || DEFAULT_SCALE;\n    this.viewport = defaultViewport;\n    this.pdfPageRotate = defaultViewport.rotation;\n    this.hasRestrictedScaling = false;\n    this.textLayerMode = Number.isInteger(options.textLayerMode) ?\n      options.textLayerMode : TextLayerMode.ENABLE;\n    this.imageResourcesPath = options.imageResourcesPath || '';\n    this.renderInteractiveForms = options.renderInteractiveForms || false;\n    this.useOnlyCssZoom = options.useOnlyCssZoom || false;\n    this.maxCanvasPixels = options.maxCanvasPixels || MAX_CANVAS_PIXELS;\n\n    this.eventBus = options.eventBus || getGlobalEventBus();\n    this.renderingQueue = options.renderingQueue;\n    this.textLayerFactory = options.textLayerFactory;\n    this.annotationLayerFactory = options.annotationLayerFactory;\n    this.renderer = options.renderer || RendererType.CANVAS;\n    this.enableWebGL = options.enableWebGL || false;\n    this.l10n = options.l10n || NullL10n;\n\n    this.paintTask = null;\n    this.paintedViewportMap = new WeakMap();\n    this.renderingState = RenderingStates.INITIAL;\n    this.resume = null;\n    this.error = null;\n\n    this.annotationLayer = null;\n    this.textLayer = null;\n    this.zoomLayer = null;\n\n    let div = document.createElement('div');\n    div.className = 'page';\n    div.style.width = Math.floor(this.viewport.width) + 'px';\n    div.style.height = Math.floor(this.viewport.height) + 'px';\n    div.setAttribute('data-page-number', this.id);\n    this.div = div;\n\n    container.appendChild(div);\n  }\n\n  setPdfPage(pdfPage) {\n    this.pdfPage = pdfPage;\n    this.pdfPageRotate = pdfPage.rotate;\n\n    let totalRotation = (this.rotation + this.pdfPageRotate) % 360;\n    this.viewport = pdfPage.getViewport({ scale: this.scale * CSS_UNITS,\n                                          rotation: totalRotation, });\n    this.stats = pdfPage.stats;\n    this.reset();\n  }\n\n  destroy() {\n    this.reset();\n    if (this.pdfPage) {\n      this.pdfPage.cleanup();\n    }\n  }\n\n  /**\n   * @private\n   */\n  _resetZoomLayer(removeFromDOM = false) {\n    if (!this.zoomLayer) {\n      return;\n    }\n    let zoomLayerCanvas = this.zoomLayer.firstChild;\n    this.paintedViewportMap.delete(zoomLayerCanvas);\n    // Zeroing the width and height causes Firefox to release graphics\n    // resources immediately, which can greatly reduce memory consumption.\n    zoomLayerCanvas.width = 0;\n    zoomLayerCanvas.height = 0;\n\n    if (removeFromDOM) {\n      // Note: `ChildNode.remove` doesn't throw if the parent node is undefined.\n      this.zoomLayer.remove();\n    }\n    this.zoomLayer = null;\n  }\n\n  reset(keepZoomLayer = false, keepAnnotations = false) {\n    this.cancelRendering(keepAnnotations);\n    this.renderingState = RenderingStates.INITIAL;\n\n    let div = this.div;\n    div.style.width = Math.floor(this.viewport.width) + 'px';\n    div.style.height = Math.floor(this.viewport.height) + 'px';\n\n    let childNodes = div.childNodes;\n    let currentZoomLayerNode = (keepZoomLayer && this.zoomLayer) || null;\n    let currentAnnotationNode = (keepAnnotations && this.annotationLayer &&\n                                 this.annotationLayer.div) || null;\n    for (let i = childNodes.length - 1; i >= 0; i--) {\n      let node = childNodes[i];\n      if (currentZoomLayerNode === node || currentAnnotationNode === node) {\n        continue;\n      }\n      div.removeChild(node);\n    }\n    div.removeAttribute('data-loaded');\n\n    if (currentAnnotationNode) {\n      // Hide the annotation layer until all elements are resized\n      // so they are not displayed on the already resized page.\n      this.annotationLayer.hide();\n    } else if (this.annotationLayer) {\n      this.annotationLayer.cancel();\n      this.annotationLayer = null;\n    }\n\n    if (!currentZoomLayerNode) {\n      if (this.canvas) {\n        this.paintedViewportMap.delete(this.canvas);\n        // Zeroing the width and height causes Firefox to release graphics\n        // resources immediately, which can greatly reduce memory consumption.\n        this.canvas.width = 0;\n        this.canvas.height = 0;\n        delete this.canvas;\n      }\n      this._resetZoomLayer();\n    }\n    if (this.svg) {\n      this.paintedViewportMap.delete(this.svg);\n      delete this.svg;\n    }\n\n    this.loadingIconDiv = document.createElement('div');\n    this.loadingIconDiv.className = 'loadingIcon';\n    div.appendChild(this.loadingIconDiv);\n  }\n\n  update(scale, rotation) {\n    this.scale = scale || this.scale;\n    if (typeof rotation !== 'undefined') { // The rotation may be zero.\n      this.rotation = rotation;\n    }\n\n    let totalRotation = (this.rotation + this.pdfPageRotate) % 360;\n    this.viewport = this.viewport.clone({\n      scale: this.scale * CSS_UNITS,\n      rotation: totalRotation,\n    });\n\n    if (this.svg) {\n      this.cssTransform(this.svg, true);\n\n      this.eventBus.dispatch('pagerendered', {\n        source: this,\n        pageNumber: this.id,\n        cssTransform: true,\n        timestamp: performance.now(),\n      });\n      return;\n    }\n\n    let isScalingRestricted = false;\n    if (this.canvas && this.maxCanvasPixels > 0) {\n      let outputScale = this.outputScale;\n      if (((Math.floor(this.viewport.width) * outputScale.sx) | 0) *\n          ((Math.floor(this.viewport.height) * outputScale.sy) | 0) >\n          this.maxCanvasPixels) {\n        isScalingRestricted = true;\n      }\n    }\n\n    if (this.canvas) {\n      if (this.useOnlyCssZoom ||\n          (this.hasRestrictedScaling && isScalingRestricted)) {\n        this.cssTransform(this.canvas, true);\n\n        this.eventBus.dispatch('pagerendered', {\n          source: this,\n          pageNumber: this.id,\n          cssTransform: true,\n          timestamp: performance.now(),\n        });\n        return;\n      }\n      if (!this.zoomLayer && !this.canvas.hasAttribute('hidden')) {\n        this.zoomLayer = this.canvas.parentNode;\n        this.zoomLayer.style.position = 'absolute';\n      }\n    }\n    if (this.zoomLayer) {\n      this.cssTransform(this.zoomLayer.firstChild);\n    }\n    this.reset(/* keepZoomLayer = */ true, /* keepAnnotations = */ true);\n  }\n\n  /**\n   * PLEASE NOTE: Most likely you want to use the `this.reset()` method,\n   *              rather than calling this one directly.\n   */\n  cancelRendering(keepAnnotations = false) {\n    if (this.paintTask) {\n      this.paintTask.cancel();\n      this.paintTask = null;\n    }\n    this.resume = null;\n\n    if (this.textLayer) {\n      this.textLayer.cancel();\n      this.textLayer = null;\n    }\n    if (!keepAnnotations && this.annotationLayer) {\n      this.annotationLayer.cancel();\n      this.annotationLayer = null;\n    }\n  }\n\n  cssTransform(target, redrawAnnotations = false) {\n    // Scale target (canvas or svg), its wrapper and page container.\n    let width = this.viewport.width;\n    let height = this.viewport.height;\n    let div = this.div;\n    target.style.width = target.parentNode.style.width = div.style.width =\n      Math.floor(width) + 'px';\n    target.style.height = target.parentNode.style.height = div.style.height =\n      Math.floor(height) + 'px';\n    // The canvas may have been originally rotated; rotate relative to that.\n    let relativeRotation = this.viewport.rotation -\n                           this.paintedViewportMap.get(target).rotation;\n    let absRotation = Math.abs(relativeRotation);\n    let scaleX = 1, scaleY = 1;\n    if (absRotation === 90 || absRotation === 270) {\n      // Scale x and y because of the rotation.\n      scaleX = height / width;\n      scaleY = width / height;\n    }\n    let cssTransform = 'rotate(' + relativeRotation + 'deg) ' +\n      'scale(' + scaleX + ',' + scaleY + ')';\n    target.style.transform = cssTransform;\n\n    if (this.textLayer) {\n      // Rotating the text layer is more complicated since the divs inside the\n      // the text layer are rotated.\n      // TODO: This could probably be simplified by drawing the text layer in\n      // one orientation and then rotating overall.\n      let textLayerViewport = this.textLayer.viewport;\n      let textRelativeRotation = this.viewport.rotation -\n        textLayerViewport.rotation;\n      let textAbsRotation = Math.abs(textRelativeRotation);\n      let scale = width / textLayerViewport.width;\n      if (textAbsRotation === 90 || textAbsRotation === 270) {\n        scale = width / textLayerViewport.height;\n      }\n      let textLayerDiv = this.textLayer.textLayerDiv;\n      let transX, transY;\n      switch (textAbsRotation) {\n        case 0:\n          transX = transY = 0;\n          break;\n        case 90:\n          transX = 0;\n          transY = '-' + textLayerDiv.style.height;\n          break;\n        case 180:\n          transX = '-' + textLayerDiv.style.width;\n          transY = '-' + textLayerDiv.style.height;\n          break;\n        case 270:\n          transX = '-' + textLayerDiv.style.width;\n          transY = 0;\n          break;\n        default:\n          console.error('Bad rotation value.');\n          break;\n      }\n\n      textLayerDiv.style.transform =\n        'rotate(' + textAbsRotation + 'deg) ' +\n        'scale(' + scale + ', ' + scale + ') ' +\n        'translate(' + transX + ', ' + transY + ')';\n      textLayerDiv.style.transformOrigin = '0% 0%';\n    }\n\n    if (redrawAnnotations && this.annotationLayer) {\n      this.annotationLayer.render(this.viewport, 'display');\n    }\n  }\n\n  get width() {\n    return this.viewport.width;\n  }\n\n  get height() {\n    return this.viewport.height;\n  }\n\n  getPagePoint(x, y) {\n    return this.viewport.convertToPdfPoint(x, y);\n  }\n\n  draw() {\n    if (this.renderingState !== RenderingStates.INITIAL) {\n      console.error('Must be in new state before drawing');\n      this.reset(); // Ensure that we reset all state to prevent issues.\n    }\n\n    if (!this.pdfPage) {\n      this.renderingState = RenderingStates.FINISHED;\n      return Promise.reject(new Error('Page is not loaded'));\n    }\n\n    this.renderingState = RenderingStates.RUNNING;\n\n    let pdfPage = this.pdfPage;\n    let div = this.div;\n    // Wrap the canvas so that if it has a CSS transform for high DPI the\n    // overflow will be hidden in Firefox.\n    let canvasWrapper = document.createElement('div');\n    canvasWrapper.style.width = div.style.width;\n    canvasWrapper.style.height = div.style.height;\n    canvasWrapper.classList.add('canvasWrapper');\n\n    if (this.annotationLayer && this.annotationLayer.div) {\n      // The annotation layer needs to stay on top.\n      div.insertBefore(canvasWrapper, this.annotationLayer.div);\n    } else {\n      div.appendChild(canvasWrapper);\n    }\n\n    let textLayer = null;\n    if (this.textLayerMode !== TextLayerMode.DISABLE && this.textLayerFactory) {\n      let textLayerDiv = document.createElement('div');\n      textLayerDiv.className = 'textLayer';\n      textLayerDiv.style.width = canvasWrapper.style.width;\n      textLayerDiv.style.height = canvasWrapper.style.height;\n      if (this.annotationLayer && this.annotationLayer.div) {\n        // The annotation layer needs to stay on top.\n        div.insertBefore(textLayerDiv, this.annotationLayer.div);\n      } else {\n        div.appendChild(textLayerDiv);\n      }\n\n      textLayer = this.textLayerFactory.\n        createTextLayerBuilder(textLayerDiv, this.id - 1, this.viewport,\n            this.textLayerMode === TextLayerMode.ENABLE_ENHANCE);\n    }\n    this.textLayer = textLayer;\n\n    let renderContinueCallback = null;\n    if (this.renderingQueue) {\n      renderContinueCallback = (cont) => {\n        if (!this.renderingQueue.isHighestPriority(this)) {\n          this.renderingState = RenderingStates.PAUSED;\n          this.resume = () => {\n            this.renderingState = RenderingStates.RUNNING;\n            cont();\n          };\n          return;\n        }\n        cont();\n      };\n    }\n\n    const finishPaintTask = async (error) => {\n      // The paintTask may have been replaced by a new one, so only remove\n      // the reference to the paintTask if it matches the one that is\n      // triggering this callback.\n      if (paintTask === this.paintTask) {\n        this.paintTask = null;\n      }\n\n      if (error instanceof RenderingCancelledException) {\n        this.error = null;\n        return;\n      }\n\n      this.renderingState = RenderingStates.FINISHED;\n\n      if (this.loadingIconDiv) {\n        div.removeChild(this.loadingIconDiv);\n        delete this.loadingIconDiv;\n      }\n      this._resetZoomLayer(/* removeFromDOM = */ true);\n\n      this.error = error;\n      this.stats = pdfPage.stats;\n\n      this.eventBus.dispatch('pagerendered', {\n        source: this,\n        pageNumber: this.id,\n        cssTransform: false,\n        timestamp: performance.now(),\n      });\n\n      if (error) {\n        throw error;\n      }\n    };\n\n    let paintTask = this.renderer === RendererType.SVG ?\n      this.paintOnSvg(canvasWrapper) :\n      this.paintOnCanvas(canvasWrapper);\n    paintTask.onRenderContinue = renderContinueCallback;\n    this.paintTask = paintTask;\n\n    let resultPromise = paintTask.promise.then(function() {\n      return finishPaintTask(null).then(function () {\n        if (textLayer) {\n          let readableStream = pdfPage.streamTextContent({\n            normalizeWhitespace: true,\n          });\n          textLayer.setTextContentStream(readableStream);\n          textLayer.render();\n        }\n      });\n    }, function(reason) {\n      return finishPaintTask(reason);\n    });\n\n    if (this.annotationLayerFactory) {\n      if (!this.annotationLayer) {\n        this.annotationLayer = this.annotationLayerFactory.\n          createAnnotationLayerBuilder(div, pdfPage, this.imageResourcesPath,\n                                       this.renderInteractiveForms, this.l10n);\n      }\n      this.annotationLayer.render(this.viewport, 'display');\n    }\n    div.setAttribute('data-loaded', true);\n\n    this.eventBus.dispatch('pagerender', {\n      source: this,\n      pageNumber: this.id,\n    });\n    return resultPromise;\n  }\n\n  paintOnCanvas(canvasWrapper) {\n    let renderCapability = createPromiseCapability();\n    let result = {\n      promise: renderCapability.promise,\n      onRenderContinue(cont) {\n        cont();\n      },\n      cancel() {\n        renderTask.cancel();\n      },\n    };\n\n    let viewport = this.viewport;\n    let canvas = document.createElement('canvas');\n    canvas.id = this.renderingId;\n\n    // Keep the canvas hidden until the first draw callback, or until drawing\n    // is complete when `!this.renderingQueue`, to prevent black flickering.\n    canvas.setAttribute('hidden', 'hidden');\n    let isCanvasHidden = true;\n    let showCanvas = function () {\n      if (isCanvasHidden) {\n        canvas.removeAttribute('hidden');\n        isCanvasHidden = false;\n      }\n    };\n\n    canvasWrapper.appendChild(canvas);\n    this.canvas = canvas;\n\n    if (typeof PDFJSDev === 'undefined' ||\n        PDFJSDev.test('MOZCENTRAL || FIREFOX || GENERIC')) {\n      canvas.mozOpaque = true;\n    }\n\n    let ctx = canvas.getContext('2d', { alpha: false, });\n    let outputScale = getOutputScale(ctx);\n    this.outputScale = outputScale;\n\n    if (this.useOnlyCssZoom) {\n      let actualSizeViewport = viewport.clone({ scale: CSS_UNITS, });\n      // Use a scale that makes the canvas have the originally intended size\n      // of the page.\n      outputScale.sx *= actualSizeViewport.width / viewport.width;\n      outputScale.sy *= actualSizeViewport.height / viewport.height;\n      outputScale.scaled = true;\n    }\n\n    if (this.maxCanvasPixels > 0) {\n      let pixelsInViewport = viewport.width * viewport.height;\n      let maxScale = Math.sqrt(this.maxCanvasPixels / pixelsInViewport);\n      if (outputScale.sx > maxScale || outputScale.sy > maxScale) {\n        outputScale.sx = maxScale;\n        outputScale.sy = maxScale;\n        outputScale.scaled = true;\n        this.hasRestrictedScaling = true;\n      } else {\n        this.hasRestrictedScaling = false;\n      }\n    }\n\n    let sfx = approximateFraction(outputScale.sx);\n    let sfy = approximateFraction(outputScale.sy);\n    canvas.width = roundToDivide(viewport.width * outputScale.sx, sfx[0]);\n    canvas.height = roundToDivide(viewport.height * outputScale.sy, sfy[0]);\n    canvas.style.width = roundToDivide(viewport.width, sfx[1]) + 'px';\n    canvas.style.height = roundToDivide(viewport.height, sfy[1]) + 'px';\n    // Add the viewport so it's known what it was originally drawn with.\n    this.paintedViewportMap.set(canvas, viewport);\n\n    // Rendering area\n    let transform = !outputScale.scaled ? null :\n      [outputScale.sx, 0, 0, outputScale.sy, 0, 0];\n    let renderContext = {\n      canvasContext: ctx,\n      transform,\n      viewport: this.viewport,\n      enableWebGL: this.enableWebGL,\n      renderInteractiveForms: this.renderInteractiveForms,\n    };\n    let renderTask = this.pdfPage.render(renderContext);\n    renderTask.onContinue = function (cont) {\n      showCanvas();\n      if (result.onRenderContinue) {\n        result.onRenderContinue(cont);\n      } else {\n        cont();\n      }\n    };\n\n    renderTask.promise.then(function() {\n      showCanvas();\n      renderCapability.resolve(undefined);\n    }, function(error) {\n      showCanvas();\n      renderCapability.reject(error);\n    });\n    return result;\n  }\n\n  paintOnSvg(wrapper) {\n    if (typeof PDFJSDev !== 'undefined' &&\n        PDFJSDev.test('FIREFOX || MOZCENTRAL || CHROME')) {\n      // Return a mock object, to prevent errors such as e.g.\n      // \"TypeError: paintTask.promise is undefined\".\n      return {\n        promise: Promise.reject(new Error('SVG rendering is not supported.')),\n        onRenderContinue(cont) { },\n        cancel() { },\n      };\n    }\n\n    let cancelled = false;\n    let ensureNotCancelled = () => {\n      if (cancelled) {\n        throw new RenderingCancelledException(\n          'Rendering cancelled, page ' + this.id, 'svg');\n      }\n    };\n\n    let pdfPage = this.pdfPage;\n    let actualSizeViewport = this.viewport.clone({ scale: CSS_UNITS, });\n    let promise = pdfPage.getOperatorList().then((opList) => {\n      ensureNotCancelled();\n      let svgGfx = new SVGGraphics(pdfPage.commonObjs, pdfPage.objs);\n      return svgGfx.getSVG(opList, actualSizeViewport).then((svg) => {\n        ensureNotCancelled();\n        this.svg = svg;\n        this.paintedViewportMap.set(svg, actualSizeViewport);\n\n        svg.style.width = wrapper.style.width;\n        svg.style.height = wrapper.style.height;\n        this.renderingState = RenderingStates.FINISHED;\n        wrapper.appendChild(svg);\n      });\n    });\n\n    return {\n      promise,\n      onRenderContinue(cont) {\n        cont();\n      },\n      cancel() {\n        cancelled = true;\n      },\n    };\n  }\n\n  /**\n   * @param {string|null} label\n   */\n  setPageLabel(label) {\n    this.pageLabel = (typeof label === 'string' ? label : null);\n\n    if (this.pageLabel !== null) {\n      this.div.setAttribute('data-page-label', this.pageLabel);\n    } else {\n      this.div.removeAttribute('data-page-label');\n    }\n  }\n}\n\nexport {\n  PDFPageView,\n};\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { getGlobalEventBus } from './ui_utils';\nimport { renderTextLayer } from 'pdfjs-lib';\n\nconst EXPAND_DIVS_TIMEOUT = 300; // ms\n\n/**\n * @typedef {Object} TextLayerBuilderOptions\n * @property {HTMLDivElement} textLayerDiv - The text layer container.\n * @property {EventBus} eventBus - The application event bus.\n * @property {number} pageIndex - The page index.\n * @property {PageViewport} viewport - The viewport of the text layer.\n * @property {PDFFindController} findController\n * @property {boolean} enhanceTextSelection - Option to turn on improved\n *   text selection.\n */\n\n/**\n * The text layer builder provides text selection functionality for the PDF.\n * It does this by creating overlay divs over the PDF's text. These divs\n * contain text that matches the PDF text they are overlaying. This object\n * also provides a way to highlight text that is being searched for.\n */\nclass TextLayerBuilder {\n  constructor({ textLayerDiv, eventBus, pageIndex, viewport,\n                findController = null, enhanceTextSelection = false, }) {\n    this.textLayerDiv = textLayerDiv;\n    this.eventBus = eventBus || getGlobalEventBus();\n    this.textContent = null;\n    this.textContentItemsStr = [];\n    this.textContentStream = null;\n    this.renderingDone = false;\n    this.pageIdx = pageIndex;\n    this.pageNumber = this.pageIdx + 1;\n    this.matches = [];\n    this.viewport = viewport;\n    this.textDivs = [];\n    this.findController = findController;\n    this.textLayerRenderTask = null;\n    this.enhanceTextSelection = enhanceTextSelection;\n\n    this._onUpdateTextLayerMatches = null;\n    this._bindMouse();\n  }\n\n  /**\n   * @private\n   */\n  _finishRendering() {\n    this.renderingDone = true;\n\n    if (!this.enhanceTextSelection) {\n      let endOfContent = document.createElement('div');\n      endOfContent.className = 'endOfContent';\n      this.textLayerDiv.appendChild(endOfContent);\n    }\n\n    this.eventBus.dispatch('textlayerrendered', {\n      source: this,\n      pageNumber: this.pageNumber,\n      numTextDivs: this.textDivs.length,\n    });\n  }\n\n  /**\n   * Renders the text layer.\n   *\n   * @param {number} timeout - (optional) wait for a specified amount of\n   *                           milliseconds before rendering\n   */\n  render(timeout = 0) {\n    if (!(this.textContent || this.textContentStream) || this.renderingDone) {\n      return;\n    }\n    this.cancel();\n\n    this.textDivs = [];\n    let textLayerFrag = document.createDocumentFragment();\n    this.textLayerRenderTask = renderTextLayer({\n      textContent: this.textContent,\n      textContentStream: this.textContentStream,\n      container: textLayerFrag,\n      viewport: this.viewport,\n      textDivs: this.textDivs,\n      textContentItemsStr: this.textContentItemsStr,\n      timeout,\n      enhanceTextSelection: this.enhanceTextSelection,\n    });\n    this.textLayerRenderTask.promise.then(() => {\n      this.textLayerDiv.appendChild(textLayerFrag);\n      this._finishRendering();\n      this._updateMatches();\n    }, function (reason) {\n      // Cancelled or failed to render text layer; skipping errors.\n    });\n\n    if (!this._onUpdateTextLayerMatches) {\n      this._onUpdateTextLayerMatches = (evt) => {\n        if (evt.pageIndex === this.pageIdx || evt.pageIndex === -1) {\n          this._updateMatches();\n        }\n      };\n      this.eventBus.on('updatetextlayermatches',\n                       this._onUpdateTextLayerMatches);\n    }\n  }\n\n  /**\n   * Cancel rendering of the text layer.\n   */\n  cancel() {\n    if (this.textLayerRenderTask) {\n      this.textLayerRenderTask.cancel();\n      this.textLayerRenderTask = null;\n    }\n    if (this._onUpdateTextLayerMatches) {\n      this.eventBus.off('updatetextlayermatches',\n                        this._onUpdateTextLayerMatches);\n      this._onUpdateTextLayerMatches = null;\n    }\n  }\n\n  setTextContentStream(readableStream) {\n    this.cancel();\n    this.textContentStream = readableStream;\n  }\n\n  setTextContent(textContent) {\n    this.cancel();\n    this.textContent = textContent;\n  }\n\n  _convertMatches(matches, matchesLength) {\n    // Early exit if there is nothing to convert.\n    if (!matches) {\n      return [];\n    }\n    const { findController, textContentItemsStr, } = this;\n\n    let i = 0, iIndex = 0;\n    const end = textContentItemsStr.length - 1;\n    const queryLen = findController.state.query.length;\n    const result = [];\n\n    for (let m = 0, mm = matches.length; m < mm; m++) {\n      // Calculate the start position.\n      let matchIdx = matches[m];\n\n      // Loop over the divIdxs.\n      while (i !== end &&\n             matchIdx >= (iIndex + textContentItemsStr[i].length)) {\n        iIndex += textContentItemsStr[i].length;\n        i++;\n      }\n\n      if (i === textContentItemsStr.length) {\n        console.error('Could not find a matching mapping');\n      }\n\n      let match = {\n        begin: {\n          divIdx: i,\n          offset: matchIdx - iIndex,\n        },\n      };\n\n      // Calculate the end position.\n      if (matchesLength) { // Multiterm search.\n        matchIdx += matchesLength[m];\n      } else { // Phrase search.\n        matchIdx += queryLen;\n      }\n\n      // Somewhat the same array as above, but use > instead of >= to get\n      // the end position right.\n      while (i !== end &&\n             matchIdx > (iIndex + textContentItemsStr[i].length)) {\n        iIndex += textContentItemsStr[i].length;\n        i++;\n      }\n\n      match.end = {\n        divIdx: i,\n        offset: matchIdx - iIndex,\n      };\n      result.push(match);\n    }\n    return result;\n  }\n\n  _renderMatches(matches) {\n    // Early exit if there is nothing to render.\n    if (matches.length === 0) {\n      return;\n    }\n    const { findController, pageIdx, textContentItemsStr, textDivs, } = this;\n\n    const isSelectedPage = (pageIdx === findController.selected.pageIdx);\n    const selectedMatchIdx = findController.selected.matchIdx;\n    const highlightAll = findController.state.highlightAll;\n    let prevEnd = null;\n    let infinity = {\n      divIdx: -1,\n      offset: undefined,\n    };\n\n    function beginText(begin, className) {\n      let divIdx = begin.divIdx;\n      textDivs[divIdx].textContent = '';\n      appendTextToDiv(divIdx, 0, begin.offset, className);\n    }\n\n    function appendTextToDiv(divIdx, fromOffset, toOffset, className) {\n      let div = textDivs[divIdx];\n      let content = textContentItemsStr[divIdx].substring(fromOffset, toOffset);\n      let node = document.createTextNode(content);\n      if (className) {\n        let span = document.createElement('span');\n        span.className = className;\n        span.appendChild(node);\n        div.appendChild(span);\n        return;\n      }\n      div.appendChild(node);\n    }\n\n    let i0 = selectedMatchIdx, i1 = i0 + 1;\n    if (highlightAll) {\n      i0 = 0;\n      i1 = matches.length;\n    } else if (!isSelectedPage) {\n      // Not highlighting all and this isn't the selected page, so do nothing.\n      return;\n    }\n\n    for (let i = i0; i < i1; i++) {\n      let match = matches[i];\n      let begin = match.begin;\n      let end = match.end;\n      const isSelected = (isSelectedPage && i === selectedMatchIdx);\n      const highlightSuffix = (isSelected ? ' selected' : '');\n\n      if (isSelected) { // Attempt to scroll the selected match into view.\n        findController.scrollMatchIntoView({\n          element: textDivs[begin.divIdx],\n          pageIndex: pageIdx,\n          matchIndex: selectedMatchIdx,\n        });\n      }\n\n      // Match inside new div.\n      if (!prevEnd || begin.divIdx !== prevEnd.divIdx) {\n        // If there was a previous div, then add the text at the end.\n        if (prevEnd !== null) {\n          appendTextToDiv(prevEnd.divIdx, prevEnd.offset, infinity.offset);\n        }\n        // Clear the divs and set the content until the starting point.\n        beginText(begin);\n      } else {\n        appendTextToDiv(prevEnd.divIdx, prevEnd.offset, begin.offset);\n      }\n\n      if (begin.divIdx === end.divIdx) {\n        appendTextToDiv(begin.divIdx, begin.offset, end.offset,\n                        'highlight' + highlightSuffix);\n      } else {\n        appendTextToDiv(begin.divIdx, begin.offset, infinity.offset,\n                        'highlight begin' + highlightSuffix);\n        for (let n0 = begin.divIdx + 1, n1 = end.divIdx; n0 < n1; n0++) {\n          textDivs[n0].className = 'highlight middle' + highlightSuffix;\n        }\n        beginText(end, 'highlight end' + highlightSuffix);\n      }\n      prevEnd = end;\n    }\n\n    if (prevEnd) {\n      appendTextToDiv(prevEnd.divIdx, prevEnd.offset, infinity.offset);\n    }\n  }\n\n  _updateMatches() {\n    // Only show matches when all rendering is done.\n    if (!this.renderingDone) {\n      return;\n    }\n    const {\n      findController, matches, pageIdx, textContentItemsStr, textDivs,\n    } = this;\n    let clearedUntilDivIdx = -1;\n\n    // Clear all current matches.\n    for (let i = 0, ii = matches.length; i < ii; i++) {\n      let match = matches[i];\n      let begin = Math.max(clearedUntilDivIdx, match.begin.divIdx);\n      for (let n = begin, end = match.end.divIdx; n <= end; n++) {\n        let div = textDivs[n];\n        div.textContent = textContentItemsStr[n];\n        div.className = '';\n      }\n      clearedUntilDivIdx = match.end.divIdx + 1;\n    }\n\n    if (!findController || !findController.highlightMatches) {\n      return;\n    }\n    // Convert the matches on the `findController` into the match format\n    // used for the textLayer.\n    const pageMatches = findController.pageMatches[pageIdx] || null;\n    const pageMatchesLength = findController.pageMatchesLength[pageIdx] || null;\n\n    this.matches = this._convertMatches(pageMatches, pageMatchesLength);\n    this._renderMatches(this.matches);\n  }\n\n  /**\n   * Improves text selection by adding an additional div where the mouse was\n   * clicked. This reduces flickering of the content if the mouse is slowly\n   * dragged up or down.\n   *\n   * @private\n   */\n  _bindMouse() {\n    let div = this.textLayerDiv;\n    let expandDivsTimer = null;\n\n    div.addEventListener('mousedown', (evt) => {\n      if (this.enhanceTextSelection && this.textLayerRenderTask) {\n        this.textLayerRenderTask.expandTextDivs(true);\n        if ((typeof PDFJSDev === 'undefined' ||\n             !PDFJSDev.test('FIREFOX || MOZCENTRAL')) &&\n            expandDivsTimer) {\n          clearTimeout(expandDivsTimer);\n          expandDivsTimer = null;\n        }\n        return;\n      }\n\n      let end = div.querySelector('.endOfContent');\n      if (!end) {\n        return;\n      }\n      if (typeof PDFJSDev === 'undefined' ||\n          !PDFJSDev.test('FIREFOX || MOZCENTRAL')) {\n        // On non-Firefox browsers, the selection will feel better if the height\n        // of the `endOfContent` div is adjusted to start at mouse click\n        // location. This avoids flickering when the selection moves up.\n        // However it does not work when selection is started on empty space.\n        let adjustTop = evt.target !== div;\n        if (typeof PDFJSDev === 'undefined' || PDFJSDev.test('GENERIC')) {\n          adjustTop = adjustTop && window.getComputedStyle(end).\n            getPropertyValue('-moz-user-select') !== 'none';\n        }\n        if (adjustTop) {\n          let divBounds = div.getBoundingClientRect();\n          let r = Math.max(0, (evt.pageY - divBounds.top) / divBounds.height);\n          end.style.top = (r * 100).toFixed(2) + '%';\n        }\n      }\n      end.classList.add('active');\n    });\n\n    div.addEventListener('mouseup', () => {\n      if (this.enhanceTextSelection && this.textLayerRenderTask) {\n        if (typeof PDFJSDev === 'undefined' ||\n            !PDFJSDev.test('FIREFOX || MOZCENTRAL')) {\n          expandDivsTimer = setTimeout(() => {\n            if (this.textLayerRenderTask) {\n              this.textLayerRenderTask.expandTextDivs(false);\n            }\n            expandDivsTimer = null;\n          }, EXPAND_DIVS_TIMEOUT);\n        } else {\n          this.textLayerRenderTask.expandTextDivs(false);\n        }\n        return;\n      }\n\n      let end = div.querySelector('.endOfContent');\n      if (!end) {\n        return;\n      }\n      if (typeof PDFJSDev === 'undefined' ||\n          !PDFJSDev.test('FIREFOX || MOZCENTRAL')) {\n        end.style.top = '';\n      }\n      end.classList.remove('active');\n    });\n  }\n}\n\n/**\n * @implements IPDFTextLayerFactory\n */\nclass DefaultTextLayerFactory {\n  /**\n   * @param {HTMLDivElement} textLayerDiv\n   * @param {number} pageIndex\n   * @param {PageViewport} viewport\n   * @param {boolean} enhanceTextSelection\n   * @returns {TextLayerBuilder}\n   */\n  createTextLayerBuilder(textLayerDiv, pageIndex, viewport,\n                         enhanceTextSelection = false) {\n    return new TextLayerBuilder({\n      textLayerDiv,\n      pageIndex,\n      viewport,\n      enhanceTextSelection,\n    });\n  }\n}\n\nexport {\n  TextLayerBuilder,\n  DefaultTextLayerFactory,\n};\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { SCROLLBAR_PADDING, ScrollMode, SpreadMode } from './ui_utils';\nimport { CursorTool } from './pdf_cursor_tools';\nimport { PDFSinglePageViewer } from './pdf_single_page_viewer';\n\n/**\n * @typedef {Object} SecondaryToolbarOptions\n * @property {HTMLDivElement} toolbar - Container for the secondary toolbar.\n * @property {HTMLButtonElement} toggleButton - Button to toggle the visibility\n *   of the secondary toolbar.\n * @property {HTMLDivElement} toolbarButtonContainer - Container where all the\n *   toolbar buttons are placed. The maximum height of the toolbar is controlled\n *   dynamically by adjusting the 'max-height' CSS property of this DOM element.\n * @property {HTMLButtonElement} presentationModeButton - Button for entering\n *   presentation mode.\n * @property {HTMLButtonElement} openFileButton - Button to open a file.\n * @property {HTMLButtonElement} printButton - Button to print the document.\n * @property {HTMLButtonElement} downloadButton - Button to download the\n *   document.\n * @property {HTMLLinkElement} viewBookmarkButton - Button to obtain a bookmark\n *   link to the current location in the document.\n * @property {HTMLButtonElement} firstPageButton - Button to go to the first\n *   page in the document.\n * @property {HTMLButtonElement} lastPageButton - Button to go to the last page\n *   in the document.\n * @property {HTMLButtonElement} pageRotateCwButton - Button to rotate the pages\n *   clockwise.\n * @property {HTMLButtonElement} pageRotateCcwButton - Button to rotate the\n *   pages counterclockwise.\n * @property {HTMLButtonElement} cursorSelectToolButton - Button to enable the\n *   select tool.\n * @property {HTMLButtonElement} cursorHandToolButton - Button to enable the\n *   hand tool.\n * @property {HTMLButtonElement} documentPropertiesButton - Button for opening\n *   the document properties dialog.\n */\n\nclass SecondaryToolbar {\n  /**\n   * @param {SecondaryToolbarOptions} options\n   * @param {HTMLDivElement} mainContainer\n   * @param {EventBus} eventBus\n   */\n  constructor(options, mainContainer, eventBus) {\n    this.toolbar = options.toolbar;\n    this.toggleButton = options.toggleButton;\n    this.toolbarButtonContainer = options.toolbarButtonContainer;\n    this.buttons = [\n      { element: options.presentationModeButton, eventName: 'presentationmode',\n        close: true, },\n      { element: options.openFileButton, eventName: 'openfile', close: true, },\n      { element: options.printButton, eventName: 'print', close: true, },\n      { element: options.downloadButton, eventName: 'download', close: true, },\n      { element: options.viewBookmarkButton, eventName: null, close: true, },\n      { element: options.firstPageButton, eventName: 'firstpage',\n        close: true, },\n      { element: options.lastPageButton, eventName: 'lastpage', close: true, },\n      { element: options.pageRotateCwButton, eventName: 'rotatecw',\n        close: false, },\n      { element: options.pageRotateCcwButton, eventName: 'rotateccw',\n        close: false, },\n      { element: options.cursorSelectToolButton, eventName: 'switchcursortool',\n        eventDetails: { tool: CursorTool.SELECT, }, close: true, },\n      { element: options.cursorHandToolButton, eventName: 'switchcursortool',\n        eventDetails: { tool: CursorTool.HAND, }, close: true, },\n      { element: options.scrollVerticalButton, eventName: 'switchscrollmode',\n        eventDetails: { mode: ScrollMode.VERTICAL, }, close: true, },\n      { element: options.scrollHorizontalButton, eventName: 'switchscrollmode',\n        eventDetails: { mode: ScrollMode.HORIZONTAL, }, close: true, },\n      { element: options.scrollWrappedButton, eventName: 'switchscrollmode',\n        eventDetails: { mode: ScrollMode.WRAPPED, }, close: true, },\n      { element: options.spreadNoneButton, eventName: 'switchspreadmode',\n        eventDetails: { mode: SpreadMode.NONE, }, close: true, },\n      { element: options.spreadOddButton, eventName: 'switchspreadmode',\n        eventDetails: { mode: SpreadMode.ODD, }, close: true, },\n      { element: options.spreadEvenButton, eventName: 'switchspreadmode',\n        eventDetails: { mode: SpreadMode.EVEN, }, close: true, },\n      { element: options.documentPropertiesButton,\n        eventName: 'documentproperties', close: true, },\n    ];\n    this.items = {\n      firstPage: options.firstPageButton,\n      lastPage: options.lastPageButton,\n      pageRotateCw: options.pageRotateCwButton,\n      pageRotateCcw: options.pageRotateCcwButton,\n    };\n\n    this.mainContainer = mainContainer;\n    this.eventBus = eventBus;\n\n    this.opened = false;\n    this.containerHeight = null;\n    this.previousContainerHeight = null;\n\n    this.reset();\n\n    // Bind the event listeners for click, cursor tool, and scroll/spread mode\n    // actions.\n    this._bindClickListeners();\n    this._bindCursorToolsListener(options);\n    this._bindScrollModeListener(options);\n    this._bindSpreadModeListener(options);\n\n    // Bind the event listener for adjusting the 'max-height' of the toolbar.\n    this.eventBus.on('resize', this._setMaxHeight.bind(this));\n\n    // Hide the Scroll/Spread mode buttons, when they're not applicable to the\n    // current `BaseViewer` instance (in particular `PDFSinglePageViewer`).\n    this.eventBus.on('baseviewerinit', (evt) => {\n      if (evt.source instanceof PDFSinglePageViewer) {\n        this.toolbarButtonContainer.classList.add('hiddenScrollModeButtons',\n                                                  'hiddenSpreadModeButtons');\n      } else {\n        this.toolbarButtonContainer.classList.remove('hiddenScrollModeButtons',\n                                                     'hiddenSpreadModeButtons');\n      }\n    });\n  }\n\n  /**\n   * @return {boolean}\n   */\n  get isOpen() {\n    return this.opened;\n  }\n\n  setPageNumber(pageNumber) {\n    this.pageNumber = pageNumber;\n    this._updateUIState();\n  }\n\n  setPagesCount(pagesCount) {\n    this.pagesCount = pagesCount;\n    this._updateUIState();\n  }\n\n  reset() {\n    this.pageNumber = 0;\n    this.pagesCount = 0;\n    this._updateUIState();\n\n    // Reset the Scroll/Spread buttons too, since they're document specific.\n    this.eventBus.dispatch('secondarytoolbarreset', { source: this, });\n  }\n\n  _updateUIState() {\n    this.items.firstPage.disabled = (this.pageNumber <= 1);\n    this.items.lastPage.disabled = (this.pageNumber >= this.pagesCount);\n    this.items.pageRotateCw.disabled = this.pagesCount === 0;\n    this.items.pageRotateCcw.disabled = this.pagesCount === 0;\n  }\n\n  _bindClickListeners() {\n    // Button to toggle the visibility of the secondary toolbar.\n    this.toggleButton.addEventListener('click', this.toggle.bind(this));\n\n    // All items within the secondary toolbar.\n    for (let button in this.buttons) {\n      let { element, eventName, close, eventDetails, } = this.buttons[button];\n\n      element.addEventListener('click', (evt) => {\n        if (eventName !== null) {\n          let details = { source: this, };\n          for (let property in eventDetails) {\n            details[property] = eventDetails[property];\n          }\n          this.eventBus.dispatch(eventName, details);\n        }\n        if (close) {\n          this.close();\n        }\n      });\n    }\n  }\n\n  _bindCursorToolsListener(buttons) {\n    this.eventBus.on('cursortoolchanged', function({ tool, }) {\n      buttons.cursorSelectToolButton.classList.toggle('toggled',\n        tool === CursorTool.SELECT);\n      buttons.cursorHandToolButton.classList.toggle('toggled',\n        tool === CursorTool.HAND);\n    });\n  }\n\n  _bindScrollModeListener(buttons) {\n    function scrollModeChanged({ mode, }) {\n      buttons.scrollVerticalButton.classList.toggle('toggled',\n        mode === ScrollMode.VERTICAL);\n      buttons.scrollHorizontalButton.classList.toggle('toggled',\n        mode === ScrollMode.HORIZONTAL);\n      buttons.scrollWrappedButton.classList.toggle('toggled',\n        mode === ScrollMode.WRAPPED);\n\n      // Temporarily *disable* the Spread buttons when horizontal scrolling is\n      // enabled, since the non-default Spread modes doesn't affect the layout.\n      const isScrollModeHorizontal = (mode === ScrollMode.HORIZONTAL);\n      buttons.spreadNoneButton.disabled = isScrollModeHorizontal;\n      buttons.spreadOddButton.disabled = isScrollModeHorizontal;\n      buttons.spreadEvenButton.disabled = isScrollModeHorizontal;\n    }\n    this.eventBus.on('scrollmodechanged', scrollModeChanged);\n\n    this.eventBus.on('secondarytoolbarreset', (evt) => {\n      if (evt.source === this) {\n        scrollModeChanged({ mode: ScrollMode.VERTICAL, });\n      }\n    });\n  }\n\n  _bindSpreadModeListener(buttons) {\n    function spreadModeChanged({ mode, }) {\n      buttons.spreadNoneButton.classList.toggle('toggled',\n        mode === SpreadMode.NONE);\n      buttons.spreadOddButton.classList.toggle('toggled',\n        mode === SpreadMode.ODD);\n      buttons.spreadEvenButton.classList.toggle('toggled',\n        mode === SpreadMode.EVEN);\n    }\n    this.eventBus.on('spreadmodechanged', spreadModeChanged);\n\n    this.eventBus.on('secondarytoolbarreset', (evt) => {\n      if (evt.source === this) {\n        spreadModeChanged({ mode: SpreadMode.NONE, });\n      }\n    });\n  }\n\n  open() {\n    if (this.opened) {\n      return;\n    }\n    this.opened = true;\n    this._setMaxHeight();\n\n    this.toggleButton.classList.add('toggled');\n    this.toolbar.classList.remove('hidden');\n  }\n\n  close() {\n    if (!this.opened) {\n      return;\n    }\n    this.opened = false;\n    this.toolbar.classList.add('hidden');\n    this.toggleButton.classList.remove('toggled');\n  }\n\n  toggle() {\n    if (this.opened) {\n      this.close();\n    } else {\n      this.open();\n    }\n  }\n\n  /**\n   * @private\n   */\n  _setMaxHeight() {\n    if (!this.opened) {\n      return; // Only adjust the 'max-height' if the toolbar is visible.\n    }\n    this.containerHeight = this.mainContainer.clientHeight;\n\n    if (this.containerHeight === this.previousContainerHeight) {\n      return;\n    }\n    this.toolbarButtonContainer.setAttribute('style',\n      'max-height: ' + (this.containerHeight - SCROLLBAR_PADDING) + 'px;');\n\n    this.previousContainerHeight = this.containerHeight;\n  }\n}\n\nexport {\n  SecondaryToolbar,\n};\n","/* Copyright 2017 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { BaseViewer } from './base_viewer';\nimport { shadow } from 'pdfjs-lib';\n\nclass PDFSinglePageViewer extends BaseViewer {\n  constructor(options) {\n    super(options);\n\n    this.eventBus.on('pagesinit', (evt) => {\n      // Since the pages are placed in a `DocumentFragment`, make sure that\n      // the current page becomes visible upon loading of the document.\n      this._ensurePageViewVisible();\n    });\n  }\n\n  get _setDocumentViewerElement() {\n    // Since we only want to display *one* page at a time when using the\n    // `PDFSinglePageViewer`, we cannot append them to the `viewer` DOM element.\n    // Instead, they are placed in a `DocumentFragment`, and only the current\n    // page is displayed in the viewer (refer to `this._ensurePageViewVisible`).\n    return shadow(this, '_setDocumentViewerElement', this._shadowViewer);\n  }\n\n  _resetView() {\n    super._resetView();\n    this._previousPageNumber = 1;\n    this._shadowViewer = document.createDocumentFragment();\n    this._updateScrollDown = null;\n  }\n\n  _ensurePageViewVisible() {\n    let pageView = this._pages[this._currentPageNumber - 1];\n    let previousPageView = this._pages[this._previousPageNumber - 1];\n\n    let viewerNodes = this.viewer.childNodes;\n    switch (viewerNodes.length) {\n      case 0: // Should *only* occur on initial loading.\n        this.viewer.appendChild(pageView.div);\n        break;\n      case 1: // The normal page-switching case.\n        if (viewerNodes[0] !== previousPageView.div) {\n          throw new Error(\n            '_ensurePageViewVisible: Unexpected previously visible page.');\n        }\n        if (pageView === previousPageView) {\n          break; // The correct page is already visible.\n        }\n        // Switch visible pages, and reset the viewerContainer scroll position.\n        this._shadowViewer.appendChild(previousPageView.div);\n        this.viewer.appendChild(pageView.div);\n\n        this.container.scrollTop = 0;\n        break;\n      default:\n        throw new Error(\n          '_ensurePageViewVisible: Only one page should be visible at a time.');\n    }\n    this._previousPageNumber = this._currentPageNumber;\n  }\n\n  _scrollUpdate() {\n    if (this._updateScrollDown) {\n      this._updateScrollDown();\n    }\n    super._scrollUpdate();\n  }\n\n  _scrollIntoView({ pageDiv, pageSpot = null, pageNumber = null, }) {\n    if (pageNumber) { // Ensure that `this._currentPageNumber` is correct.\n      this._setCurrentPageNumber(pageNumber);\n    }\n    const scrolledDown = this._currentPageNumber >= this._previousPageNumber;\n\n    this._ensurePageViewVisible();\n    // Ensure that rendering always occurs, to avoid showing a blank page,\n    // even if the current position doesn't change when the page is scrolled.\n    this.update();\n\n    super._scrollIntoView({ pageDiv, pageSpot, pageNumber, });\n\n    // Since scrolling is tracked using `requestAnimationFrame`, update the\n    // scroll direction during the next `this._scrollUpdate` invocation.\n    this._updateScrollDown = () => {\n      this.scroll.down = scrolledDown;\n      this._updateScrollDown = null;\n    };\n  }\n\n  _getVisiblePages() {\n    return this._getCurrentVisiblePage();\n  }\n\n  _updateHelper(visiblePages) { }\n\n  get _isScrollModeHorizontal() {\n    // The Scroll/Spread modes are never used in `PDFSinglePageViewer`.\n    return shadow(this, '_isScrollModeHorizontal', false);\n  }\n\n  _updateScrollMode() { }\n\n  _updateSpreadMode() { }\n}\n\nexport {\n  PDFSinglePageViewer,\n};\n","/* Copyright 2016 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  animationStarted, DEFAULT_SCALE, DEFAULT_SCALE_VALUE, MAX_SCALE,\n  MIN_SCALE, noContextMenuHandler, NullL10n\n} from './ui_utils';\n\nconst PAGE_NUMBER_LOADING_INDICATOR = 'visiblePageIsLoading';\nconst SCALE_SELECT_CONTAINER_PADDING = 8;\nconst SCALE_SELECT_PADDING = 22;\n\n/**\n * @typedef {Object} ToolbarOptions\n * @property {HTMLDivElement} container - Container for the secondary toolbar.\n * @property {HTMLSpanElement} numPages - Label that contains number of pages.\n * @property {HTMLInputElement} pageNumber - Control for display and user input\n *   of the current page number.\n * @property {HTMLSpanElement} scaleSelectContainer - Container where scale\n *   controls are placed. The width is adjusted on UI initialization.\n * @property {HTMLSelectElement} scaleSelect - Scale selection control.\n * @property {HTMLOptionElement} customScaleOption - The item used to display\n *   a non-predefined scale.\n * @property {HTMLButtonElement} previous - Button to go to the previous page.\n * @property {HTMLButtonElement} next - Button to go to the next page.\n * @property {HTMLButtonElement} zoomIn - Button to zoom in the pages.\n * @property {HTMLButtonElement} zoomOut - Button to zoom out the pages.\n * @property {HTMLButtonElement} viewFind - Button to open find bar.\n * @property {HTMLButtonElement} openFile - Button to open a new document.\n * @property {HTMLButtonElement} presentationModeButton - Button to switch to\n *   presentation mode.\n * @property {HTMLButtonElement} download - Button to download the document.\n * @property {HTMLAElement} viewBookmark - Element to link current url of\n *   the page view.\n */\n\nclass Toolbar {\n  /**\n   * @param {ToolbarOptions} options\n   * @param {EventBus} eventBus\n   * @param {IL10n} l10n - Localization service.\n   */\n  constructor(options, eventBus, l10n = NullL10n) {\n    this.toolbar = options.container;\n    this.eventBus = eventBus;\n    this.l10n = l10n;\n    this.items = options;\n\n    this._wasLocalized = false;\n    this.reset();\n\n    // Bind the event listeners for click and hand tool actions.\n    this._bindListeners();\n  }\n\n  setPageNumber(pageNumber, pageLabel) {\n    this.pageNumber = pageNumber;\n    this.pageLabel = pageLabel;\n    this._updateUIState(false);\n  }\n\n  setPagesCount(pagesCount, hasPageLabels) {\n    this.pagesCount = pagesCount;\n    this.hasPageLabels = hasPageLabels;\n    this._updateUIState(true);\n  }\n\n  setPageScale(pageScaleValue, pageScale) {\n    this.pageScaleValue = (pageScaleValue || pageScale).toString();\n    this.pageScale = pageScale;\n    this._updateUIState(false);\n  }\n\n  reset() {\n    this.pageNumber = 0;\n    this.pageLabel = null;\n    this.hasPageLabels = false;\n    this.pagesCount = 0;\n    this.pageScaleValue = DEFAULT_SCALE_VALUE;\n    this.pageScale = DEFAULT_SCALE;\n    this._updateUIState(true);\n    this.updateLoadingIndicatorState();\n  }\n\n  _bindListeners() {\n    let { eventBus, items, } = this;\n    let self = this;\n\n    items.previous.addEventListener('click', function() {\n      eventBus.dispatch('previouspage', { source: self, });\n    });\n\n    items.next.addEventListener('click', function() {\n      eventBus.dispatch('nextpage', { source: self, });\n    });\n\n    items.zoomIn.addEventListener('click', function() {\n      eventBus.dispatch('zoomin', { source: self, });\n    });\n\n    items.zoomOut.addEventListener('click', function() {\n      eventBus.dispatch('zoomout', { source: self, });\n    });\n\n    items.pageNumber.addEventListener('click', function() {\n      this.select();\n    });\n\n    items.pageNumber.addEventListener('change', function() {\n      eventBus.dispatch('pagenumberchanged', {\n        source: self,\n        value: this.value,\n      });\n    });\n\n    items.scaleSelect.addEventListener('change', function() {\n      if (this.value === 'custom') {\n        return;\n      }\n      eventBus.dispatch('scalechanged', {\n        source: self,\n        value: this.value,\n      });\n    });\n\n    items.presentationModeButton.addEventListener('click', function() {\n      eventBus.dispatch('presentationmode', { source: self, });\n    });\n\n    items.openFile.addEventListener('click', function() {\n      eventBus.dispatch('openfile', { source: self, });\n    });\n\n    items.print.addEventListener('click', function() {\n      eventBus.dispatch('print', { source: self, });\n    });\n\n    items.download.addEventListener('click', function() {\n      eventBus.dispatch('download', { source: self, });\n    });\n\n    // Suppress context menus for some controls.\n    items.scaleSelect.oncontextmenu = noContextMenuHandler;\n\n    eventBus.on('localized', () => {\n      this._localized();\n    });\n  }\n\n  _localized() {\n    this._wasLocalized = true;\n    this._adjustScaleWidth();\n    this._updateUIState(true);\n  }\n\n  _updateUIState(resetNumPages = false) {\n    if (!this._wasLocalized) {\n      // Don't update the UI state until we localize the toolbar.\n      return;\n    }\n    const { pageNumber, pagesCount, pageScaleValue, pageScale, items, } = this;\n\n    if (resetNumPages) {\n      if (this.hasPageLabels) {\n        items.pageNumber.type = 'text';\n      } else {\n        items.pageNumber.type = 'number';\n        this.l10n.get('of_pages', { pagesCount, }, 'of {{pagesCount}}').\n            then((msg) => {\n          items.numPages.textContent = msg;\n        });\n      }\n      items.pageNumber.max = pagesCount;\n    }\n\n    if (this.hasPageLabels) {\n      items.pageNumber.value = this.pageLabel;\n      this.l10n.get('page_of_pages', { pageNumber, pagesCount, },\n                    '({{pageNumber}} of {{pagesCount}})').then((msg) => {\n        items.numPages.textContent = msg;\n      });\n    } else {\n      items.pageNumber.value = pageNumber;\n    }\n\n    items.previous.disabled = (pageNumber <= 1);\n    items.next.disabled = (pageNumber >= pagesCount);\n\n    items.zoomOut.disabled = (pageScale <= MIN_SCALE);\n    items.zoomIn.disabled = (pageScale >= MAX_SCALE);\n\n    let customScale = Math.round(pageScale * 10000) / 100;\n    this.l10n.get('page_scale_percent', { scale: customScale, },\n                  '{{scale}}%').then((msg) => {\n      let options = items.scaleSelect.options;\n      let predefinedValueFound = false;\n      for (let i = 0, ii = options.length; i < ii; i++) {\n        let option = options[i];\n        if (option.value !== pageScaleValue) {\n          option.selected = false;\n          continue;\n        }\n        option.selected = true;\n        predefinedValueFound = true;\n      }\n      if (!predefinedValueFound) {\n        items.customScaleOption.textContent = msg;\n        items.customScaleOption.selected = true;\n      }\n    });\n  }\n\n  updateLoadingIndicatorState(loading = false) {\n    let pageNumberInput = this.items.pageNumber;\n\n    pageNumberInput.classList.toggle(PAGE_NUMBER_LOADING_INDICATOR, loading);\n  }\n\n  _adjustScaleWidth() {\n    let container = this.items.scaleSelectContainer;\n    let select = this.items.scaleSelect;\n\n    animationStarted.then(function() {\n      // Adjust the width of the zoom box to fit the content.\n      // Note: If the window is narrow enough that the zoom box is not\n      //       visible, we temporarily show it to be able to adjust its width.\n      if (container.clientWidth === 0) {\n        container.setAttribute('style', 'display: inherit;');\n      }\n      if (container.clientWidth > 0) {\n        select.setAttribute('style', 'min-width: inherit;');\n        let width = select.clientWidth + SCALE_SELECT_CONTAINER_PADDING;\n        select.setAttribute('style', 'min-width: ' +\n                                     (width + SCALE_SELECT_PADDING) + 'px;');\n        container.setAttribute('style', 'min-width: ' + width + 'px; ' +\n                                        'max-width: ' + width + 'px;');\n      }\n    });\n  }\n}\n\nexport {\n  Toolbar,\n};\n","/* Copyright 2012 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst DEFAULT_VIEW_HISTORY_CACHE_SIZE = 20;\n\n/**\n * View History - This is a utility for saving various view parameters for\n *                recently opened files.\n *\n * The way that the view parameters are stored depends on how PDF.js is built,\n * for 'gulp <flag>' the following cases exist:\n *  - FIREFOX or MOZCENTRAL - uses sessionStorage.\n *  - GENERIC or CHROME     - uses localStorage, if it is available.\n */\nclass ViewHistory {\n  constructor(fingerprint, cacheSize = DEFAULT_VIEW_HISTORY_CACHE_SIZE) {\n    this.fingerprint = fingerprint;\n    this.cacheSize = cacheSize;\n\n    this._initializedPromise = this._readFromStorage().then((databaseStr) => {\n      let database = JSON.parse(databaseStr || '{}');\n      if (!('files' in database)) {\n        database.files = [];\n      } else {\n        while (database.files.length >= this.cacheSize) {\n          database.files.shift();\n        }\n      }\n      let index = -1;\n      for (let i = 0, length = database.files.length; i < length; i++) {\n        let branch = database.files[i];\n        if (branch.fingerprint === this.fingerprint) {\n          index = i;\n          break;\n        }\n      }\n      if (index === -1) {\n        index = database.files.push({ fingerprint: this.fingerprint, }) - 1;\n      }\n      this.file = database.files[index];\n      this.database = database;\n    });\n  }\n\n  async _writeToStorage() {\n    let databaseStr = JSON.stringify(this.database);\n\n    if (typeof PDFJSDev !== 'undefined' &&\n        PDFJSDev.test('FIREFOX || MOZCENTRAL')) {\n      sessionStorage.setItem('pdfjs.history', databaseStr);\n      return;\n    }\n    localStorage.setItem('pdfjs.history', databaseStr);\n  }\n\n  async _readFromStorage() {\n    if (typeof PDFJSDev !== 'undefined' &&\n        PDFJSDev.test('FIREFOX || MOZCENTRAL')) {\n      return sessionStorage.getItem('pdfjs.history');\n    }\n    return localStorage.getItem('pdfjs.history');\n  }\n\n  async set(name, val) {\n    await this._initializedPromise;\n    this.file[name] = val;\n    return this._writeToStorage();\n  }\n\n  async setMultiple(properties) {\n    await this._initializedPromise;\n    for (let name in properties) {\n      this.file[name] = properties[name];\n    }\n    return this._writeToStorage();\n  }\n\n  async get(name, defaultValue) {\n    await this._initializedPromise;\n    let val = this.file[name];\n    return val !== undefined ? val : defaultValue;\n  }\n\n  async getMultiple(properties) {\n    await this._initializedPromise;\n    let values = Object.create(null);\n\n    for (let name in properties) {\n      let val = this.file[name];\n      values[name] = val !== undefined ? val : properties[name];\n    }\n    return values;\n  }\n}\n\nexport {\n  ViewHistory,\n};\n","/* Copyright 2017 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DefaultExternalServices, PDFViewerApplication } from './app';\nimport { BasePreferences } from './preferences';\nimport { DownloadManager } from './download_manager';\nimport { GenericL10n } from './genericl10n';\n\nif (typeof PDFJSDev !== 'undefined' && !PDFJSDev.test('GENERIC')) {\n  throw new Error('Module \"pdfjs-web/genericcom\" shall not be used outside ' +\n                  'GENERIC build.');\n}\n\nlet GenericCom = {};\n\nclass GenericPreferences extends BasePreferences {\n  async _writeToStorage(prefObj) {\n    localStorage.setItem('pdfjs.preferences', JSON.stringify(prefObj));\n  }\n\n  async _readFromStorage(prefObj) {\n    return JSON.parse(localStorage.getItem('pdfjs.preferences'));\n  }\n}\n\nlet GenericExternalServices = Object.create(DefaultExternalServices);\nGenericExternalServices.createDownloadManager = function(options) {\n  return new DownloadManager(options);\n};\nGenericExternalServices.createPreferences = function() {\n  return new GenericPreferences();\n};\nGenericExternalServices.createL10n = function({ locale = 'en-US', }) {\n  return new GenericL10n(locale);\n};\nPDFViewerApplication.externalServices = GenericExternalServices;\n\nexport {\n  GenericCom,\n};\n","/* Copyright 2013 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nlet defaultPreferences = null;\nfunction getDefaultPreferences() {\n  if (!defaultPreferences) {\n    if (typeof PDFJSDev !== 'undefined' && PDFJSDev.test('PRODUCTION')) {\n      defaultPreferences = Promise.resolve(\n        PDFJSDev.json('$ROOT/build/default_preferences.json'));\n    } else {\n      defaultPreferences = new Promise(function(resolve, reject) {\n        if (typeof SystemJS === 'object') {\n          SystemJS.import('./app_options').then(resolve, reject);\n        } else if (typeof require === 'function') {\n          try {\n            resolve(require('./app_options.js'));\n          } catch (ex) {\n            reject(ex);\n          }\n        } else {\n          reject(new Error(\n            'SystemJS or CommonJS must be used to load AppOptions.'));\n        }\n      }).then(function({ AppOptions, OptionKind, }) {\n        return AppOptions.getAll(OptionKind.PREFERENCE);\n      });\n    }\n  }\n  return defaultPreferences;\n}\n\n/**\n * BasePreferences - Abstract base class for storing persistent settings.\n *   Used for settings that should be applied to all opened documents,\n *   or every time the viewer is loaded.\n */\nclass BasePreferences {\n  constructor() {\n    if (this.constructor === BasePreferences) {\n      throw new Error('Cannot initialize BasePreferences.');\n    }\n    this.prefs = null;\n\n    this._initializedPromise = getDefaultPreferences().then((defaults) => {\n      Object.defineProperty(this, 'defaults', {\n        value: Object.freeze(defaults),\n        writable: false,\n        enumerable: true,\n        configurable: false,\n      });\n\n      this.prefs = Object.assign(Object.create(null), defaults);\n      return this._readFromStorage(defaults);\n    }).then((prefs) => {\n      if (!prefs) {\n        return;\n      }\n      for (let name in prefs) {\n        const defaultValue = this.defaults[name], prefValue = prefs[name];\n        // Ignore preferences not present in, or whose types don't match,\n        // the default values.\n        if (defaultValue === undefined ||\n            typeof prefValue !== typeof defaultValue) {\n          continue;\n        }\n        this.prefs[name] = prefValue;\n      }\n    });\n  }\n\n  /**\n   * Stub function for writing preferences to storage.\n   * @param {Object} prefObj The preferences that should be written to storage.\n   * @return {Promise} A promise that is resolved when the preference values\n   *                   have been written.\n   */\n  async _writeToStorage(prefObj) {\n    throw new Error('Not implemented: _writeToStorage');\n  }\n\n  /**\n   * Stub function for reading preferences from storage.\n   * @param {Object} prefObj The preferences that should be read from storage.\n   * @return {Promise} A promise that is resolved with an {Object} containing\n   *                   the preferences that have been read.\n   */\n  async _readFromStorage(prefObj) {\n    throw new Error('Not implemented: _readFromStorage');\n  }\n\n  /**\n   * Reset the preferences to their default values and update storage.\n   * @return {Promise} A promise that is resolved when the preference values\n   *                   have been reset.\n   */\n  async reset() {\n    await this._initializedPromise;\n    this.prefs = Object.assign(Object.create(null), this.defaults);\n    return this._writeToStorage(this.defaults);\n  }\n\n  /**\n   * Set the value of a preference.\n   * @param {string} name The name of the preference that should be changed.\n   * @param {boolean|number|string} value The new value of the preference.\n   * @return {Promise} A promise that is resolved when the value has been set,\n   *                   provided that the preference exists and the types match.\n   */\n  async set(name, value) {\n    await this._initializedPromise;\n    let defaultValue = this.defaults[name];\n\n    if (defaultValue === undefined) {\n      throw new Error(`Set preference: \"${name}\" is undefined.`);\n    } else if (value === undefined) {\n      throw new Error('Set preference: no value is specified.');\n    }\n    let valueType = typeof value;\n    let defaultType = typeof defaultValue;\n\n    if (valueType !== defaultType) {\n      if (valueType === 'number' && defaultType === 'string') {\n        value = value.toString();\n      } else {\n        throw new Error(`Set preference: \"${value}\" is a ${valueType}, ` +\n                        `expected a ${defaultType}.`);\n      }\n    } else {\n      if (valueType === 'number' && !Number.isInteger(value)) {\n        throw new Error(`Set preference: \"${value}\" must be an integer.`);\n      }\n    }\n    this.prefs[name] = value;\n    return this._writeToStorage(this.prefs);\n  }\n\n  /**\n   * Get the value of a preference.\n   * @param {string} name The name of the preference whose value is requested.\n   * @return {Promise} A promise that is resolved with a {boolean|number|string}\n   *                   containing the value of the preference.\n   */\n  async get(name) {\n    await this._initializedPromise;\n    let defaultValue = this.defaults[name];\n\n    if (defaultValue === undefined) {\n      throw new Error(`Get preference: \"${name}\" is undefined.`);\n    } else {\n      let prefValue = this.prefs[name];\n\n      if (prefValue !== undefined) {\n        return prefValue;\n      }\n    }\n    return defaultValue;\n  }\n\n  /**\n   * Get the values of all preferences.\n   * @return {Promise} A promise that is resolved with an {Object} containing\n   *                   the values of all preferences.\n   */\n  async getAll() {\n    await this._initializedPromise;\n    return Object.assign(Object.create(null), this.defaults, this.prefs);\n  }\n}\n\nexport {\n  BasePreferences,\n};\n","/* Copyright 2013 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  apiCompatibilityParams, createObjectURL, createValidAbsoluteUrl\n} from 'pdfjs-lib';\n\nif (typeof PDFJSDev !== 'undefined' && !PDFJSDev.test('CHROME || GENERIC')) {\n  throw new Error('Module \"pdfjs-web/download_manager\" shall not be used ' +\n                  'outside CHROME and GENERIC builds.');\n}\n\nconst DISABLE_CREATE_OBJECT_URL =\n  apiCompatibilityParams.disableCreateObjectURL || false;\n\nfunction download(blobUrl, filename) {\n  let a = document.createElement('a');\n  if (!a.click) {\n    throw new Error('DownloadManager: \"a.click()\" is not supported.');\n  }\n  a.href = blobUrl;\n  a.target = '_parent';\n  // Use a.download if available. This increases the likelihood that\n  // the file is downloaded instead of opened by another PDF plugin.\n  if ('download' in a) {\n    a.download = filename;\n  }\n  // <a> must be in the document for IE and recent Firefox versions,\n  // otherwise .click() is ignored.\n  (document.body || document.documentElement).appendChild(a);\n  a.click();\n  a.remove();\n}\n\nclass DownloadManager {\n  constructor({ disableCreateObjectURL = DISABLE_CREATE_OBJECT_URL, }) {\n    this.disableCreateObjectURL = disableCreateObjectURL;\n  }\n\n  downloadUrl(url, filename) {\n    if (!createValidAbsoluteUrl(url, 'http://example.com')) {\n      return; // restricted/invalid URL\n    }\n    download(url + '#pdfjs.action=download', filename);\n  }\n\n  downloadData(data, filename, contentType) {\n    if (navigator.msSaveBlob) { // IE10 and above\n      navigator.msSaveBlob(new Blob([data], { type: contentType, }), filename);\n      return;\n    }\n    let blobUrl = createObjectURL(data, contentType,\n                                  this.disableCreateObjectURL);\n    download(blobUrl, filename);\n  }\n\n  download(blob, url, filename) {\n    if (navigator.msSaveBlob) {\n      // IE10 / IE11\n      if (!navigator.msSaveBlob(blob, filename)) {\n        this.downloadUrl(url, filename);\n      }\n      return;\n    }\n\n    if (this.disableCreateObjectURL) {\n      // URL.createObjectURL is not supported\n      this.downloadUrl(url, filename);\n      return;\n    }\n\n    let blobUrl = URL.createObjectURL(blob);\n    download(blobUrl, filename);\n  }\n}\n\nexport {\n  DownloadManager,\n};\n","/* Copyright 2017 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport '../external/webL10n/l10n';\n\nlet webL10n = document.webL10n;\n\nclass GenericL10n {\n  constructor(lang) {\n    this._lang = lang;\n    this._ready = new Promise((resolve, reject) => {\n      webL10n.setLanguage(lang, () => {\n        resolve(webL10n);\n      });\n    });\n  }\n\n  async getLanguage() {\n    const l10n = await this._ready;\n    return l10n.getLanguage();\n  }\n\n  async getDirection() {\n    const l10n = await this._ready;\n    return l10n.getDirection();\n  }\n\n  async get(property, args, fallback) {\n    const l10n = await this._ready;\n    return l10n.get(property, args, fallback);\n  }\n\n  async translate(element) {\n    const l10n = await this._ready;\n    return l10n.translate(element);\n  }\n}\n\nexport {\n  GenericL10n,\n};\n","/**\n * Copyright (c) 2011-2013 Fabien Cazenave, Mozilla.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to\n * deal in the Software without restriction, including without limitation the\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\n * sell copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\n * IN THE SOFTWARE.\n */\n/*\n  Additional modifications for PDF.js project:\n    - Disables language initialization on page loading.\n    - Disables document translation on page loading.\n    - Removes consoleWarn and consoleLog and use console.log/warn directly.\n    - Removes window._ assignment.\n    - Remove compatibility code for OldIE.\n    - Replaces `String.prototype.substr()` with `String.prototype.substring()`.\n    - Removes `fireL10nReadyEvent` since the \"localized\" event it dispatches\n      is unused and may clash with an identically named event in the viewer.\n*/\n\n/*jshint browser: true, devel: true, es5: true, globalstrict: true */\n'use strict';\n\ndocument.webL10n = (function(window, document, undefined) {\n  var gL10nData = {};\n  var gTextData = '';\n  var gTextProp = 'textContent';\n  var gLanguage = '';\n  var gMacros = {};\n  var gReadyState = 'loading';\n\n\n  /**\n   * Synchronously loading l10n resources significantly minimizes flickering\n   * from displaying the app with non-localized strings and then updating the\n   * strings. Although this will block all script execution on this page, we\n   * expect that the l10n resources are available locally on flash-storage.\n   *\n   * As synchronous XHR is generally considered as a bad idea, we're still\n   * loading l10n resources asynchronously -- but we keep this in a setting,\n   * just in case... and applications using this library should hide their\n   * content until the `localized' event happens.\n   */\n\n  var gAsyncResourceLoading = true; // read-only\n\n\n  /**\n   * DOM helpers for the so-called \"HTML API\".\n   *\n   * These functions are written for modern browsers. For old versions of IE,\n   * they're overridden in the 'startup' section at the end of this file.\n   */\n\n  function getL10nResourceLinks() {\n    return document.querySelectorAll('link[type=\"application/l10n\"]');\n  }\n\n  function getL10nDictionary() {\n    var script = document.querySelector('script[type=\"application/l10n\"]');\n    // TODO: support multiple and external JSON dictionaries\n    return script ? JSON.parse(script.innerHTML) : null;\n  }\n\n  function getTranslatableChildren(element) {\n    return element ? element.querySelectorAll('*[data-l10n-id]') : [];\n  }\n\n  function getL10nAttributes(element) {\n    if (!element)\n      return {};\n\n    var l10nId = element.getAttribute('data-l10n-id');\n    var l10nArgs = element.getAttribute('data-l10n-args');\n    var args = {};\n    if (l10nArgs) {\n      try {\n        args = JSON.parse(l10nArgs);\n      } catch (e) {\n        console.warn('could not parse arguments for #' + l10nId);\n      }\n    }\n    return { id: l10nId, args: args };\n  }\n\n  function xhrLoadText(url, onSuccess, onFailure) {\n    onSuccess = onSuccess || function _onSuccess(data) {};\n    onFailure = onFailure || function _onFailure() {};\n\n    var xhr = new XMLHttpRequest();\n    xhr.open('GET', url, gAsyncResourceLoading);\n    if (xhr.overrideMimeType) {\n      xhr.overrideMimeType('text/plain; charset=utf-8');\n    }\n    xhr.onreadystatechange = function() {\n      if (xhr.readyState == 4) {\n        if (xhr.status == 200 || xhr.status === 0) {\n          onSuccess(xhr.responseText);\n        } else {\n          onFailure();\n        }\n      }\n    };\n    xhr.onerror = onFailure;\n    xhr.ontimeout = onFailure;\n\n    // in Firefox OS with the app:// protocol, trying to XHR a non-existing\n    // URL will raise an exception here -- hence this ugly try...catch.\n    try {\n      xhr.send(null);\n    } catch (e) {\n      onFailure();\n    }\n  }\n\n\n  /**\n   * l10n resource parser:\n   *  - reads (async XHR) the l10n resource matching `lang';\n   *  - imports linked resources (synchronously) when specified;\n   *  - parses the text data (fills `gL10nData' and `gTextData');\n   *  - triggers success/failure callbacks when done.\n   *\n   * @param {string} href\n   *    URL of the l10n resource to parse.\n   *\n   * @param {string} lang\n   *    locale (language) to parse. Must be a lowercase string.\n   *\n   * @param {Function} successCallback\n   *    triggered when the l10n resource has been successfully parsed.\n   *\n   * @param {Function} failureCallback\n   *    triggered when the an error has occurred.\n   *\n   * @return {void}\n   *    uses the following global variables: gL10nData, gTextData, gTextProp.\n   */\n\n  function parseResource(href, lang, successCallback, failureCallback) {\n    var baseURL = href.replace(/[^\\/]*$/, '') || './';\n\n    // handle escaped characters (backslashes) in a string\n    function evalString(text) {\n      if (text.lastIndexOf('\\\\') < 0)\n        return text;\n      return text.replace(/\\\\\\\\/g, '\\\\')\n                 .replace(/\\\\n/g, '\\n')\n                 .replace(/\\\\r/g, '\\r')\n                 .replace(/\\\\t/g, '\\t')\n                 .replace(/\\\\b/g, '\\b')\n                 .replace(/\\\\f/g, '\\f')\n                 .replace(/\\\\{/g, '{')\n                 .replace(/\\\\}/g, '}')\n                 .replace(/\\\\\"/g, '\"')\n                 .replace(/\\\\'/g, \"'\");\n    }\n\n    // parse *.properties text data into an l10n dictionary\n    // If gAsyncResourceLoading is false, then the callback will be called\n    // synchronously. Otherwise it is called asynchronously.\n    function parseProperties(text, parsedPropertiesCallback) {\n      var dictionary = {};\n\n      // token expressions\n      var reBlank = /^\\s*|\\s*$/;\n      var reComment = /^\\s*#|^\\s*$/;\n      var reSection = /^\\s*\\[(.*)\\]\\s*$/;\n      var reImport = /^\\s*@import\\s+url\\((.*)\\)\\s*$/i;\n      var reSplit = /^([^=\\s]*)\\s*=\\s*(.+)$/; // TODO: escape EOLs with '\\'\n\n      // parse the *.properties file into an associative array\n      function parseRawLines(rawText, extendedSyntax, parsedRawLinesCallback) {\n        var entries = rawText.replace(reBlank, '').split(/[\\r\\n]+/);\n        var currentLang = '*';\n        var genericLang = lang.split('-', 1)[0];\n        var skipLang = false;\n        var match = '';\n\n        function nextEntry() {\n          // Use infinite loop instead of recursion to avoid reaching the\n          // maximum recursion limit for content with many lines.\n          while (true) {\n            if (!entries.length) {\n              parsedRawLinesCallback();\n              return;\n            }\n            var line = entries.shift();\n\n            // comment or blank line?\n            if (reComment.test(line))\n              continue;\n\n            // the extended syntax supports [lang] sections and @import rules\n            if (extendedSyntax) {\n              match = reSection.exec(line);\n              if (match) { // section start?\n                // RFC 4646, section 4.4, \"All comparisons MUST be performed\n                // in a case-insensitive manner.\"\n\n                currentLang = match[1].toLowerCase();\n                skipLang = (currentLang !== '*') &&\n                    (currentLang !== lang) && (currentLang !== genericLang);\n                continue;\n              } else if (skipLang) {\n                continue;\n              }\n              match = reImport.exec(line);\n              if (match) { // @import rule?\n                loadImport(baseURL + match[1], nextEntry);\n                return;\n              }\n            }\n\n            // key-value pair\n            var tmp = line.match(reSplit);\n            if (tmp && tmp.length == 3) {\n              dictionary[tmp[1]] = evalString(tmp[2]);\n            }\n          }\n        }\n        nextEntry();\n      }\n\n      // import another *.properties file\n      function loadImport(url, callback) {\n        xhrLoadText(url, function(content) {\n          parseRawLines(content, false, callback); // don't allow recursive imports\n        }, function () {\n          console.warn(url + ' not found.');\n          callback();\n        });\n      }\n\n      // fill the dictionary\n      parseRawLines(text, true, function() {\n        parsedPropertiesCallback(dictionary);\n      });\n    }\n\n    // load and parse l10n data (warning: global variables are used here)\n    xhrLoadText(href, function(response) {\n      gTextData += response; // mostly for debug\n\n      // parse *.properties text data into an l10n dictionary\n      parseProperties(response, function(data) {\n\n        // find attribute descriptions, if any\n        for (var key in data) {\n          var id, prop, index = key.lastIndexOf('.');\n          if (index > 0) { // an attribute has been specified\n            id = key.substring(0, index);\n            prop = key.substring(index + 1);\n          } else { // no attribute: assuming text content by default\n            id = key;\n            prop = gTextProp;\n          }\n          if (!gL10nData[id]) {\n            gL10nData[id] = {};\n          }\n          gL10nData[id][prop] = data[key];\n        }\n\n        // trigger callback\n        if (successCallback) {\n          successCallback();\n        }\n      });\n    }, failureCallback);\n  }\n\n  // load and parse all resources for the specified locale\n  function loadLocale(lang, callback) {\n    // RFC 4646, section 2.1 states that language tags have to be treated as\n    // case-insensitive. Convert to lowercase for case-insensitive comparisons.\n    if (lang) {\n      lang = lang.toLowerCase();\n    }\n\n    callback = callback || function _callback() {};\n\n    clear();\n    gLanguage = lang;\n\n    // check all <link type=\"application/l10n\" href=\"...\" /> nodes\n    // and load the resource files\n    var langLinks = getL10nResourceLinks();\n    var langCount = langLinks.length;\n    if (langCount === 0) {\n      // we might have a pre-compiled dictionary instead\n      var dict = getL10nDictionary();\n      if (dict && dict.locales && dict.default_locale) {\n        console.log('using the embedded JSON directory, early way out');\n        gL10nData = dict.locales[lang];\n        if (!gL10nData) {\n          var defaultLocale = dict.default_locale.toLowerCase();\n          for (var anyCaseLang in dict.locales) {\n            anyCaseLang = anyCaseLang.toLowerCase();\n            if (anyCaseLang === lang) {\n              gL10nData = dict.locales[lang];\n              break;\n            } else if (anyCaseLang === defaultLocale) {\n              gL10nData = dict.locales[defaultLocale];\n            }\n          }\n        }\n        callback();\n      } else {\n        console.log('no resource to load, early way out');\n      }\n      // early way out\n      gReadyState = 'complete';\n      return;\n    }\n\n    // start the callback when all resources are loaded\n    var onResourceLoaded = null;\n    var gResourceCount = 0;\n    onResourceLoaded = function() {\n      gResourceCount++;\n      if (gResourceCount >= langCount) {\n        callback();\n        gReadyState = 'complete';\n      }\n    };\n\n    // load all resource files\n    function L10nResourceLink(link) {\n      var href = link.href;\n      // Note: If |gAsyncResourceLoading| is false, then the following callbacks\n      // are synchronously called.\n      this.load = function(lang, callback) {\n        parseResource(href, lang, callback, function() {\n          console.warn(href + ' not found.');\n          // lang not found, used default resource instead\n          console.warn('\"' + lang + '\" resource not found');\n          gLanguage = '';\n          // Resource not loaded, but we still need to call the callback.\n          callback();\n        });\n      };\n    }\n\n    for (var i = 0; i < langCount; i++) {\n      var resource = new L10nResourceLink(langLinks[i]);\n      resource.load(lang, onResourceLoaded);\n    }\n  }\n\n  // clear all l10n data\n  function clear() {\n    gL10nData = {};\n    gTextData = '';\n    gLanguage = '';\n    // TODO: clear all non predefined macros.\n    // There's no such macro /yet/ but we're planning to have some...\n  }\n\n\n  /**\n   * Get rules for plural forms (shared with JetPack), see:\n   * http://unicode.org/repos/cldr-tmp/trunk/diff/supplemental/language_plural_rules.html\n   * https://github.com/mozilla/addon-sdk/blob/master/python-lib/plural-rules-generator.p\n   *\n   * @param {string} lang\n   *    locale (language) used.\n   *\n   * @return {Function}\n   *    returns a function that gives the plural form name for a given integer:\n   *       var fun = getPluralRules('en');\n   *       fun(1)    -> 'one'\n   *       fun(0)    -> 'other'\n   *       fun(1000) -> 'other'.\n   */\n\n  function getPluralRules(lang) {\n    var locales2rules = {\n      'af': 3,\n      'ak': 4,\n      'am': 4,\n      'ar': 1,\n      'asa': 3,\n      'az': 0,\n      'be': 11,\n      'bem': 3,\n      'bez': 3,\n      'bg': 3,\n      'bh': 4,\n      'bm': 0,\n      'bn': 3,\n      'bo': 0,\n      'br': 20,\n      'brx': 3,\n      'bs': 11,\n      'ca': 3,\n      'cgg': 3,\n      'chr': 3,\n      'cs': 12,\n      'cy': 17,\n      'da': 3,\n      'de': 3,\n      'dv': 3,\n      'dz': 0,\n      'ee': 3,\n      'el': 3,\n      'en': 3,\n      'eo': 3,\n      'es': 3,\n      'et': 3,\n      'eu': 3,\n      'fa': 0,\n      'ff': 5,\n      'fi': 3,\n      'fil': 4,\n      'fo': 3,\n      'fr': 5,\n      'fur': 3,\n      'fy': 3,\n      'ga': 8,\n      'gd': 24,\n      'gl': 3,\n      'gsw': 3,\n      'gu': 3,\n      'guw': 4,\n      'gv': 23,\n      'ha': 3,\n      'haw': 3,\n      'he': 2,\n      'hi': 4,\n      'hr': 11,\n      'hu': 0,\n      'id': 0,\n      'ig': 0,\n      'ii': 0,\n      'is': 3,\n      'it': 3,\n      'iu': 7,\n      'ja': 0,\n      'jmc': 3,\n      'jv': 0,\n      'ka': 0,\n      'kab': 5,\n      'kaj': 3,\n      'kcg': 3,\n      'kde': 0,\n      'kea': 0,\n      'kk': 3,\n      'kl': 3,\n      'km': 0,\n      'kn': 0,\n      'ko': 0,\n      'ksb': 3,\n      'ksh': 21,\n      'ku': 3,\n      'kw': 7,\n      'lag': 18,\n      'lb': 3,\n      'lg': 3,\n      'ln': 4,\n      'lo': 0,\n      'lt': 10,\n      'lv': 6,\n      'mas': 3,\n      'mg': 4,\n      'mk': 16,\n      'ml': 3,\n      'mn': 3,\n      'mo': 9,\n      'mr': 3,\n      'ms': 0,\n      'mt': 15,\n      'my': 0,\n      'nah': 3,\n      'naq': 7,\n      'nb': 3,\n      'nd': 3,\n      'ne': 3,\n      'nl': 3,\n      'nn': 3,\n      'no': 3,\n      'nr': 3,\n      'nso': 4,\n      'ny': 3,\n      'nyn': 3,\n      'om': 3,\n      'or': 3,\n      'pa': 3,\n      'pap': 3,\n      'pl': 13,\n      'ps': 3,\n      'pt': 3,\n      'rm': 3,\n      'ro': 9,\n      'rof': 3,\n      'ru': 11,\n      'rwk': 3,\n      'sah': 0,\n      'saq': 3,\n      'se': 7,\n      'seh': 3,\n      'ses': 0,\n      'sg': 0,\n      'sh': 11,\n      'shi': 19,\n      'sk': 12,\n      'sl': 14,\n      'sma': 7,\n      'smi': 7,\n      'smj': 7,\n      'smn': 7,\n      'sms': 7,\n      'sn': 3,\n      'so': 3,\n      'sq': 3,\n      'sr': 11,\n      'ss': 3,\n      'ssy': 3,\n      'st': 3,\n      'sv': 3,\n      'sw': 3,\n      'syr': 3,\n      'ta': 3,\n      'te': 3,\n      'teo': 3,\n      'th': 0,\n      'ti': 4,\n      'tig': 3,\n      'tk': 3,\n      'tl': 4,\n      'tn': 3,\n      'to': 0,\n      'tr': 0,\n      'ts': 3,\n      'tzm': 22,\n      'uk': 11,\n      'ur': 3,\n      've': 3,\n      'vi': 0,\n      'vun': 3,\n      'wa': 4,\n      'wae': 3,\n      'wo': 0,\n      'xh': 3,\n      'xog': 3,\n      'yo': 0,\n      'zh': 0,\n      'zu': 3\n    };\n\n    // utility functions for plural rules methods\n    function isIn(n, list) {\n      return list.indexOf(n) !== -1;\n    }\n    function isBetween(n, start, end) {\n      return start <= n && n <= end;\n    }\n\n    // list of all plural rules methods:\n    // map an integer to the plural form name to use\n    var pluralRules = {\n      '0': function(n) {\n        return 'other';\n      },\n      '1': function(n) {\n        if ((isBetween((n % 100), 3, 10)))\n          return 'few';\n        if (n === 0)\n          return 'zero';\n        if ((isBetween((n % 100), 11, 99)))\n          return 'many';\n        if (n == 2)\n          return 'two';\n        if (n == 1)\n          return 'one';\n        return 'other';\n      },\n      '2': function(n) {\n        if (n !== 0 && (n % 10) === 0)\n          return 'many';\n        if (n == 2)\n          return 'two';\n        if (n == 1)\n          return 'one';\n        return 'other';\n      },\n      '3': function(n) {\n        if (n == 1)\n          return 'one';\n        return 'other';\n      },\n      '4': function(n) {\n        if ((isBetween(n, 0, 1)))\n          return 'one';\n        return 'other';\n      },\n      '5': function(n) {\n        if ((isBetween(n, 0, 2)) && n != 2)\n          return 'one';\n        return 'other';\n      },\n      '6': function(n) {\n        if (n === 0)\n          return 'zero';\n        if ((n % 10) == 1 && (n % 100) != 11)\n          return 'one';\n        return 'other';\n      },\n      '7': function(n) {\n        if (n == 2)\n          return 'two';\n        if (n == 1)\n          return 'one';\n        return 'other';\n      },\n      '8': function(n) {\n        if ((isBetween(n, 3, 6)))\n          return 'few';\n        if ((isBetween(n, 7, 10)))\n          return 'many';\n        if (n == 2)\n          return 'two';\n        if (n == 1)\n          return 'one';\n        return 'other';\n      },\n      '9': function(n) {\n        if (n === 0 || n != 1 && (isBetween((n % 100), 1, 19)))\n          return 'few';\n        if (n == 1)\n          return 'one';\n        return 'other';\n      },\n      '10': function(n) {\n        if ((isBetween((n % 10), 2, 9)) && !(isBetween((n % 100), 11, 19)))\n          return 'few';\n        if ((n % 10) == 1 && !(isBetween((n % 100), 11, 19)))\n          return 'one';\n        return 'other';\n      },\n      '11': function(n) {\n        if ((isBetween((n % 10), 2, 4)) && !(isBetween((n % 100), 12, 14)))\n          return 'few';\n        if ((n % 10) === 0 ||\n            (isBetween((n % 10), 5, 9)) ||\n            (isBetween((n % 100), 11, 14)))\n          return 'many';\n        if ((n % 10) == 1 && (n % 100) != 11)\n          return 'one';\n        return 'other';\n      },\n      '12': function(n) {\n        if ((isBetween(n, 2, 4)))\n          return 'few';\n        if (n == 1)\n          return 'one';\n        return 'other';\n      },\n      '13': function(n) {\n        if ((isBetween((n % 10), 2, 4)) && !(isBetween((n % 100), 12, 14)))\n          return 'few';\n        if (n != 1 && (isBetween((n % 10), 0, 1)) ||\n            (isBetween((n % 10), 5, 9)) ||\n            (isBetween((n % 100), 12, 14)))\n          return 'many';\n        if (n == 1)\n          return 'one';\n        return 'other';\n      },\n      '14': function(n) {\n        if ((isBetween((n % 100), 3, 4)))\n          return 'few';\n        if ((n % 100) == 2)\n          return 'two';\n        if ((n % 100) == 1)\n          return 'one';\n        return 'other';\n      },\n      '15': function(n) {\n        if (n === 0 || (isBetween((n % 100), 2, 10)))\n          return 'few';\n        if ((isBetween((n % 100), 11, 19)))\n          return 'many';\n        if (n == 1)\n          return 'one';\n        return 'other';\n      },\n      '16': function(n) {\n        if ((n % 10) == 1 && n != 11)\n          return 'one';\n        return 'other';\n      },\n      '17': function(n) {\n        if (n == 3)\n          return 'few';\n        if (n === 0)\n          return 'zero';\n        if (n == 6)\n          return 'many';\n        if (n == 2)\n          return 'two';\n        if (n == 1)\n          return 'one';\n        return 'other';\n      },\n      '18': function(n) {\n        if (n === 0)\n          return 'zero';\n        if ((isBetween(n, 0, 2)) && n !== 0 && n != 2)\n          return 'one';\n        return 'other';\n      },\n      '19': function(n) {\n        if ((isBetween(n, 2, 10)))\n          return 'few';\n        if ((isBetween(n, 0, 1)))\n          return 'one';\n        return 'other';\n      },\n      '20': function(n) {\n        if ((isBetween((n % 10), 3, 4) || ((n % 10) == 9)) && !(\n            isBetween((n % 100), 10, 19) ||\n            isBetween((n % 100), 70, 79) ||\n            isBetween((n % 100), 90, 99)\n            ))\n          return 'few';\n        if ((n % 1000000) === 0 && n !== 0)\n          return 'many';\n        if ((n % 10) == 2 && !isIn((n % 100), [12, 72, 92]))\n          return 'two';\n        if ((n % 10) == 1 && !isIn((n % 100), [11, 71, 91]))\n          return 'one';\n        return 'other';\n      },\n      '21': function(n) {\n        if (n === 0)\n          return 'zero';\n        if (n == 1)\n          return 'one';\n        return 'other';\n      },\n      '22': function(n) {\n        if ((isBetween(n, 0, 1)) || (isBetween(n, 11, 99)))\n          return 'one';\n        return 'other';\n      },\n      '23': function(n) {\n        if ((isBetween((n % 10), 1, 2)) || (n % 20) === 0)\n          return 'one';\n        return 'other';\n      },\n      '24': function(n) {\n        if ((isBetween(n, 3, 10) || isBetween(n, 13, 19)))\n          return 'few';\n        if (isIn(n, [2, 12]))\n          return 'two';\n        if (isIn(n, [1, 11]))\n          return 'one';\n        return 'other';\n      }\n    };\n\n    // return a function that gives the plural form name for a given integer\n    var index = locales2rules[lang.replace(/-.*$/, '')];\n    if (!(index in pluralRules)) {\n      console.warn('plural form unknown for [' + lang + ']');\n      return function() { return 'other'; };\n    }\n    return pluralRules[index];\n  }\n\n  // pre-defined 'plural' macro\n  gMacros.plural = function(str, param, key, prop) {\n    var n = parseFloat(param);\n    if (isNaN(n))\n      return str;\n\n    // TODO: support other properties (l20n still doesn't...)\n    if (prop != gTextProp)\n      return str;\n\n    // initialize _pluralRules\n    if (!gMacros._pluralRules) {\n      gMacros._pluralRules = getPluralRules(gLanguage);\n    }\n    var index = '[' + gMacros._pluralRules(n) + ']';\n\n    // try to find a [zero|one|two] key if it's defined\n    if (n === 0 && (key + '[zero]') in gL10nData) {\n      str = gL10nData[key + '[zero]'][prop];\n    } else if (n == 1 && (key + '[one]') in gL10nData) {\n      str = gL10nData[key + '[one]'][prop];\n    } else if (n == 2 && (key + '[two]') in gL10nData) {\n      str = gL10nData[key + '[two]'][prop];\n    } else if ((key + index) in gL10nData) {\n      str = gL10nData[key + index][prop];\n    } else if ((key + '[other]') in gL10nData) {\n      str = gL10nData[key + '[other]'][prop];\n    }\n\n    return str;\n  };\n\n\n  /**\n   * l10n dictionary functions\n   */\n\n  // fetch an l10n object, warn if not found, apply `args' if possible\n  function getL10nData(key, args, fallback) {\n    var data = gL10nData[key];\n    if (!data) {\n      console.warn('#' + key + ' is undefined.');\n      if (!fallback) {\n        return null;\n      }\n      data = fallback;\n    }\n\n    /** This is where l10n expressions should be processed.\n      * The plan is to support C-style expressions from the l20n project;\n      * until then, only two kinds of simple expressions are supported:\n      *   {[ index ]} and {{ arguments }}.\n      */\n    var rv = {};\n    for (var prop in data) {\n      var str = data[prop];\n      str = substIndexes(str, args, key, prop);\n      str = substArguments(str, args, key);\n      rv[prop] = str;\n    }\n    return rv;\n  }\n\n  // replace {[macros]} with their values\n  function substIndexes(str, args, key, prop) {\n    var reIndex = /\\{\\[\\s*([a-zA-Z]+)\\(([a-zA-Z]+)\\)\\s*\\]\\}/;\n    var reMatch = reIndex.exec(str);\n    if (!reMatch || !reMatch.length)\n      return str;\n\n    // an index/macro has been found\n    // Note: at the moment, only one parameter is supported\n    var macroName = reMatch[1];\n    var paramName = reMatch[2];\n    var param;\n    if (args && paramName in args) {\n      param = args[paramName];\n    } else if (paramName in gL10nData) {\n      param = gL10nData[paramName];\n    }\n\n    // there's no macro parser yet: it has to be defined in gMacros\n    if (macroName in gMacros) {\n      var macro = gMacros[macroName];\n      str = macro(str, param, key, prop);\n    }\n    return str;\n  }\n\n  // replace {{arguments}} with their values\n  function substArguments(str, args, key) {\n    var reArgs = /\\{\\{\\s*(.+?)\\s*\\}\\}/g;\n    return str.replace(reArgs, function(matched_text, arg) {\n      if (args && arg in args) {\n        return args[arg];\n      }\n      if (arg in gL10nData) {\n        return gL10nData[arg];\n      }\n      console.log('argument {{' + arg + '}} for #' + key + ' is undefined.');\n      return matched_text;\n    });\n  }\n\n  // translate an HTML element\n  function translateElement(element) {\n    var l10n = getL10nAttributes(element);\n    if (!l10n.id)\n      return;\n\n    // get the related l10n object\n    var data = getL10nData(l10n.id, l10n.args);\n    if (!data) {\n      console.warn('#' + l10n.id + ' is undefined.');\n      return;\n    }\n\n    // translate element (TODO: security checks?)\n    if (data[gTextProp]) { // XXX\n      if (getChildElementCount(element) === 0) {\n        element[gTextProp] = data[gTextProp];\n      } else {\n        // this element has element children: replace the content of the first\n        // (non-empty) child textNode and clear other child textNodes\n        var children = element.childNodes;\n        var found = false;\n        for (var i = 0, l = children.length; i < l; i++) {\n          if (children[i].nodeType === 3 && /\\S/.test(children[i].nodeValue)) {\n            if (found) {\n              children[i].nodeValue = '';\n            } else {\n              children[i].nodeValue = data[gTextProp];\n              found = true;\n            }\n          }\n        }\n        // if no (non-empty) textNode is found, insert a textNode before the\n        // first element child.\n        if (!found) {\n          var textNode = document.createTextNode(data[gTextProp]);\n          element.insertBefore(textNode, element.firstChild);\n        }\n      }\n      delete data[gTextProp];\n    }\n\n    for (var k in data) {\n      element[k] = data[k];\n    }\n  }\n\n  // webkit browsers don't currently support 'children' on SVG elements...\n  function getChildElementCount(element) {\n    if (element.children) {\n      return element.children.length;\n    }\n    if (typeof element.childElementCount !== 'undefined') {\n      return element.childElementCount;\n    }\n    var count = 0;\n    for (var i = 0; i < element.childNodes.length; i++) {\n      count += element.nodeType === 1 ? 1 : 0;\n    }\n    return count;\n  }\n\n  // translate an HTML subtree\n  function translateFragment(element) {\n    element = element || document.documentElement;\n\n    // check all translatable children (= w/ a `data-l10n-id' attribute)\n    var children = getTranslatableChildren(element);\n    var elementCount = children.length;\n    for (var i = 0; i < elementCount; i++) {\n      translateElement(children[i]);\n    }\n\n    // translate element itself if necessary\n    translateElement(element);\n  }\n\n  return {\n    // get a localized string\n    get: function(key, args, fallbackString) {\n      var index = key.lastIndexOf('.');\n      var prop = gTextProp;\n      if (index > 0) { // An attribute has been specified\n        prop = key.substring(index + 1);\n        key = key.substring(0, index);\n      }\n      var fallback;\n      if (fallbackString) {\n        fallback = {};\n        fallback[prop] = fallbackString;\n      }\n      var data = getL10nData(key, args, fallback);\n      if (data && prop in data) {\n        return data[prop];\n      }\n      return '{{' + key + '}}';\n    },\n\n    // debug\n    getData: function() { return gL10nData; },\n    getText: function() { return gTextData; },\n\n    // get|set the document language\n    getLanguage: function() { return gLanguage; },\n    setLanguage: function(lang, callback) {\n      loadLocale(lang, function() {\n        if (callback)\n          callback();\n      });\n    },\n\n    // get the direction (ltr|rtl) of the current language\n    getDirection: function() {\n      // http://www.w3.org/International/questions/qa-scripts\n      // Arabic, Hebrew, Farsi, Pashto, Urdu\n      var rtlList = ['ar', 'he', 'fa', 'ps', 'ur'];\n      var shortCode = gLanguage.split('-', 1)[0];\n      return (rtlList.indexOf(shortCode) >= 0) ? 'rtl' : 'ltr';\n    },\n\n    // translate an element or document fragment\n    translate: translateFragment,\n\n    // this can be used to prevent race conditions\n    getReadyState: function() { return gReadyState; },\n    ready: function(callback) {\n      if (!callback) {\n        return;\n      } else if (gReadyState == 'complete' || gReadyState == 'interactive') {\n        window.setTimeout(function() {\n          callback();\n        });\n      } else if (document.addEventListener) {\n        document.addEventListener('localized', function once() {\n          document.removeEventListener('localized', once);\n          callback();\n        });\n      }\n    }\n  };\n}) (window, document);\n","/* Copyright 2016 Mozilla Foundation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CSS_UNITS, NullL10n } from './ui_utils';\nimport { PDFPrintServiceFactory, PDFViewerApplication } from './app';\nimport { AppOptions } from './app_options';\n\nlet activeService = null;\nlet overlayManager = null;\n\n// Renders the page to the canvas of the given print service, and returns\n// the suggested dimensions of the output page.\nfunction renderPage(activeServiceOnEntry, pdfDocument, pageNumber, size) {\n  let scratchCanvas = activeService.scratchCanvas;\n\n  // The size of the canvas in pixels for printing.\n  const PRINT_RESOLUTION = AppOptions.get('printResolution') || 150;\n  const PRINT_UNITS = PRINT_RESOLUTION / 72.0;\n  scratchCanvas.width = Math.floor(size.width * PRINT_UNITS);\n  scratchCanvas.height = Math.floor(size.height * PRINT_UNITS);\n\n  // The physical size of the img as specified by the PDF document.\n  let width = Math.floor(size.width * CSS_UNITS) + 'px';\n  let height = Math.floor(size.height * CSS_UNITS) + 'px';\n\n  let ctx = scratchCanvas.getContext('2d');\n  ctx.save();\n  ctx.fillStyle = 'rgb(255, 255, 255)';\n  ctx.fillRect(0, 0, scratchCanvas.width, scratchCanvas.height);\n  ctx.restore();\n\n  return pdfDocument.getPage(pageNumber).then(function(pdfPage) {\n    let renderContext = {\n      canvasContext: ctx,\n      transform: [PRINT_UNITS, 0, 0, PRINT_UNITS, 0, 0],\n      viewport: pdfPage.getViewport({ scale: 1, rotation: size.rotation, }),\n      intent: 'print',\n    };\n    return pdfPage.render(renderContext).promise;\n  }).then(function() {\n    return {\n      width,\n      height,\n    };\n  });\n}\n\nfunction PDFPrintService(pdfDocument, pagesOverview, printContainer, l10n) {\n  this.pdfDocument = pdfDocument;\n  this.pagesOverview = pagesOverview;\n  this.printContainer = printContainer;\n  this.l10n = l10n || NullL10n;\n  this.disableCreateObjectURL =\n    pdfDocument.loadingParams['disableCreateObjectURL'];\n  this.currentPage = -1;\n  // The temporary canvas where renderPage paints one page at a time.\n  this.scratchCanvas = document.createElement('canvas');\n}\n\nPDFPrintService.prototype = {\n  layout() {\n    this.throwIfInactive();\n\n    const body = document.querySelector('body');\n    body.setAttribute('data-pdfjsprinting', true);\n\n    let hasEqualPageSizes = this.pagesOverview.every(function(size) {\n      return size.width === this.pagesOverview[0].width &&\n             size.height === this.pagesOverview[0].height;\n    }, this);\n    if (!hasEqualPageSizes) {\n      console.warn('Not all pages have the same size. The printed ' +\n                   'result may be incorrect!');\n    }\n\n    // Insert a @page + size rule to make sure that the page size is correctly\n    // set. Note that we assume that all pages have the same size, because\n    // variable-size pages are not supported yet (e.g. in Chrome & Firefox).\n    // TODO(robwu): Use named pages when size calculation bugs get resolved\n    // (e.g. https://crbug.com/355116) AND when support for named pages is\n    // added (http://www.w3.org/TR/css3-page/#using-named-pages).\n    // In browsers where @page + size is not supported (such as Firefox,\n    // https://bugzil.la/851441), the next stylesheet will be ignored and the\n    // user has to select the correct paper size in the UI if wanted.\n    this.pageStyleSheet = document.createElement('style');\n    let pageSize = this.pagesOverview[0];\n    this.pageStyleSheet.textContent =\n      // \"size:<width> <height>\" is what we need. But also add \"A4\" because\n      // Firefox incorrectly reports support for the other value.\n      '@supports ((size:A4) and (size:1pt 1pt)) {' +\n      '@page { size: ' + pageSize.width + 'pt ' + pageSize.height + 'pt;}' +\n      '}';\n    body.appendChild(this.pageStyleSheet);\n  },\n\n  destroy() {\n    if (activeService !== this) {\n      // |activeService| cannot be replaced without calling destroy() first,\n      // so if it differs then an external consumer has a stale reference to\n      // us.\n      return;\n    }\n    this.printContainer.textContent = '';\n\n    const body = document.querySelector('body');\n    body.removeAttribute('data-pdfjsprinting');\n\n    if (this.pageStyleSheet) {\n      this.pageStyleSheet.remove();\n      this.pageStyleSheet = null;\n    }\n    this.scratchCanvas.width = this.scratchCanvas.height = 0;\n    this.scratchCanvas = null;\n    activeService = null;\n    ensureOverlay().then(function() {\n      if (overlayManager.active !== 'printServiceOverlay') {\n        return; // overlay was already closed\n      }\n      overlayManager.close('printServiceOverlay');\n    });\n  },\n\n  renderPages() {\n    let pageCount = this.pagesOverview.length;\n    let renderNextPage = (resolve, reject) => {\n      this.throwIfInactive();\n      if (++this.currentPage >= pageCount) {\n        renderProgress(pageCount, pageCount, this.l10n);\n        resolve();\n        return;\n      }\n      let index = this.currentPage;\n      renderProgress(index, pageCount, this.l10n);\n      renderPage(this, this.pdfDocument, index + 1, this.pagesOverview[index])\n        .then(this.useRenderedPage.bind(this))\n        .then(function() {\n          renderNextPage(resolve, reject);\n        }, reject);\n    };\n    return new Promise(renderNextPage);\n  },\n\n  useRenderedPage(printItem) {\n    this.throwIfInactive();\n    let img = document.createElement('img');\n    img.style.width = printItem.width;\n    img.style.height = printItem.height;\n\n    let scratchCanvas = this.scratchCanvas;\n    if (('toBlob' in scratchCanvas) && !this.disableCreateObjectURL) {\n      scratchCanvas.toBlob(function(blob) {\n        img.src = URL.createObjectURL(blob);\n      });\n    } else {\n      img.src = scratchCanvas.toDataURL();\n    }\n\n    let wrapper = document.createElement('div');\n    wrapper.appendChild(img);\n    this.printContainer.appendChild(wrapper);\n\n    return new Promise(function(resolve, reject) {\n      img.onload = resolve;\n      img.onerror = reject;\n    });\n  },\n\n  performPrint() {\n    this.throwIfInactive();\n    return new Promise((resolve) => {\n      // Push window.print in the macrotask queue to avoid being affected by\n      // the deprecation of running print() code in a microtask, see\n      // https://github.com/mozilla/pdf.js/issues/7547.\n      setTimeout(() => {\n        if (!this.active) {\n          resolve();\n          return;\n        }\n        print.call(window);\n        // Delay promise resolution in case print() was not synchronous.\n        setTimeout(resolve, 20);  // Tidy-up.\n      }, 0);\n    });\n  },\n\n  get active() {\n    return this === activeService;\n  },\n\n  throwIfInactive() {\n    if (!this.active) {\n      throw new Error('This print request was cancelled or completed.');\n    }\n  },\n};\n\nlet print = window.print;\nwindow.print = function print() {\n  if (activeService) {\n    console.warn('Ignored window.print() because of a pending print job.');\n    return;\n  }\n  ensureOverlay().then(function() {\n    if (activeService) {\n      overlayManager.open('printServiceOverlay');\n    }\n  });\n\n  try {\n    dispatchEvent('beforeprint');\n  } finally {\n    if (!activeService) {\n      console.error('Expected print service to be initialized.');\n      ensureOverlay().then(function() {\n        if (overlayManager.active === 'printServiceOverlay') {\n          overlayManager.close('printServiceOverlay');\n        }\n      });\n      return; // eslint-disable-line no-unsafe-finally\n    }\n    let activeServiceOnEntry = activeService;\n    activeService.renderPages().then(function() {\n      return activeServiceOnEntry.performPrint();\n    }).catch(function() {\n      // Ignore any error messages.\n    }).then(function() {\n      // aborts acts on the \"active\" print request, so we need to check\n      // whether the print request (activeServiceOnEntry) is still active.\n      // Without the check, an unrelated print request (created after aborting\n      // this print request while the pages were being generated) would be\n      // aborted.\n      if (activeServiceOnEntry.active) {\n        abort();\n      }\n    });\n  }\n};\n\nfunction dispatchEvent(eventType) {\n  let event = document.createEvent('CustomEvent');\n  event.initCustomEvent(eventType, false, false, 'custom');\n  window.dispatchEvent(event);\n}\n\nfunction abort() {\n  if (activeService) {\n    activeService.destroy();\n    dispatchEvent('afterprint');\n  }\n}\n\nfunction renderProgress(index, total, l10n) {\n  let progressContainer = document.getElementById('printServiceOverlay');\n  let progress = Math.round(100 * index / total);\n  let progressBar = progressContainer.querySelector('progress');\n  let progressPerc = progressContainer.querySelector('.relative-progress');\n  progressBar.value = progress;\n  l10n.get('print_progress_percent', { progress, }, progress + '%').\n      then((msg) => {\n    progressPerc.textContent = msg;\n  });\n}\n\nlet hasAttachEvent = !!document.attachEvent;\n\nwindow.addEventListener('keydown', function(event) {\n  // Intercept Cmd/Ctrl + P in all browsers.\n  // Also intercept Cmd/Ctrl + Shift + P in Chrome and Opera\n  if (event.keyCode === /* P= */ 80 && (event.ctrlKey || event.metaKey) &&\n      !event.altKey && (!event.shiftKey || window.chrome || window.opera)) {\n    if (hasAttachEvent) {\n      // Only attachEvent can cancel Ctrl + P dialog in IE <=10\n      // attachEvent is gone in IE11, so the dialog will re-appear in IE11.\n      return;\n    }\n    event.preventDefault();\n    if (event.stopImmediatePropagation) {\n      event.stopImmediatePropagation();\n    } else {\n      event.stopPropagation();\n    }\n  }\n}, true);\nif (hasAttachEvent) {\n  // eslint-disable-next-line consistent-return\n  document.attachEvent('onkeydown', function(event) {\n    event = event || window.event;\n    if (event.keyCode === /* P= */ 80 && event.ctrlKey) {\n      event.keyCode = 0;\n      return false;\n    }\n  });\n}\n\nif ('onbeforeprint' in window) {\n  // Do not propagate before/afterprint events when they are not triggered\n  // from within this polyfill. (FF /IE / Chrome 63+).\n  let stopPropagationIfNeeded = function(event) {\n    if (event.detail !== 'custom' && event.stopImmediatePropagation) {\n      event.stopImmediatePropagation();\n    }\n  };\n  window.addEventListener('beforeprint', stopPropagationIfNeeded);\n  window.addEventListener('afterprint', stopPropagationIfNeeded);\n}\n\nlet overlayPromise;\nfunction ensureOverlay() {\n  if (!overlayPromise) {\n    overlayManager = PDFViewerApplication.overlayManager;\n    if (!overlayManager) {\n      throw new Error('The overlay manager has not yet been initialized.');\n    }\n\n    overlayPromise = overlayManager.register('printServiceOverlay',\n      document.getElementById('printServiceOverlay'), abort, true);\n    document.getElementById('printCancel').onclick = abort;\n  }\n  return overlayPromise;\n}\n\nPDFPrintServiceFactory.instance = {\n  supportsPrinting: true,\n\n  createPrintService(pdfDocument, pagesOverview, printContainer, l10n) {\n    if (activeService) {\n      throw new Error('The print service is created and active.');\n    }\n    activeService = new PDFPrintService(pdfDocument, pagesOverview,\n                                        printContainer, l10n);\n    return activeService;\n  },\n};\n\nexport {\n  PDFPrintService,\n};\n"],"sourceRoot":""}